(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/admin/_slug/expense-management/settle-expense-request","chunk-2d22d378","chunk-2d0d6ae8"],{"21dd":function(e,t,a){"use strict";a("99af");t["a"]={postRequest:function(e){return"/reimbursement/".concat(e,"/settlement/request/")},getRequest:function(e){return"/reimbursement/".concat(e,"/settlement/request/")},getDetail:function(e,t){return"reimbursement/".concat(e,"/settlement/request/").concat(t,"/")},requestAction:function(e,t,a){return"/reimbursement/".concat(e,"/settlement/request/").concat(t,"/").concat(a,"/")},settleAmount:function(e,t){return"/reimbursement/".concat(e,"/settlement/request/").concat(t,"/option/")},changeTaxable:function(e,t){return"/reimbursement/".concat(e,"/settlement/request/").concat(t,"/is-taxable/")},getSelectableApprovers:function(e){return"reimbursement/".concat(e,"/setting/settlement-approvers/")}}},"2c64":function(e,t,a){},"3d86":function(e,t,a){},"43a6":function(e,t,a){"use strict";var s=a("5530"),i=(a("a9e3"),a("ec29"),a("3d86"),a("c37a")),n=a("604c"),r=a("8547"),o=a("58df"),l=Object(o["a"])(r["a"],n["a"],i["a"]);t["a"]=l.extend({name:"v-radio-group",provide:function(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes:function(){return Object(s["a"])(Object(s["a"])({},i["a"].options.computed.classes.call(this)),{},{"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row})}},methods:{genDefaultSlot:function(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},i["a"].options.methods.genDefaultSlot.call(this))},genInputSlot:function(){var e=i["a"].options.methods.genInputSlot.call(this);return delete e.data.on.click,e},genLabel:function(){var e=i["a"].options.methods.genLabel.call(this);return e?(e.data.attrs.id=this.computedId,delete e.data.attrs.for,e.tag="legend",e):null},onClick:n["a"].options.methods.onClick}})},"67b6":function(e,t,a){"use strict";var s=a("5530"),i=(a("b0c0"),a("2c64"),a("ba87")),n=a("9d26"),r=a("c37a"),o=a("7e2b"),l=a("a9ad"),c=a("4e82"),d=a("5311"),u=a("7560"),p=a("fe09"),m=a("80d2"),v=a("58df"),f=a("d9f7"),h=Object(v["a"])(o["a"],l["a"],d["a"],Object(c["a"])("radioGroup"),u["a"]);t["a"]=h.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:function(){return{isFocused:!1}},computed:{classes:function(){return Object(s["a"])(Object(s["a"])({"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused},this.themeClasses),this.groupClasses)},computedColor:function(){return p["a"].options.computed.computedColor.call(this)},computedIcon:function(){return this.isActive?this.onIcon:this.offIcon},computedId:function(){return r["a"].options.computed.computedId.call(this)},hasLabel:r["a"].options.computed.hasLabel,hasState:function(){return(this.radioGroup||{}).hasState},isDisabled:function(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly:function(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName:function(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||"radio-".concat(this.radioGroup._uid)},rippleState:function(){return p["a"].options.computed.rippleState.call(this)},validationState:function(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput:function(e){return p["a"].options.methods.genInput.call(this,"radio",e)},genLabel:function(){return this.hasLabel?this.$createElement(i["a"],{on:{click:p["b"]},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},Object(m["s"])(this,"label")||this.label):null},genRadio:function(){return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(n["a"],this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput(Object(s["a"])({name:this.computedName,value:this.value},this.attrs$)),this.genRipple(this.setTextColor(this.rippleState))])},onFocus:function(e){this.isFocused=!0,this.$emit("focus",e)},onBlur:function(e){this.isFocused=!1,this.$emit("blur",e)},onChange:function(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:function(){}},render:function(e){var t={staticClass:"v-radio",class:this.classes,on:Object(f["c"])({click:this.onChange},this.listeners$)};return e("div",t,[this.genRadio(),this.genLabel()])}})},"6c6f":function(e,t,a){"use strict";a("d3b7");t["a"]={data:function(){return{deleteNotification:{dialog:!1,heading:"Confirm Delete",text:"Are you sure you want to delete ?"}}},methods:{deleteData:function(e,t){var a=this;return new Promise((function(s,i){!a.loading&&e&&(a.loading=!0,a.$http.delete(e,t||{}).then((function(e){a.crud.message&&setTimeout((function(){a.notifyUser(a.crud.message)}),1e3),s(e),a.loading=!1})).catch((function(e){a.pushErrors(e),a.notifyInvalidFormResponse(),i(e),a.loading=!1})).finally((function(){a.deleteNotification.dialog=!1})))}))}}}},"741f":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return["true"!==e.useNepaliDate?a("v-text-field",e._g({class:e.appliedClass,attrs:{id:e.id,clearable:!e.readOnly,"data-cy":"date-picker-"+e.dataCyVariable,disabled:e.disabled,error:e.errorMessages.length>0,"error-messages":e.errorMessages,"hide-details":e.hideDetails,hint:e.hint,label:e.label,"prepend-inner-icon":e.prependInnerIcon,"single-line":e.singleLine,value:e.value,readonly:""},on:{paste:function(e){e.preventDefault()},"click:clear":function(t){return e.$emit("close")}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},s)):a("v-text-field",e._g({class:e.appliedClass,attrs:{id:e.id,label:e.label,value:e.value,"data-cy":"date-picker-"+e.dataCyVariable,error:e.errorMessages.length>0,"error-messages":e.errorMessages,disabled:e.disabled,clearable:!e.readOnly,hint:e.hint,"hide-details":e.hideDetails,"single-line":e.singleLine,"prepend-inner-icon":e.prependInnerIcon,readonly:""},on:{paste:function(e){e.preventDefault()},"click:clear":function(t){return e.$emit("close")}},model:{value:e.nepaliDate,callback:function(t){e.nepaliDate=t},expression:"nepaliDate"}},s))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},["true"===e.showCalendarChoice?a("v-btn",{attrs:{block:"",depressed:"",tile:"",color:"shade primary--text font-weight-bold"},on:{click:function(t){e.international=!e.international}}},[e._v(" "+e._s(e.international?"NE":"EN")+" ")]):e._e(),e.readOnly||e.international?e._e():a("localized-calendar",{ref:"datePicker",attrs:{"fiscal-year":[],"localized-date":e.localizedDate},on:{"update:localizedDate":function(t){e.localizedDate=t},"update:localized-date":function(t){e.localizedDate=t},"limit-mapping":function(t){e.limitMapping=t}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),!e.readOnly&&e.international?a("v-date-picker",{attrs:{type:e.type,"allowed-dates":e.allowedDates,"no-title":""},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}):e._e()],1)],1)},i=[],n=a("1da1"),r=(a("b64b"),a("99af"),a("96cf"),a("3bce")),o=a("338b"),l=a("cf45"),c={components:{LocalizedCalendar:r["a"]},mixins:[o["a"]],props:{value:{type:String,default:""},id:{type:String,default:""},type:{type:String,default:"date"},label:{type:String,default:""},disabled:{type:Boolean,default:!1},errorMessages:{type:[String,Array],default:function(){return[]}},dataCyVariable:{type:String,default:""},readOnly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},hint:{type:String,default:""},hideDetails:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1},appliedClass:{type:String,default:""},prependInnerIcon:{type:String,default:"mdi-calendar-month-outline"}},data:function(){return{menu:!1,date:this.value,nepaliDate:this.value,localizedDate:"",international:"English"===Object(l["f"])("VUE_APP_SET_DEFAULT_CALENDAR_TO"),showCalendarChoice:Object(l["f"])("VUE_APP_SHOW_CALENDAR_CHOICE"),useNepaliDate:localStorage.useNepaliDate,hasConverted:!1}},watch:{value:function(e){this.date=e},date:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e&&"true"===t.useNepaliDate&&t.hasConverted?t.nepaliDate=t.ad2bs(e):t.nepaliDate=e,a.next=3,t.$emit("input",e);case 3:return a.next=5,t.$emit("update:localizedDate",t.localizedDate);case 5:if(!e){a.next=8;break}return a.next=8,t.$emit("blur");case 8:case"end":return a.stop()}}),a)})))()},international:function(e){this.$emit("update:international",e)}},created:function(){this.date&&"true"===this.useNepaliDate&&!this.hasConverted?(this.hasConverted=!0,this.date=this.bs2ad(this.date)):this.date||"true"!==this.useNepaliDate||(this.hasConverted=!0)},methods:{allowedDates:function(e){if("false"===this.showCalendarChoice&&"English"===Object(l["f"])("VUE_APP_SET_DEFAULT_CALENDAR_TO"))return!0;var t=[],a="",s="";t=Object.keys(this.bs),a=t[0],s=t[t.length-1];var i={max:this.bs2ad("".concat(s,"-12-").concat(this.bs[s][11])),min:this.bs2ad("".concat(a,"-01-01"))};return e<=i.max&&e>=i.min}}},d=c,u=a("2877"),p=a("6544"),m=a.n(p),v=a("8336"),f=a("2e4b"),h=a("e449"),_=a("8654"),x=Object(u["a"])(d,s,i,!1,null,null,null);t["default"]=x.exports;m()(x,{VBtn:v["a"],VDatePicker:f["a"],VMenu:h["a"],VTextField:_["a"]})},"9d79":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:"Expense Settlement/Reimbursement Request",subtitle:"Here you can settle/Reimbursement request.",icon:"mdi-file",closable:""},on:{close:function(t){return e.$emit("close")}}}),a("v-divider"),a("v-card-text",[e.nonFieldErrors?a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}}):e._e(),a("v-row",[a("v-col",{staticClass:"pt-3",attrs:{md:"4",cols:"12"}},[e.settleFromExpense?a("div",[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Reason for "+e._s(e.formType)+" "),a("div",{staticClass:"black--text mx-5"},[e._v(" "+e._s(e.settleFromExpense.reason)+" ")])],1):a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:255",expression:"'required|max:255'"}],attrs:{counter:"255","prepend-inner-icon":"mdi-information-outline"},model:{value:e.formValues.reason,callback:function(t){e.$set(e.formValues,"reason",t)},expression:"formValues.reason"}},"v-text-field",e.veeValidate("reason","Reason for "+e.formType+" *"),!1))],1),a("v-col",{staticClass:"pt-3",attrs:{md:"4",cols:"12"}},[e.settleFromExpense?a("div",{staticClass:"mx-5 mt-1 black--text"},[e._v(" "+e._s(e.settleFromExpense.currency)+" ")]):a("v-autocomplete",{attrs:{items:e.CURRENCIES,label:"Currency"},model:{value:e.formValues.currency,callback:function(t){e.$set(e.formValues,"currency",t)},expression:"formValues.currency"}})],1),a("v-col",{staticClass:"pt-3",attrs:{md:"4",cols:"12"}},[e.settleFromExpense?a("div",[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Total Advance Amount "),a("div",{staticClass:"black--text mx-5"},[e._v(" "+e._s(e.formatCurrency(e.settleFromExpense.advance_amount))+" ")])],1):a("div",[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Type ")],1),a("div",{staticClass:"mx-5 mt-1 black--text"},[e._v(" "+e._s(e.formType)+" ")])])]),a("v-col",{attrs:{cols:"12"}},[e.settleFromExpense?a("div",[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Description "),a("div",{staticClass:"black--text mx-5"},[e._v(" "+e._s(e.settleFromExpense.description||"N/A")+" ")])],1):a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],attrs:{counter:"600","prepend-inner-icon":"mdi-text"},model:{value:e.formValues.description,callback:function(t){e.$set(e.formValues,"description",t)},expression:"formValues.description"}},"v-text-field",e.veeValidate("description","Description"),!1))],1),a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-bold blue-grey--text text-h6 py-3"},[e._v(" Advance Expenses Details ")]),a("v-card",{attrs:{outlined:""}},[a("v-row",{staticClass:"ma-3"},[e._l(e.heading,(function(t,s){return a("v-col",{key:s,class:t.align?t.align.float?"text-right":"pl-7":"",attrs:{cols:t.cols}},[e._v(" "+e._s(t.text)+" ")])})),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[e._l(e.advanceExpenseDetail,(function(t,s){return a("v-row",{key:s,attrs:{align:"center"}},[a("v-col",{staticClass:"py-0",attrs:{cols:"1"}},[e._v(" "+e._s(s+1)+" ")]),a("v-col",{staticClass:"py-0",attrs:{cols:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:255",expression:"'required|max:255'"}],attrs:{counter:"255"},model:{value:t.heading,callback:function(a){e.$set(t,"heading",a)},expression:"item.heading"}},"v-text-field",e.veeValidate("heading"+s,"Heading *"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{cols:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:255",expression:"'required|max:255'"}],attrs:{counter:"255"},model:{value:t.particulars,callback:function(a){e.$set(t,"particulars",a)},expression:"item.particulars"}},"v-text-field",e.veeValidate("particulars"+s,"Particular *"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{cols:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{type:"number"},model:{value:t.quantity,callback:function(a){e.$set(t,"quantity",a)},expression:"item.quantity"}},"v-text-field",e.veeValidate("quantity"+s,"Quantity *"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{cols:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{type:"number"},model:{value:t.rate,callback:function(a){e.$set(t,"rate",a)},expression:"item.rate"}},"v-text-field",e.veeValidate("rate"+s,"Rate *"),!1))],1),a("v-col",{staticClass:"py-0 pr-n5 text-right",attrs:{cols:"2"}},[e._v(" "+e._s(t.quantity*t.rate)+" ")]),a("v-col",{attrs:{cols:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],model:{value:t.bill_no,callback:function(a){e.$set(t,"bill_no",a)},expression:"item.bill_no"}},"v-text-field",e.veeValidate("bill_no","Bill No"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{cols:"auto"}},[e.advanceExpenseDetail.length>1?a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.advanceExpenseDetail.splice(s,1)}}},[a("v-icon",{staticClass:"pointer",attrs:{color:"red"},domProps:{textContent:e._s("mdi-delete")}})],1):e._e()],1),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{counter:"600"},model:{value:t.remarks,callback:function(a){e.$set(t,"remarks",a)},expression:"item.remarks"}},"v-text-field",e.veeValidate("remarks"+s,"Remarks *"),!1))],1),s===e.advanceExpenseDetail.length-1?a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.addNewExpenseDetail()}}},[a("v-icon",{domProps:{textContent:e._s("mdi-plus")}}),e._v(" Add New Row ")],1)],1):e._e()],1)})),a("v-col",{staticClass:"py-0",attrs:{md:"4",cols:"12"}},[a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[a("file-upload",{attrs:{label:"Upload Documents *","hide-details":""},model:{value:e.attachment,callback:function(t){e.attachment=t},expression:"attachment"}}),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("attachment"))+" ")])],1),a("v-col",{staticClass:"mx-2",attrs:{cols:"12",md:"3"}},[a("v-icon",{attrs:{color:"primary",disabled:!e.attachment},domProps:{textContent:e._s("mdi-plus-box")},on:{click:function(t){return e.appendFiles()}}})],1)],1),a("div",{staticClass:"py-3"},e._l(e.attachments,(function(t,s){return a("ul",{key:s},[a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(i){var n=i.hover;return a("li",{},[a("span",[e._v(" "+e._s(t.file.name)+" "),n?a("a",{on:{click:function(t){return e.attachments.splice(s,1)}}},[a("v-icon",{attrs:{color:"danger",small:""}},[e._v("mdi-close")])],1):e._e()])])}}],null,!0)})],1)})),0)],1)],2)],2)],1)],1),a("v-col",{staticClass:"py-0 text-right",attrs:{cols:"12"}},[a("span",{staticClass:"black--text"},[e._v(" Total Amount: ")]),a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s(e.formatCurrency(e.totalAmount||0)))])]),e.settleFromExpense&&e.settleFromExpense.advance_amount>e.totalAmount?a("v-col",{staticClass:"blue-grey lighten-5",attrs:{cols:"12"}},[a("div",[a("div",[e._v(" Total settlement amount "),a("span",{staticClass:"danger--text"},[e._v("("+e._s((e.settleFromExpense.currency||e.formValues.currency)+". "+e.formatCurrency(e.totalAmount||0))+")")]),e._v(" is "+e._s(e.totalAmount>e.settleFromExpense.advance_amount?"higher":"less")+" than the total advance amount "),a("span",{staticClass:"indigo--text"},[e._v("("+e._s((e.settleFromExpense.currency||e.formValues.currency)+". "+e.formatCurrency(e.settleFromExpense.advance_amount))+")")]),e._v(" by "),a("span",{staticClass:"danger--text"},[e._v(" "+e._s((e.settleFromExpense.currency||e.formValues.currency)+". "+e.formatCurrency(Math.abs(e.settleFromExpense.advance_amount-e.totalAmount))))])]),a("div",[e._v("Select option below to settle remaining amount")]),a("v-radio-group",{model:{value:e.options.settle_with,callback:function(t){e.$set(e.options,"settle_with",t)},expression:"options.settle_with"}},e._l(e.settle_options,(function(e,t){return a("div",{key:t},[a("v-radio",{attrs:{label:"Settle with "+e,value:e}})],1)})),0)],1),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[a("file-upload",{attrs:{label:"Cheque"===e.options.settle_with?"Upload Cheque *":"Upload Documents *","hide-details":""},model:{value:e.options.attachment,callback:function(t){e.$set(e.options,"attachment",t)},expression:"options.attachment"}}),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("attachment"))+" ")])],1)],1)],1),a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],attrs:{"prepend-inner-icon":"mdi-information-outline",counter:"600"},model:{value:e.options.remark,callback:function(t){e.$set(e.options,"remark",t)},expression:"options.remark"}},"v-text-field",e.veeValidate("","Remarks"),!1))],1):e._e(),a("v-col",{staticClass:"py-0 text-right",attrs:{cols:"12"}},[a("v-textarea",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{rows:"2",counter:"600"},model:{value:e.formValues.remarks,callback:function(t){e.$set(e.formValues,"remarks",t)},expression:"formValues.remarks"}},"v-textarea",e.veeValidate("remark","Remarks *"),!1))],1),a("v-col",{attrs:{cols:"12"}},[a("v-checkbox",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|true",expression:"'required|true'"}],attrs:{label:"Use your default signature *"},model:{value:e.formValues.add_signature,callback:function(t){e.$set(e.formValues,"add_signature",t)},expression:"formValues.add_signature"}},"v-checkbox",e.veeValidate("add_signature","Signature"),!1))],1)],1),e.requiresApproversSelection?a("div",{staticClass:"font-weight-bold blue-grey--text text-subtitle-1 py-3"},[e._v(" Select Approvers ")]):e._e(),e.requiresApproversSelection?a("v-card",{attrs:{outlined:""}},[a("v-card-text",[a("v-row",{attrs:{align:"center"}},e._l(e.approvalList,(function(t,s){return a("v-col",{key:t.approval_level,attrs:{cols:"12",lg:"6",md:"6",sm:"12"}},[a("vue-users-auto-complete",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{params:{user_status:"current"},"items-to-include":t.employee},model:{value:e.selected_approvers[s].employee,callback:function(t){e.$set(e.selected_approvers[s],"employee",t)},expression:"selected_approvers[index].employee"}},"vue-users-auto-complete",e.veeValidate("selectedApprovers["+s+"]","Approval Level "+t.approval_level),!1))],1)})),1)],1)],1):e._e()],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"black",text:""},on:{click:function(t){return e.$emit("close")}}},[e._v("Cancel")]),a("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(t){return e.save()}}},[e._v("Save")])],1)],1)},i=[],n=a("2909"),r=a("1da1"),o=(a("96cf"),a("d81d"),a("99af"),a("159b"),a("a4d3"),a("e01a"),a("b64b"),a("f82f")),l=a("21dd"),c=a("f12b"),d=a("ab8a"),u=a("cf45"),p=a("7bb1"),m=a("a438"),v=a("ef8c");p["b"].Validator.extend("true",{getMessage:function(e){return e+" must be selected to use your default signature."},validate:function(e){return!0===e}});var f={components:{FileUpload:o["a"],NonFieldFormErrors:d["default"],VueUsersAutoComplete:v["default"]},mixins:[c["a"]],props:{formType:{type:String,default:""},as:{type:String,default:""},settleFromExpense:{type:Object,default:function(){return null}}},data:function(){return{selected_approvers:[],approvalList:[],formValues:{currency:"NPR"},endpoint:"",heading:[{text:"S.No.",cols:"1"},{text:"Heading",cols:"2"},{text:"Particulars",cols:"2"},{text:"Quantity",cols:"2"},{text:"Rate",cols:"auto"},{text:"Total Amount",cols:"2",align:{float:"right"}},{text:"Bill No",cols:"2",align:{}},{text:"",cols:"1"}],attachment:null,attachments:[],options:{},settlementType:"",settle_options:[],advanceExpenseDetail:[{heading:"",particulars:"",quantity:"",rate:"",total_amount:"",bill_no:"",remarks:""}],CURRENCIES:m["a"]}},computed:{totalAmount:function(){return this.advanceExpenseDetail.map((function(e){return e.rate*e.quantity})).reduce(this.getSum,0)},requiresApproversSelection:function(){return this.selected_approvers.length>0}},created:function(){this.endpoint=l["a"].postRequest(this.getOrganizationSlug)+"?as=".concat(this.as,"&expense_type=").concat(this.formType),this.getSettlementOption(),this.getSelectedApprovers()},methods:{formatCurrency:u["d"],getSelectedApprovers:function(){var e=this,t=l["a"].getSelectableApprovers(this.getOrganizationSlug);this.getData(t).then((function(t){e.approvalList=t,e.approvalList.forEach((function(t){e.selected_approvers.push({approval_level:t.approval_level,employee:[]})}))}))},appendFiles:function(){this.attachment?(this.attachments.unshift({file:this.attachment}),this.attachment=null):this.setSnackBar({text:"Please add attachment",color:"red"})},addNewExpenseDetail:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.advanceExpenseDetail.push({heading:"",particulars:"",quantity:"",rate:"",total_amount:"",bill_no:"",remarks:""});case 1:case"end":return t.stop()}}),t)})))()},getSum:function(e,t){return e+t},processAfterInsert:function(){this.settleFromExpense&&this.$router.push({name:"user-expense-management-settle-expense"})},getSettlementOption:function(){var e=this,t="/reimbursement/".concat(this.getOrganizationSlug,"/setting/");this.$http.get(t).then((function(t){e.settle_options=t.results[0].options}))},getFormValues:function(){var e=this,t=new FormData;for(var a in t.append("reason",this.settleFromExpense?this.settleFromExpense.reason:this.formValues.reason),t.append("type",this.settleFromExpense?this.settleFromExpense.type:this.formValues.type),t.append("currency",this.settleFromExpense?this.settleFromExpense.currency:this.formValues.currency),t.append("description",this.settleFromExpense?this.settleFromExpense.description:this.formValues.description),t.append("add_signature",this.settleFromExpense?this.settleFromExpense.add_signature:this.formValues.add_signature),t.append("remark",this.formValues.remarks),Object.keys.apply(Object,Object(n["a"])(this.advanceExpenseDetail)).forEach((function(a){e.advanceExpenseDetail.forEach((function(e,s){t.append("detail[".concat(s,"]").concat(a),e[a])}))})),this.attachments.forEach((function(e,a){t.append("attachment[".concat(a,"]"),e.file)})),this.settleFromExpense&&t.append("advance_expense",this.settleFromExpense.id),Object.keys(this.options).length&&Object.keys(this.options).forEach((function(a){t.append("option.".concat(a),e.options[a])})),this.selected_approvers){var s=this.selected_approvers[a];t.append("selected_approvers[".concat(a,"]approval_level"),s.approval_level),t.append("selected_approvers[".concat(a,"]recipient"),s.employee)}return t},save:function(){var e=this;this.crud.message="Settlement request submitted successfully.",this.insertData(this.endpoint,this.getFormValues()).then((function(){e.$emit("close")}))}}},h=f,_=a("2877"),x=a("6544"),g=a.n(x),b=a("c6a6"),y=a("8336"),C=a("b0af"),D=a("99d9"),w=a("ac7c"),q=a("62ad"),k=a("ce7e"),V=a("ce87"),S=a("132d"),A=a("67b6"),R=a("43a6"),F=a("0fd9b"),E=a("2fa4"),T=a("8654"),N=a("a844"),$=Object(_["a"])(h,s,i,!1,null,"4779ba3f",null);t["a"]=$.exports;g()($,{VAutocomplete:b["a"],VBtn:y["a"],VCard:C["a"],VCardActions:D["a"],VCardText:D["c"],VCheckbox:w["a"],VCol:q["a"],VDivider:k["a"],VHover:V["a"],VIcon:S["a"],VRadio:A["a"],VRadioGroup:R["a"],VRow:F["a"],VSpacer:E["a"],VTextField:T["a"],VTextarea:N["a"]})},a133:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-card",[a("vue-card-title",{attrs:{title:e.heading.title,subtitle:e.heading.subheading,icon:"mdi-format-list-checkbox"}},[a("template",{slot:"actions"},[e.as?e._e():a("v-menu",{attrs:{"offset-y":"","max-height":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"mt-1",attrs:{small:"",depressed:"",color:"primary",dark:""}},s),[e._v(" Settle ")])]}}],null,!1,3035098274)},[a("v-list",e._l(e.$options.requestTypes,(function(t,s){return a("v-list-item",{key:s,on:{click:function(a){return e.displayForm(t)}}},[a("v-list-item-title",{domProps:{textContent:e._s(t)}})],1)})),1)],1),"approver"!==e.as?a("v-btn",{attrs:{icon:"","data-cy":"btn-filter"},on:{click:function(t){e.filter.show=!e.filter.show}}},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-filter-variant")}})],1):e._e()],1)],2),e.filter.show?a("v-divider"):e._e(),a("v-slide-y-transition",[a("v-row",{directives:[{name:"show",rawName:"v-show",value:e.filter.show,expression:"filter.show"}],attrs:{"no-gutters":""}},[["hr","approver"].includes(e.as)?a("v-col",{staticClass:"px-2",attrs:{cols:"6",md:"3"}},[a("vue-users-auto-complete",{attrs:{params:{organization:e.getOrganizationSlug}},model:{value:e.filter.user,callback:function(t){e.$set(e.filter,"user",t)},expression:"filter.user"}})],1):e._e(),a("v-col",{staticClass:"px-2",attrs:{cols:"6",md:"3"}},[a("vue-search",{attrs:{search:e.filter.search},on:{"update:search":function(t){return e.$set(e.filter,"search",t)}},model:{value:e.filter.search,callback:function(t){e.$set(e.filter,"search",t)},expression:"filter.search"}})],1),a("v-col",{staticClass:"px-2",attrs:{cols:"6",md:"3"}},[a("date-filter-menu",{attrs:{default:"This Year"},model:{value:e.dateFilter,callback:function(t){e.dateFilter=t},expression:"dateFilter"}})],1),a("v-col",{staticClass:"px-2",attrs:{cols:"6",md:"3"}},[a("v-select",{attrs:{clearable:"","data-cy":"input-filter-type",items:["Travel","Business","Medical","Other"],label:"Filter by Type"},model:{value:e.filter.type,callback:function(t){e.$set(e.filter,"type",t)},expression:"filter.type"}})],1)],1)],1),a("v-divider"),a("v-tabs",{attrs:{"show-arrows":"","slider-color":"blue"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(Object.keys(e.$options.tabs),(function(t){return a("v-tab",{key:t,attrs:{"data-cy":"tab-status",ripple:"",disabled:e.loading},on:{click:function(a){e.status=t}}},[a("span",{staticClass:"text-capitalize mr-2",domProps:{textContent:e._s(t)}}),a("v-chip",{staticClass:"white--text",attrs:{color:e.$options.tabs[t],small:""},domProps:{textContent:e._s(e.response.stats?e.response.stats[t]:"")}})],1)})),1),a("v-divider"),a("v-data-table",{attrs:{headers:e.headers,items:e.fetchedResults,"sort-desc":e.pagination.descending,"sort-by":e.pagination.sortBy,page:e.pagination.page,"items-per-page":e.pagination.rowsPerPage,"footer-props":e.footerProps,"server-items-length":e.pagination.totalItems,"mobile-breakpoint":0,"must-sort":""},on:{"update:sortDesc":function(t){return e.$set(e.pagination,"descending",t)},"update:sort-desc":function(t){return e.$set(e.pagination,"descending",t)},"update:sortBy":function(t){return e.$set(e.pagination,"sortBy",t)},"update:sort-by":function(t){return e.$set(e.pagination,"sortBy",t)},"update:page":function(t){return e.$set(e.pagination,"page",t)},"update:itemsPerPage":function(t){return e.$set(e.pagination,"rowsPerPage",t)},"update:items-per-page":function(t){return e.$set(e.pagination,"rowsPerPage",t)}},scopedSlots:e._u([{key:"item",fn:function(t){return[a("tr",[["hr","approver"].includes(e.as)?a("td",[a("vue-user",{attrs:{user:t.item.employee}})],1):e._e(),a("td",[e._v(" "+e._s(t.item.reason)+" ")]),a("td",{},[a("div",[e._v(" "+e._s(t.item.created_at.substring(0,10))+" ")]),a("div",{staticClass:"grey--text"},[e._v(" "+e._s(e.getTime(t.item.created_at))+" ")])]),a("td",{staticClass:"text-right"},[t.item.total_amount?a("span",[e._v(" "+e._s(e.formatCurrency(t.item.total_amount||0))+" ")]):a("span",[e._v("N/A")])]),a("td",[a("div",[e._v(" "+e._s(t.item.type)+" ")]),a("div",{staticClass:"grey--text text-caption"},[e._v(" "+e._s(t.item.is_advance_expense?"With advance":"Without advance ")+" ")])]),a("td",{staticClass:"text-center"},["Requested"===t.item.status?a("approval-chip",{attrs:{"user-detail":t.item.recipient[0],status:t.item.status}}):a("v-chip",{attrs:{color:e.$options.tabs[t.item.status],outlined:"",small:""}},[e._v(" "+e._s(t.item.status)+" ")])],1),a("td",[a("vue-context-menu",{attrs:{"context-list":[{name:"View Details",icon:"mdi-eye-outline",color:"blue"},{name:"Cancel",icon:"mdi-cancel",color:"red",hide:"Requested"!==t.item.status||["hr","approver"].includes(e.as)}]},on:{click0:function(a){return e.openViewDetails(t.item)},click1:function(a){e.deleteNotification.dialog=!0,e.selectedRequestId=t.item.id}}})],1)])]}}])},[a("template",{slot:"no-data"},[a("data-table-no-data",{attrs:{loading:e.loading,search:e.search}})],1)],2)],1),a("v-dialog",{attrs:{scrollable:"",width:"960",persistent:""},on:{keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.openRequestForm=!1}},model:{value:e.openRequestForm,callback:function(t){e.openRequestForm=t},expression:"openRequestForm"}},[e.openRequestForm?a("settle-expense-form",{attrs:{"form-type":e.formType},on:{close:function(t){e.openRequestForm=!1},create:function(t){e.openRequestForm=!1,e.loadDataTableChange()}}}):e._e()],1),a("v-dialog",{attrs:{scrollable:"",width:"1160",persistent:""},on:{keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.openNewRequestForm=!1}},model:{value:e.openNewRequestForm,callback:function(t){e.openNewRequestForm=t},expression:"openNewRequestForm"}},[e.openNewRequestForm?a("settle-travel-expense-form",{attrs:{"form-type":e.formType},on:{close:function(t){e.openNewRequestForm=!1,e.loadDataTableChange()},create:function(t){e.openNewRequestForm=!1,e.loadDataTableChange()}}}):e._e()],1),a("v-bottom-sheet",{attrs:{scrollable:""},model:{value:e.openRequestDetail,callback:function(t){e.openRequestDetail=t},expression:"openRequestDetail"}},[e.openRequestDetail?a("view-settle-details",{attrs:{as:e.as,"form-type":e.formType,"request-id":e.requestId},on:{close:function(t){e.openRequestDetail=!1,e.loadDataTableChange()}}}):e._e()],1),a("v-bottom-sheet",{attrs:{scrollable:"",persistent:""},model:{value:e.openTravelRequestDetail,callback:function(t){e.openTravelRequestDetail=t},expression:"openTravelRequestDetail"}},[e.openTravelRequestDetail?a("view-settle-travel-details",{attrs:{as:e.as,"request-id":e.requestId},on:{close:function(t){e.openTravelRequestDetail=!1,e.loadDataTableChange()}}}):e._e()],1),a("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.deleteNotification.dialog,callback:function(t){e.$set(e.deleteNotification,"dialog",t)},expression:"deleteNotification.dialog"}},[e.deleteNotification.dialog?a("v-card",[a("vue-card-title",{attrs:{title:"Confirm Cancel",subtitle:"Are you sure you want to cancel this request.",icon:"mdi-cancel"}}),a("v-card-text",[a("div",[e._v("This action cannot be reverted.")]),a("v-textarea",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{counter:"600",rows:"2"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}},"v-textarea",e.veeValidate("remarks","Remarks *"),!1))],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"black--text",attrs:{text:""},on:{click:function(t){e.deleteNotification.dialog=!1,e.remarks=""}}},[e._v(" Cancel ")]),a("v-btn",{staticClass:"white--text",attrs:{color:"danger",depressed:""},on:{click:e.cancelExpenseRequest}},[e._v(" Cancel Request ")])],1)],1):e._e()],1)],1)},i=[],n=a("1da1"),r=a("5530"),o=(a("96cf"),a("ac1f"),a("841c"),a("4de4"),a("21dd")),l=a("cf45"),c=a("a51f"),d=a("e4bf"),u=a("ef8c"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:"View Expense Settlement/Reimbursement Request detail",subtitle:"Here you can view expense /reimbursement settlement request details.",dark:"",icon:"mdi-eye-outline"}},[a("template",{slot:"actions"},[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({attrs:{icon:"",dark:""},on:{click:function(t){return e.downloadPdf(e.$refs.settlement_detail,"p","request")}}},s),[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-download-outline")}})],1)]}}])},[a("span",[e._v(" Download Pdf ")])]),a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){return e.$emit("close")}}},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-close")}})],1)],1)],2),a("v-card-text",{staticClass:"scrollbar-md"},[a("v-container",{staticClass:"px-6"},[a("v-row",{ref:"settlement_detail",attrs:{align:"center"}},[a("v-col",{attrs:{md:"12",cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-account")}}),e._v(" Requested By ")],1),a("vue-user",{staticClass:"mx-5",attrs:{user:e.requestDetails.employee}})],1),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" TAARF Number ")],1),e.requestDetails.advance_code||e.requestDetails.advance_expense?a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.advance_code||e.requestDetails.advance_expense.advance_code||"N/A")+" ")]):e._e()]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Type ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.type)+" ")])]),e.requestDetails.created_at?a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-calendar")}}),e._v(" Requested Date ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.created_at.substring(0,10))+" ")]),a("div",{staticClass:"mx-5 text-caption grey--text"},[e._v(" "+e._s(e.$dayjs(e.requestDetails.created_at).format("hh:mm:ss a"))+" ")])]):e._e(),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Reason for "+e._s(e.formType)+" ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.reason)+" ")])]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Associate Employee ")],1),e.requestDetails.advance_expense&&e.requestDetails.advance_expense.associates&&e.requestDetails.advance_expense.associates.length?a("div",{staticClass:"mx-5 black--text"},[a("thumbnail-users",{attrs:{users:e.requestDetails.advance_expense.associates,"total-users":e.requestDetails.advance_expense.associates?e.requestDetails.advance_expense.associates.length:0},on:{showMore:function(t){e.showMoreUsers=!0}}})],1):a("div",{staticClass:"mx-5 black--text"},[e._v("No associate employee")])]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-file")}}),e._v(" Uploaded Documents ")],1),e.requestDetails.documents&&e.requestDetails.documents.length?e._l(e.requestDetails.documents,(function(t,s){return a("div",{key:s,staticClass:"mx-5 black--text"},[e._v(" "+e._s(t.name)+" "),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[a("v-icon",e._g({staticClass:"pointer",attrs:{small:"",color:"blue"},domProps:{textContent:e._s("mdi-file-download-outline")},on:{click:function(a){return e.openAttachment(t.attachment)}}},i))]}}],null,!0)},[a("span",[e._v(" View/Download ")])])],1)})):a("div",{staticClass:"mx-5 black--text"},[e._v("No file uploaded")])],2),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Is Taxable ")],1),a("div",{staticClass:"mx-5 black--text"},[a("v-icon",{attrs:{small:"",color:e.requestDetails.is_taxable?"green":"red"},domProps:{textContent:e._s(e.requestDetails.is_taxable?"mdi-check":"mdi-close")}})],1)]),a("v-col",{attrs:{md:"12",cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Description ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.description||"N/A")+" ")])]),e.requestDetails.advance_expense?a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"\n              py-3\n              font-weight-bold\n              pointer\n              blue-grey--text\n              text-subtitle-1\n            ",on:{click:function(t){e.showExpenseDetails=!e.showExpenseDetails}}},[e._v(" Advance Expense Details "),a("v-icon",{attrs:{color:"blue-grey",small:""},domProps:{textContent:e._s(e.showExpenseDetails?"mdi-minus-circle":"mdi-plus-circle")}})],1),a("v-slide-y-transition",[e.showExpenseDetails?a("v-card",{attrs:{outlined:""}},[a("v-card-text",{staticClass:"pa-0"},[a("v-row",{staticClass:"mx-3"},e._l(e.$options.detailHeading,(function(t,s){return a("v-col",{key:s,staticClass:"blue-grey--text font-weight-bold"},[e._v(" "+e._s(t)+" ")])})),1),e._l(e.requestDetails.advance_expense.detail,(function(t,s){return a("v-row",{key:s,staticClass:"mx-3"},[a("v-col",[e._v(" "+e._s(s+1+".")+" ")]),a("v-col",[e._v(" "+e._s(t.heading)+" ")]),a("v-col",[e._v(" "+e._s(t.particulars)+" ")]),a("v-col",[e._v(" "+e._s(t.quantity)+" ")]),a("v-col",[e._v(" "+e._s(t.rate)+" ")]),a("v-col",[e._v(" "+e._s(t.amount||0)+" ")]),a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[e._v("Remarks")]),a("div",{staticClass:"black--text"},[e._v(" "+e._s(t.remarks)+" ")])])],1)}))],2)],1):e._e()],1)],1):e._e(),e.requestDetails&&e.requestDetails.advance_expense?a("v-col",{staticClass:"py-0 text-right"},[a("span",{staticClass:"black--text"},[e._v("Total Amount: ")]),e.requestDetails.advance_expense?a("span",{staticClass:"danger--text font-weight-bold"},[e._v(e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense?e.requestDetails.advance_expense.total_amount:0)))]):e._e()]):e._e(),e.requestDetails&&e.requestDetails.advance_expense?a("v-col",{staticClass:"py-0 text-right"},[a("span",{staticClass:"black--text"},[e._v("Advance Amount: ")]),e.requestDetails.advance_expense?a("span",{staticClass:"danger--text font-weight-bold"},[e._v(e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense?e.requestDetails.advance_expense.advance_amount:0)))]):e._e()]):e._e(),a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"\n              py-3\n              font-weight-bold\n              pointer\n              blue-grey--text\n              text-subtitle-1\n            ",on:{click:function(t){e.showSettleDetails=!e.showSettleDetails}}},[e._v(" Settlement Details "),a("v-icon",{attrs:{color:"blue-grey",small:""},domProps:{textContent:e._s(e.showSettleDetails?"mdi-minus-circle":"mdi-plus-circle")}})],1),a("v-slide-y-transition",[e.showSettleDetails?a("v-card",{attrs:{outlined:""}},[a("v-card-text",{staticClass:"pa-0"},[a("v-row",{staticClass:"mx-3"},[e._l(e.$options.detailHeading,(function(t,s){return a("v-col",{key:s,staticClass:"blue-grey--text font-weight-bold"},[e._v(" "+e._s(t)+" ")])})),a("v-col",{staticClass:"blue-grey--text font-weight-bold"},[e._v(" Bill No. ")])],2),e._l(e.requestDetails.detail,(function(t,s){return a("v-row",{key:s,staticClass:"mx-3"},[a("v-col",[e._v(" "+e._s(s+1+".")+" ")]),a("v-col",[e._v(" "+e._s(t.heading)+" ")]),a("v-col",[e._v(" "+e._s(t.particulars)+" ")]),a("v-col",[e._v(" "+e._s(t.quantity)+" ")]),a("v-col",[e._v(" "+e._s(t.rate)+" ")]),a("v-col",[e._v(" "+e._s(e.formatCurrency(t.amount))+" ")]),a("v-col",[e._v(" "+e._s(t.bill_no)+" ")]),a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[e._v("Remarks")]),a("div",{staticClass:"black--text"},[e._v(" "+e._s(t.remarks)+" ")])])],1)}))],2)],1):e._e()],1)],1),e.showSettleDetails?a("v-col",{staticClass:"pt-0"},[a("v-row",[a("v-col",{staticClass:"text-right"},[a("span",{staticClass:"black--text"},[e._v("Total Amount: ")]),a("span",{staticClass:"danger--text font-weight-bold"},[e._v(e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.total_amount||0)))])])],1)],1):e._e(),e.requestDetails.option&&e.requestDetails.advance_expense?a("v-col",{staticClass:"blue-grey lighten-5 px-5",attrs:{cols:"12"}},[a("div",[e._v(" Total settlement amount "),a("span",{staticClass:"danger--text"},[e._v("( "+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.total_amount||0))+" )")]),e._v(" is "+e._s(e.requestDetails.total_amount>e.requestDetails.advance_expense.advance_amount?"higher":"less")+" than the total advance amount "),e.requestDetails.advance_expense?a("span",{staticClass:"indigo--text"},[e._v("( "+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense.advance_amount||0))+")")]):e._e(),e._v(" by "),e.requestDetails.advance_expense&&e.requestDetails.advance_expense.advance_amount?a("span",{staticClass:"danger--text"},[e._v(" "+e._s(e.requestDetails.currency+". "+e.formatCurrency(Math.abs(e.requestDetails.advance_expense.advance_amount-e.requestDetails.total_amount||0))))]):e._e()]),a("div",[e._v(" Settle Remaining Amount from "+e._s(e.requestDetails.option.settle_with)+" ")]),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-file")}}),e._v(" Attachment ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s("Attachment for "+e.requestDetails.option.settle_with)+" "),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{small:"",color:"blue"},domProps:{textContent:e._s("mdi-file-download-outline")},on:{click:function(t){return e.openAttachment(e.requestDetails.option.attachment)}}},s))]}}],null,!1,1568419907)},[a("span",[e._v(" View/Download ")])])],1)]),a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Remarks ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.option.remark)+" ")])])],1)],1):e._e(),e.requestDetails.advance_expense&&e.requestDetails.advance_expense.advance_amount<e.requestDetails.total_amount&&"Approved"===e.requestDetails.status&&!e.requestDetails.option?a("v-col",{staticClass:"blue-grey lighten-5",attrs:{cols:"12"}},[a("div",[a("div",[e._v(" Total settlement amount "),a("span",{staticClass:"danger--text"},[e._v("( "+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.total_amount||0))+")")]),e._v(" is "+e._s(e.requestDetails.total_amount>e.requestDetails.advance_expense.advance_amount?"higher":"less")+" than the total advance amount "),e.requestDetails.advance_expense?a("span",{staticClass:"indigo--text"},[e._v("( "+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense.advance_amount||0))+")")]):e._e(),e._v(" by "),e.requestDetails.advance_expense?a("span",{staticClass:"danger--text"},[e._v(" "+e._s(e.requestDetails.currency+". "+e.formatCurrency(Math.abs(e.requestDetails.total_amount-e.requestDetails.advance_expense.advance_amount||0))))]):e._e()]),a("div",[e._v("Select option below to settle remaining amount")]),a("v-radio-group",{model:{value:e.options.settle_with,callback:function(t){e.$set(e.options,"settle_with",t)},expression:"options.settle_with"}},e._l(e.settle_options,(function(e,t){return a("div",{key:t},[a("v-radio",{attrs:{label:"Settle with "+e,value:e}})],1)})),0)],1),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[a("file-upload",{attrs:{label:"Cheque"===e.options.settle_with?"Upload Cheque *":"Upload Documents *","hide-details":""},model:{value:e.options.attachment,callback:function(t){e.$set(e.options,"attachment",t)},expression:"options.attachment"}}),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("attachment"))+" ")])],1)],1)],1),a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],attrs:{"prepend-inner-icon":"mdi-information-outline",counter:"600"},model:{value:e.options.remark,callback:function(t){e.$set(e.options,"remark",t)},expression:"options.remark"}},"v-text-field",e.veeValidate("","Remarks"),!1))],1):e._e(),["Requested","Approved"].includes(e.requestDetails.status)?a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-bold blue-grey--text mb-3 text-subtitle-1"},[e._v(" Signature ")]),a("signature-component",{attrs:{"approvals-detail":e.requestDetails.approvals,status:e.requestDetails.status,history:e.requestDetails.history,user:e.requestDetails.employee}})],1):e._e()],1),a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[a("supervisor-level-detail",{attrs:{"approvals-detail":e.requestDetails.approvals}})],1),a("v-col",{staticClass:"blue-grey lighten-5 text-left",attrs:{cols:"12"}},[a("timeline-history",{attrs:{"history-detail":e.requestDetails.history}})],1)],1)],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"black--text",attrs:{text:"","data-cy":"btn-cancel"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),["hr"].includes(e.as)&&["Medical","Other"].includes(e.requestDetails.type)&&["Requested","Approved"].includes(e.requestDetails.status)?a("v-btn",{staticClass:"white--text",attrs:{"data-cy":"btn-taxable",depressed:"",color:"primary"},on:{click:e.openTaxableConfirm}},[e._v(" "+e._s(e.requestDetails.is_taxable?"Exclude from Tax":"Include in Tax")+" ")]):e._e(),["hr"].includes(e.as)&&"Requested"===e.requestDetails.status||["approver"].includes(e.as)&&"Requested"===e.requestDetails.status&&e.recipient||!e.as&&"Requested"===e.requestDetails.status?a("v-btn",{staticClass:"white--text",attrs:{"data-cy":"btn-proceed",depressed:"",color:"primary"},on:{click:function(t){e.showActionForm=!0}}},[e._v(" Proceed ")]):e._e(),["hr"].includes(e.as)&&"Approved"===e.requestDetails.status&&e.requestDetails.advance_expense&&e.requestDetails.advance_expense.advance_amount<e.requestDetails.total_amount&&!e.requestDetails.option?a("v-btn",{staticClass:"white--text",attrs:{"data-cy":"btn-settle-request",depressed:"",color:"success"},on:{click:function(t){return e.postOptions()}}},[e._v(" Settle Request ")]):e._e()],1),e.showMoreUsers&&e.requestDetails.advance_expense?a("user-list-dialog",{attrs:{users:e.requestDetails.advance_expense.associates},on:{close:function(t){e.showMoreUsers=!1}},model:{value:e.showMoreUsers,callback:function(t){e.showMoreUsers=t},expression:"showMoreUsers"}}):e._e(),e.showActionForm?a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.showActionForm,callback:function(t){e.showActionForm=t},expression:"showActionForm"}},[a("proceed-request",{attrs:{as:e.as,"request-detail":e.requestDetails,"request-id":e.requestId},on:{close:function(t){e.showActionForm=!1},update:function(t){e.showActionForm=!1,e.$emit("close")}}})],1):e._e(),a("vue-dialog",{attrs:{notify:e.confirmNotification},on:{close:function(t){e.confirmNotification.dialog=!1},agree:e.changeTaxable}})],1)},m=[],v=(a("a9e3"),a("d3b7"),a("99af"),a("159b"),a("b64b"),a("6a79")),f=a("4c75"),h=a("02cb"),_=a("c44a"),x=a("9815"),g=a("70da"),b=a("cde3"),y=a("f82f"),C=a("d242"),D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:"Advance Expense Request",subtitle:"",icon:"mdi-file-document-outline",closable:""},on:{close:function(t){return e.$emit("close")}}}),a("v-divider"),e.nonFieldErrors?a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}}):e._e(),a("v-card-text",{staticClass:"scrollbar-md"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[e._v(" Select Your Action *: "),a("v-btn-toggle",{staticClass:"mt-3",attrs:{mandatory:"",text:""},model:{value:e.actionButtonToggle,callback:function(t){e.actionButtonToggle=t},expression:"actionButtonToggle"}},[["approver"].includes(e.as)&&"Requested"===e.requestDetail.status?a("v-btn",{class:"approve"===e.actionButtonToggle?"cyan white--text":"text-capitalize",attrs:{small:"",value:"approve","data-cy":"btn-approve"}},[e._v(" Approve ")]):e._e(),["hr","approver"].includes(e.as)&&"Requested"===e.requestDetail.status?a("v-btn",{class:"deny"===e.actionButtonToggle?"red white--text":"text-capitalize",attrs:{value:"deny",small:"","data-cy":"btn-deny"}},[e._v(" Deny ")]):e._e(),e.as||"Requested"!==e.requestDetail.status?e._e():a("v-btn",{class:"cancel"===e.actionButtonToggle?"purple white--text":"text-capitalize",attrs:{value:"cancel",small:"","data-cy":"btn-cancel-request"}},[e._v(" Cancel Request ")])],1)],1),["approve"].includes(e.actionButtonToggle)?a("v-col",{attrs:{cols:"12"}},[["Medical","Other"].includes(e.requestDetail.type)?a("v-checkbox",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],attrs:{dense:"",label:"Amount is subject to TAX. *"},model:{value:e.formValues.is_taxable,callback:function(t){e.$set(e.formValues,"is_taxable",t)},expression:"formValues.is_taxable"}},"v-checkbox",e.veeValidate("is_taxable","Is Taxable"),!1)):e._e(),a("v-checkbox",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|true",expression:"'required|true'"}],attrs:{dense:"",label:"Use your default signature *"},model:{value:e.formValues.add_signature,callback:function(t){e.$set(e.formValues,"add_signature",t)},expression:"formValues.add_signature"}},"v-checkbox",e.veeValidate("add_signature","Signature"),!1))],1):e._e(),a("v-col",{attrs:{cols:"12"}},[a("v-textarea",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{counter:"600","prepend-inner-icon":"mdi-file-document-outline"},model:{value:e.formValues.remarks,callback:function(t){e.$set(e.formValues,"remarks",t)},expression:"formValues.remarks"}},"v-textarea",e.veeValidate("remarks","Remarks *"),!1))],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"black--text",attrs:{text:"",small:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),a("v-btn",{attrs:{"data-cy":"btn-save",color:"primary",small:""},on:{click:function(t){return e.changeStatus()}}},[e._v(" Save ")])],1)],1)},w=[],q=a("ab8a"),k=a("7bb1");k["b"].Validator.extend("true",{getMessage:function(e){return e+" must be selected to use your default signature."},validate:function(e){return!0===e}});var V={components:{NonFieldFormErrors:q["default"]},mixins:[_["a"]],props:{as:{type:String,default:""},requestId:{type:[String,Number],default:""},requestDetail:{type:Object,default:function(){return{}}}},data:function(){return{actionButtonToggle:"",formValues:{}}},created:function(){this.requestDetail.is_taxable&&(this.formValues.is_taxable=!0)},methods:{changeStatus:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.validateAllFields();case 2:if(!t.sent){t.next=4;break}e.$http.post(o["a"].requestAction(e.getOrganizationSlug,e.requestId,e.actionButtonToggle)+"?as=".concat(e.as||""),e.getFormValues()).then((function(){setTimeout((function(){e.notifyUser("Successfully ".concat(e.actionButtonToggle," expense request."))}),1e3),e.$emit("update")})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse()}));case 4:case"end":return t.stop()}}),t)})))()},getFormValues:function(){return this.formValues}}},S=V,A=a("2877"),R=a("6544"),F=a.n(R),E=a("8336"),T=a("a609"),N=a("b0af"),$=a("99d9"),O=a("ac7c"),P=a("62ad"),I=a("ce7e"),j=a("0fd9b"),B=a("2fa4"),U=a("a844"),L=Object(A["a"])(S,D,w,!1,null,null,null),M=L.exports;F()(L,{VBtn:E["a"],VBtnToggle:T["a"],VCard:N["a"],VCardActions:$["a"],VCardText:$["c"],VCheckbox:O["a"],VCol:P["a"],VDivider:I["a"],VRow:j["a"],VSpacer:B["a"],VTextarea:U["a"]});var z={components:{FileUpload:y["a"],UserListDialog:x["default"],ThumbnailUsers:b["default"],TimelineHistory:v["a"],ProceedRequest:M,SignatureComponent:g["a"],SupervisorLevelDetail:f["a"],VueUser:h["default"]},mixins:[_["a"],C["a"]],props:{as:{type:String,default:null},formType:{type:String,default:null},requestId:{type:[String,Number],default:null}},detailHeading:["SN","Heading","Particular","Quantity","Rate","Total Amount"],data:function(){return{loading:!1,showActionForm:!1,showMoreUsers:!1,showExpenseDetails:!0,requestDetails:{},options:{},settle_options:[],recipient:!1,showSettleDetails:!0,confirmNotification:{dialog:!1,heading:"Confirm Your Action",subheading:"",text:""}}},created:function(){this.fetchRequestDetail(),this.getData()},methods:{formatCurrency:l["d"],fetchRequestDetail:function(){var e=this;this.loading||(this.loading=!0,this.$http.get(o["a"].getDetail(this.getOrganizationSlug,this.requestId)+"?as=".concat(this.as,"&expense_type=").concat(this.formType)).then((function(t){e.requestDetails=t,e.checkRecipient(t)})).finally((function(){e.loading=!1})))},getData:function(){var e=this,t="/reimbursement/".concat(this.getOrganizationSlug,"/setting/");this.$http.get(t).then((function(t){e.settle_options=t.results[0].options}))},checkRecipient:function(e){var t=this;e.recipient.forEach((function(e){e.id===t.getAuthStateUserId&&(t.recipient=!0)}))},postOptions:function(){var e=this,t=new FormData;Object.keys(this.options).forEach((function(a){t.append(a,e.options[a])})),this.$http.post(o["a"].settleAmount(this.getOrganizationSlug,this.requestId)+"?as=".concat(this.as,"&expense_type=").concat(this.formType),t).then((function(){e.$emit("close"),e.notifyUser("Successfully settle amount with ".concat(e.options.settle_with,"."))})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse()}))},openTaxableConfirm:function(){this.requestDetails.is_taxable?(this.confirmNotification.subheading="You are about to exclude this transaction from tax.",this.confirmNotification.text="Are you sure your want to exclude this transaction from tax?"):(this.confirmNotification.subheading="You are about to include this transaction in tax.",this.confirmNotification.text="Are you sure your want to include this transaction in tax?"),this.confirmNotification.dialog=!0},changeTaxable:function(){var e=this,t={is_taxable:this.requestDetails.is_taxable?"False":"True"};this.$http.post(o["a"].changeTaxable(this.getOrganizationSlug,this.requestId)+"?as=".concat(this.as),t).then((function(){e.$emit("close");var t=e.requestDetails.is_taxable?"Successfully excluded transaction from tax.":"Successfully included transaction in tax.";e.notifyUser(t)})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse()}))},openAttachment:function(e){window.open(e,"_blank")}}},G=z,H=a("a523"),Y=a("169a"),W=a("132d"),Q=a("67b6"),J=a("43a6"),K=a("0789"),X=a("8654"),Z=a("3a2f"),ee=Object(A["a"])(G,p,m,!1,null,"7dd28b26",null),te=ee.exports;F()(ee,{VBtn:E["a"],VCard:N["a"],VCardActions:$["a"],VCardText:$["c"],VCol:P["a"],VContainer:H["a"],VDialog:Y["a"],VDivider:I["a"],VIcon:W["a"],VRadio:Q["a"],VRadioGroup:J["a"],VRow:j["a"],VSlideYTransition:K["g"],VSpacer:B["a"],VTextField:X["a"],VTooltip:Z["a"]});var ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:"View Travel Expense Settlement/Reimbursement Request detail",subtitle:"Here you can view travel expense /reimbursement settlement request details.",icon:"mdi-eye-outline",dark:""}},[a("template",{slot:"actions"},[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({attrs:{icon:"",dark:""},on:{click:e.downloadDetail}},s),[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-download-outline")}})],1)]}}])},[a("span",[e._v("Download Pdf")])]),a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){return e.$emit("close")}}},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-close")}})],1)],1)],2),a("v-card-text",{staticClass:"scrollbar-md"},[a("v-container",{staticClass:"px-6"},[a("v-row",{ref:"settlement_detail",attrs:{align:"center"}},[a("v-col",{attrs:{md:"12",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-account")}}),e._v(" Requested By ")],1),a("vue-user",{staticClass:"mx-5",attrs:{user:e.requestDetails.employee}})],1),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-calendar")}}),e._v(" Requested Date ")],1),e.requestDetails.created_at?a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.created_at.substring(0,10)||"N/A")+" ")]):e._e(),a("div",{staticClass:"mx-5"},[e._v(" "+e._s(e.$dayjs(e.requestDetails.created_at).format("hh:mm:ss a"))+" ")])]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" TAARF Number ")],1),e.requestDetails.advance_code||e.requestDetails.advance_expense?a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.advance_code||e.requestDetails.advance_expense.advance_code||"N/A")+" ")]):e._e()]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Type ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.type)+" ")])]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Reason for Travel ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(e._s(e.requestDetails.reason))])]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Currency ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(e._s(e.requestDetails.currency))])]),a("v-col",{attrs:{md:"4",cols:"6"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-file")}}),e._v(" Attachments ")],1),e.requestDetails.documents&&e.requestDetails.documents.length?e._l(e.requestDetails.documents,(function(t,s){return a("div",{key:s,staticClass:"mx-5 black--text"},[e._v(" "+e._s(s+1+". "+t.name)+" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(s){var i=s.on;return[a("v-icon",e._g({staticClass:"pointer",attrs:{color:"blue",small:""},domProps:{textContent:e._s("mdi-file-download-outline")},on:{click:function(a){return e.openAttachments(t.attachment)}}},i))]}}],null,!0)},[a("span",[e._v(" View/Download ")])])],1)})):a("div",{staticClass:"mx-5 black--text"},[e._v("No File Uploaded")])],2),a("v-col",{attrs:{md:"6",cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Travel Report ")],1),[e.requestDetails.travel_report?a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.travel_report)+" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({staticClass:"pointer",attrs:{"data-html2canvas-ignore":"true",color:"blue",small:""},domProps:{textContent:e._s("mdi-file-download-outline")},on:{click:function(t){return e.openAttachments(e.requestDetails.travel_report)}}},s))]}}],null,!1,2200632185)},[a("span",[e._v(" View/Download ")])])],1):a("div",{staticClass:"mx-5 black--text"},[e._v("No File Uploaded")])]],2),a("v-col",{attrs:{md:"6",cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Is Taxable ")],1),a("div",{staticClass:"mx-5 black--text"},[a("v-icon",{attrs:{small:"",color:e.requestDetails.is_taxable?"green":"red"},domProps:{textContent:e._s(e.requestDetails.is_taxable?"mdi-check":"mdi-close")}})],1)]),a("v-col",{attrs:{md:"6",cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Description ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.description||"N/A")+" ")])]),e.requestDetails.advance_expense?a("v-col",{attrs:{md:"12",cols:"12"}},[a("div",{staticClass:"\n              py-3\n              font-weight-bold\n              pointer\n              blue-grey--text\n              text-subtitle-1\n            ",on:{click:function(t){e.showRequestAdvanceDetails=!e.showRequestAdvanceDetails}}},[e._v(" Request Advance Details "),a("v-icon",{attrs:{"data-html2canvas-ignore":"true",color:"blue-grey",small:""},domProps:{textContent:e._s(e.showRequestAdvanceDetails?"mdi-minus-circle":"mdi-plus-circle")}})],1),a("v-slide-y-transition",[e.showRequestAdvanceDetails?a("detail-table",{attrs:{"hide-item":"Bill","action-data":e.requestDetails.advance_expense,currency:e.requestDetails.currency},model:{value:e.showRequestAdvanceDetails,callback:function(t){e.showRequestAdvanceDetails=t},expression:"showRequestAdvanceDetails"}}):e._e()],1)],1):e._e(),a("v-col",{attrs:{md:"12",cols:"12"}},[a("div",{staticClass:"\n              py-3\n              font-weight-bold\n              pointer\n              blue-grey--text\n              text-subtitle-1\n            ",on:{click:function(t){e.showSettlementDetails=!e.showSettlementDetails}}},[e._v(" Settlement Details "),a("v-icon",{attrs:{"data-html2canvas-ignore":"true",color:"blue-grey",small:""},domProps:{textContent:e._s(e.showSettlementDetails?"mdi-minus-circle":"mdi-plus-circle")}})],1),a("v-slide-y-transition",[e.showSettlementDetails?a("detail-table",{attrs:{"action-data":e.requestDetails,currency:e.requestDetails.currency},model:{value:e.showSettlementDetails,callback:function(t){e.showSettlementDetails=t},expression:"showSettlementDetails"}}):e._e()],1)],1),a("v-col",{staticClass:"text-right",attrs:{cols:"12"}},[a("span",{staticClass:"black--text"},[e._v(" Requested Advance: ")]),e.requestDetails.advance_expense?a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense.requested_amount||0)))]):a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(" N/A")])]),a("v-col",{staticClass:"text-right",attrs:{cols:"12"}},[a("span",{staticClass:"black--text"},[e._v(" Balance: ")]),e.requestDetails.advance_expense?a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(" "+e._s(e.requestDetails.currency+". "+e.formatCurrency(Math.abs(e.requestDetails.advance_expense.requested_amount-e.requestDetails.total_amount||0))))]):a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(" N/A")])]),e.requestDetails.option&&e.requestDetails.advance_expense?a("v-col",{staticClass:"blue-grey lighten-5 px-5",attrs:{cols:"12"}},[a("div",[e._v(" Total settlement amount "),a("span",{staticClass:"danger--text"},[e._v("( "+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.total_amount||0))+" )")]),e._v(" is "+e._s(e.requestDetails.total_amount>e.requestDetails.advance_expense.requested_amount?"higher":"less")+" than the total requested advance amount "),e.requestDetails.advance_expense?a("span",{staticClass:"indigo--text"},[e._v("("+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense.requested_amount||0))+")")]):e._e(),e._v(" by "),e.requestDetails.advance_expense&&e.requestDetails.advance_expense.total_amount?a("span",{staticClass:"danger--text"},[e._v(" "+e._s(e.requestDetails.currency+". "+e.formatCurrency(Math.abs(e.requestDetails.advance_expense.requested_amount-e.requestDetails.total_amount||0))))]):e._e()]),a("div",[e._v(" Settle Remaining Amount from "),a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s(e.requestDetails.option.settle_with))])]),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-file")}}),e._v(" Attachment ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" Attachment for "+e._s(e.requestDetails.option.settle_with)+" "),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{small:"",color:"blue"},domProps:{textContent:e._s("mdi-file-download-outline")},on:{click:function(t){return e.openAttachments(e.requestDetails.option.attachment)}}},s))]}}],null,!1,3569732592)},[a("span",[e._v(" View/Download ")])])],1)]),a("v-col",{attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Remarks ")],1),a("div",{staticClass:"mx-5 black--text"},[e._v(" "+e._s(e.requestDetails.option.remark)+" ")])])],1)],1):e._e(),a("v-col",{attrs:{cols:"12"}},[e.requestDetails.advance_expense&&"Approved"===e.requestDetails.status&&e.requestDetails.option?a("v-alert",{staticClass:"text-body-2 my-0",attrs:{dense:"",border:"left",text:"",type:"success"}},[e._v(" This expense has been settled. ")]):e._e()],1),["hr"].includes(e.as)&&e.requestDetails.advance_expense&&e.requestDetails.advance_expense.advance_amount<e.requestDetails.total_amount&&"Approved"===e.requestDetails.status&&!e.requestDetails.option?a("v-col",{staticClass:"blue-grey lighten-5",attrs:{cols:"12"}},[a("div",[a("div",[e._v(" Total settlement amount "),a("span",{staticClass:"danger--text"},[e._v("( "+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.total_amount||0))+")")]),e._v(" is "+e._s(e.requestDetails.total_amount>e.requestDetails.advance_expense.advance_amount?"higher":"less")+" than the total advance amount "),e.requestDetails.advance_expense?a("span",{staticClass:"indigo--text"},[e._v("("+e._s(e.requestDetails.currency+". "+e.formatCurrency(e.requestDetails.advance_expense.advance_amount||0))+")")]):e._e(),e._v(" by "),e.requestDetails.advance_expense?a("span",{staticClass:"danger--text"},[e._v(" "+e._s(e.requestDetails.currency+". "+e.formatCurrency(Math.abs(e.requestDetails.total_amount-e.requestDetails.advance_expense.advance_amount||0))))]):e._e()]),a("div",[e._v("Select option below to settle remaining amount")]),a("v-radio-group",{model:{value:e.options.settle_with,callback:function(t){e.$set(e.options,"settle_with",t)},expression:"options.settle_with"}},e._l(e.settle_options,(function(e,t){return a("div",{key:t},[a("v-radio",{attrs:{label:"Settle with "+e,value:e}})],1)})),0)],1),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[a("file-upload",{attrs:{label:"Cheque"===e.options.settle_with?"Upload Cheque *":"Upload Documents *","hide-details":""},model:{value:e.options.attachment,callback:function(t){e.$set(e.options,"attachment",t)},expression:"options.attachment"}}),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("attachment"))+" ")])],1)],1)],1),a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{"prepend-inner-icon":"mdi-information-outline",counter:"600"},model:{value:e.options.remark,callback:function(t){e.$set(e.options,"remark",t)},expression:"options.remark"}},"v-text-field",e.veeValidate("","Remarks *"),!1))],1):e._e(),["Requested","Approved"].includes(e.requestDetails.status)?a("v-col",{attrs:{cols:"12"}},[a("signature-component",{attrs:{"approvals-detail":e.requestDetails.approvals,status:e.requestDetails.status,history:e.requestDetails.history,user:e.requestDetails.employee}})],1):e._e()],1),a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[a("supervisor-level-detail",{attrs:{"approvals-detail":e.requestDetails.approvals}})],1),e.requestDetails.history&&e.requestDetails.history.length?a("v-col",{staticClass:"blue-grey lighten-5",attrs:{cols:"12"}},[a("timeline-history",{attrs:{"history-detail":e.requestDetails.history}})],1):e._e()],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"black--text",attrs:{text:"","data-cy":"btn-cancel"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),["hr"].includes(e.as)&&"Requested"===e.requestDetails.status||["approver"].includes(e.as)&&"Requested"===e.requestDetails.status&&e.recipient||!e.as&&"Requested"===e.requestDetails.status?a("v-btn",{staticClass:"white--text",attrs:{"data-cy":"btn-proceed",depressed:"",color:"primary"},on:{click:function(t){e.showActionForm=!0}}},[e._v(" Proceed ")]):e._e(),["hr"].includes(e.as)&&"Approved"===e.requestDetails.status&&e.requestDetails.advance_expense&&e.requestDetails.advance_expense.advance_amount<e.requestDetails.total_amount&&!e.requestDetails.option?a("v-btn",{staticClass:"white--text",attrs:{"data-cy":"btn-settle-request",depressed:"",color:"success"},on:{click:function(t){return e.postOptions()}}},[e._v(" Settle Request ")]):e._e()],1),e.showActionForm?a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.showActionForm,callback:function(t){e.showActionForm=t},expression:"showActionForm"}},[a("proceed-request",{attrs:{as:e.as,"request-detail":e.requestDetails,"request-id":e.requestId},on:{close:function(t){e.showActionForm=!1},update:function(t){e.showActionForm=!1,e.$emit("close")}}})],1):e._e()],1)},se=[],ie=a("0eb3"),ne={components:{VueUser:h["default"],SupervisorLevelDetail:f["a"],DetailTable:ie["a"],SignatureComponent:g["a"],TimelineHistory:v["a"],ProceedRequest:M,FileUpload:y["a"]},mixins:[_["a"],C["a"]],props:{requestId:{type:[String,Number],default:""},as:{type:String,default:""}},data:function(){return{loading:!1,showActionForm:!1,showRequestAdvanceDetails:!0,showSettlementDetails:!0,requestDetails:{detail:[]},options:{},recipient:!1,settle_options:[]}},created:function(){this.fetchRequestDetail(),this.getData()},methods:{formatCurrency:l["d"],getData:function(){var e=this,t="/reimbursement/".concat(this.getOrganizationSlug,"/setting/");this.$http.get(t).then((function(t){e.settle_options=t.results[0].options}))},fetchRequestDetail:function(){var e=this;this.loading||(this.loading=!0,this.$http.get(o["a"].getDetail(this.getOrganizationSlug,this.requestId)+"?as=".concat(this.as,"&expense_type=travel")).then((function(t){e.requestDetails=t,e.checkRecipient(t)})).finally((function(){e.loading=!1})))},checkRecipient:function(e){var t=this;e.recipient.forEach((function(e){e.id===t.getAuthStateUserId&&(t.recipient=!0)}))},postOptions:function(){var e=this,t=new FormData;Object.keys(this.options).forEach((function(a){t.append(a,e.options[a])})),this.$http.post(o["a"].settleAmount(this.getOrganizationSlug,this.requestId)+"?as=".concat(this.as,"&expense_type=travel"),t).then((function(){e.$emit("close"),e.notifyUser("Successfully settle amount with ".concat(e.options.settle_with,"."))})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse()}))},openAttachments:function(e){window.open(e,"_blank")},downloadDetail:function(){this.showRequestAdvanceDetails=!0,this.showSettlementDetails=!0,this.downloadPdf(this.$refs.settlement_detail,"p","request")}}},re=ne,oe=a("0798"),le=Object(A["a"])(re,ae,se,!1,null,"a1b70e38",null),ce=le.exports;F()(le,{VAlert:oe["a"],VBtn:E["a"],VCard:N["a"],VCardActions:$["a"],VCardText:$["c"],VCol:P["a"],VContainer:H["a"],VDialog:Y["a"],VIcon:W["a"],VRadio:Q["a"],VRadioGroup:J["a"],VRow:j["a"],VSlideYTransition:K["g"],VSpacer:B["a"],VTextField:X["a"],VTooltip:Z["a"]});var de=a("9d79"),ue=a("1806"),pe=a("ac94"),me=a("e88d"),ve=a("2f62"),fe=a("c5d2"),he={requestTypes:["Travel","Business","Medical","Other"],components:{ApprovalChip:me["a"],DateFilterMenu:pe["a"],VueContextMenu:d["default"],DataTableNoData:c["default"],SettleExpenseForm:de["a"],ViewSettleDetails:te,ViewSettleTravelDetails:ce,VueUser:h["default"],VueUsersAutoComplete:u["default"],SettleTravelExpenseForm:fe["a"]},mixins:[ue["a"]],props:{heading:{type:Object,default:function(){return{}}},as:{type:String,default:""},endpoint:{type:String,default:null}},tabs:{Requested:"orange",Approved:"green",Denied:"red",Canceled:"grey",All:"cyan"},data:function(){return{deleteNotification:{dialog:!1},selectedRequestId:"",remarks:"",requestId:"",filter:{search:"",type:"",user:"",show:!1},openRequestForm:!1,openNewRequestForm:!1,formType:"",openRequestDetail:!1,openTravelRequestDetail:!1,crud:{name:"Settlement Request",endpoint:{common:"",get:"",post:"",put:"",patch:"",delete:""},id:"id",dataTableFetch:!0},dateFilter:{},headers:[{text:"Employee Name",align:"left",value:"employee"},{text:"Reason for Advance",align:"left",width:"20%",value:"title"},{text:"Requested Date",align:"",value:"created_at"},{text:"Requested Total Amount",align:"right",sortable:!1},{text:"Type",align:"left",value:"type",sortable:!0},{text:"Status",align:"center",sortable:!1},{text:"Action",align:"",sortable:!1}],rowsPerPageItems:[10,20,30,40,50],search:"",activeTab:0,loading:!1,status:"Requested"}},computed:{DataTableFilter:function(){return{status:"All"===this.status?"":this.status,search:this.filter.search||"",type:this.filter.type||"",employee:this.filter.user||"",from_date:this.dateFilter.start_date||"",to_date:this.dateFilter.end_date||""}}},created:function(){this.crud.endpoint.common=this.endpoint||o["a"].getRequest(this.getOrganizationSlug)+"?as=".concat(this.as),this.as||this.headers.shift()},methods:Object(r["a"])(Object(r["a"])({},Object(ve["d"])({setSnackbar:"common/setSnackBar"})),{},{formatCurrency:l["d"],cancelExpenseRequest:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.validateAllFields();case 2:if(!t.sent){t.next=4;break}e.$http.post(o["a"].requestAction(e.getOrganizationSlug,e.selectedRequestId,"cancel"),{remarks:e.remarks}).then((function(){e.setSnackbar({text:"Successfully cancelled your request.",color:"green"}),e.deleteNotification.dialog=!1,e.loadDataTableChange(),e.remarks=""})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse()}));case 4:case"end":return t.stop()}}),t)})))()},getTime:function(e){return this.$dayjs(e).format("hh:mm:ss")},openViewDetails:function(e){this.requestId=e.id,this.formType=e.type,"Travel"===e.type?this.openTravelRequestDetail=!0:this.openRequestDetail=!0},displayForm:function(e){this.formType=e,"Travel"===e?this.openNewRequestForm=!0:this.openRequestForm=!0}})},_e=he,xe=a("288c"),ge=a("cc20"),be=a("8fea"),ye=a("8860"),Ce=a("da13"),De=a("5d23"),we=a("e449"),qe=a("b974"),ke=a("71a3"),Ve=a("fe57"),Se=Object(A["a"])(_e,s,i,!1,null,null,null);t["a"]=Se.exports;F()(Se,{VBottomSheet:xe["a"],VBtn:E["a"],VCard:N["a"],VCardActions:$["a"],VCardText:$["c"],VChip:ge["a"],VCol:P["a"],VDataTable:be["a"],VDialog:Y["a"],VDivider:I["a"],VIcon:W["a"],VList:ye["a"],VListItem:Ce["a"],VListItemTitle:De["c"],VMenu:we["a"],VRow:j["a"],VSelect:qe["a"],VSlideYTransition:K["g"],VSpacer:B["a"],VTab:ke["a"],VTabs:Ve["a"],VTextarea:U["a"]})},a79c:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n}));var s=a("53ca");a("b0c0");function i(e,t,a){var r,o,l=t||new FormData;for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c))if(r=a?a+"."+c:c,o=e[c],"boolean"===typeof o||"number"===typeof o)l.append(r,o);else if(Array.isArray(o))for(var d=0;d<o.length;d++)l.append(r,o[d]);else"object"!==Object(s["a"])(o)||n(o)?n(o)?l.append(r,o,o.name):o?l.append(r,o):o||"undefined"!==typeof o&&l.append(r,""):i(o,l,c);return l}function n(e){return e instanceof File||e instanceof Blob}},b1a9:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{attrs:{dense:"",align:"start"}},[a("v-col",{attrs:{md:"6",cols:"12"}},[a("file-upload",{staticClass:"pr-2",attrs:{label:"Attachment",hint:"Files with jpg, png, odt extensions are not available for preview."},model:{value:e.attachment,callback:function(t){e.attachment=t},expression:"attachment"}})],1),a("v-col",{attrs:{md:"6",cols:"12"}},[a("v-text-field",{staticClass:"pl-2",attrs:{"data-cy":"input-caption",disabled:!e.attachment,label:"Caption"},model:{value:e.caption,callback:function(t){e.caption=t},expression:"caption"}},[a("v-icon",{attrs:{slot:"append-outer","data-cy":"btn-add-attachment",color:"primary"},on:{click:e.appendFile},slot:"append-outer"},[e._v(" mdi-plus-box-outline ")])],1)],1)],1)},i=[],n=a("5530"),r=a("f82f"),o=a("2f62"),l={components:{FileUpload:r["a"]},props:{value:{type:Array,default:function(){return[]}}},data:function(){return{attachment:"",caption:"",attachments:[]}},watch:{attachments:function(e){this.$emit("input",e)}},methods:Object(n["a"])(Object(n["a"])({},Object(o["d"])({setSnackBar:"common/setSnackBar"})),{},{appendFile:function(){this.attachment&&this.caption?(this.setSnackBar({display:!1}),this.attachments.unshift({file:this.attachment,caption:this.caption}),this.attachment=null,this.caption=""):this.setSnackBar({text:"Please add both attachment and caption",color:"red"})}})},c=l,d=a("2877"),u=a("6544"),p=a.n(u),m=a("62ad"),v=a("132d"),f=a("0fd9b"),h=a("8654"),_=Object(d["a"])(c,s,i,!1,null,null,null);t["a"]=_.exports;p()(_,{VCol:m["a"],VIcon:v["a"],VRow:f["a"],VTextField:h["a"]})},c5d2:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:"Travel Expense Report",subtitle:"Here you can settle expense for Travel.",icon:"mdi-send",closable:""},on:{close:function(t){return e.$emit("close")}}}),a("v-divider"),a("v-card-text",{staticClass:"scrollbar-md"},[e.nonFieldErrors?a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}}):e._e(),a("v-row",{attrs:{"no-gutters":"",align:"start"}},[a("v-col",{staticClass:"pt-3",attrs:{md:"4",cols:"12"}},[e.settleFromExpense?a("div",[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Reason for "+e._s(e.formType)+" * "),a("div",{staticClass:"black--text mx-5"},[e._v(" "+e._s(e.requestDetail.reason)+" ")])],1):a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:255",expression:"'required|max:255'"}],staticClass:"mx-2",attrs:{counter:"255","prepend-inner-icon":"mdi-information-outline"},model:{value:e.formValues.reason,callback:function(t){e.$set(e.formValues,"reason",t)},expression:"formValues.reason"}},"v-text-field",e.veeValidate("reason","Reason for "+e.formType+" *"),!1))],1),a("v-col",{staticClass:"pt-3",attrs:{md:"4",cols:"12"}},[e.settleFromExpense?a("div",{staticClass:"mx-5 mt-1 black--text"},[e._v(" "+e._s(e.requestDetail.currency)+" ")]):a("v-autocomplete",{attrs:{items:e.CURRENCIES,label:"Currency"},model:{value:e.formValues.currency,callback:function(t){e.$set(e.formValues,"currency",t)},expression:"formValues.currency"}})],1),a("v-col",{staticClass:"pt-3",attrs:{md:"4",cols:"12"}},[e.settleFromExpense?a("div",[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Total Requested Advance Amount "),a("div",{staticClass:"black--text mx-5"},[e._v(" "+e._s(e.formatCurrency(e.requestDetail.requested_amount))+" ")])],1):a("div",[a("div",{staticClass:"font-weight-medium"},[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Type ")],1),a("div",{staticClass:"mx-5 mt-1 black--text"},[e._v(" "+e._s(e.formType)+" ")])])]),a("v-col",{attrs:{cols:"12"}},[e.settleFromExpense?a("div",[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-information-outline")}}),e._v(" Description "),a("div",{staticClass:"black--text mx-5"},[e._v(" "+e._s(e.requestDetail.description||"N/A")+" ")])],1):a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],attrs:{counter:"600","prepend-inner-icon":"mdi-text"},model:{value:e.formValues.description,callback:function(t){e.$set(e.formValues,"description",t)},expression:"formValues.description"}},"v-text-field",e.veeValidate("description","Description"),!1))],1),a("v-col",{attrs:{cols:"12"}},[a("v-row",{staticClass:"pointer pl-3",attrs:{align:"center"},on:{click:function(t){e.showPerDiem=!e.showPerDiem}}},[a("div",{staticClass:"font-weight-bold text-subtitle-1 py-3"},[e._v("Per Diem")]),a("v-icon",{domProps:{textContent:e._s(e.showPerDiem?"mdi-menu-up":"mdi-menu-down")}})],1),e.showPerDiem?a("v-card",{attrs:{outlined:""}},[a("v-row",{staticClass:"mx-3",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v(" Departure ")])]),a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v("Arrival")])])],1),a("v-divider"),a("v-row",{staticClass:"ma-3",attrs:{"no-gutters":""}},e._l(e.heading,(function(t,s){return a("v-col",{key:s,staticClass:"blue-grey--text font-weight-bold",class:"Amount"===t.text?"text-center":"",attrs:{cols:t.cols}},[e._v(" "+e._s(t.text)+" ")])})),1),a("v-divider"),a("v-row",{staticClass:"ma-3",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},e._l(e.perDiem,(function(t,s){return a("v-row",{key:s,attrs:{align:"start","no-gutters":""}},[a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("vue-date-time-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mx-2",attrs:{"default-time":"09:00"},model:{value:t.departure_time,callback:function(a){e.$set(t,"departure_time",a)},expression:"item.departure_time"}},"vue-date-time-picker",e.veeValidate("departure_time"+s,"From Date"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:255",expression:"'max:255'"}],staticClass:"mx-2",attrs:{counter:"255"},model:{value:t.departure_place,callback:function(a){e.$set(t,"departure_place",a)},expression:"item.departure_place"}},"v-text-field",e.veeValidate("departure_place"+s,"Enter place"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("vue-date-time-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mx-2",attrs:{"default-time":"17:00"},model:{value:t.arrival_time,callback:function(a){e.$set(t,"arrival_time",a)},expression:"item.arrival_time"}},"vue-date-time-picker",e.veeValidate("arrival_time"+s,"To Date"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:255",expression:"'max:255'"}],staticClass:"mx-2",attrs:{counter:"255"},model:{value:t.arrival_place,callback:function(a){e.$set(t,"arrival_place",a)},expression:"item.arrival_place"}},"v-text-field",e.veeValidate("arrival_place"+s,"Enter place"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",attrs:{type:"number",min:"1"},model:{value:t.day,callback:function(a){e.$set(t,"day",a)},expression:"item.day"}},"v-text-field",e.veeValidate("day"+s,"Enter Days"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",attrs:{min:"0",type:"number"},model:{value:t.rate_per_day,callback:function(a){e.$set(t,"rate_per_day",a)},expression:"item.rate_per_day"}},"v-text-field",e.veeValidate("rate_per_day"+s,"Enter rate per day"),!1))],1),a("v-col",{staticClass:"text-center py-0 pt-7",attrs:{md:"2"}},[e._v(" "+e._s(e.formatCurrency(t.day*t.rate_per_day))+" ")]),a("v-col",{attrs:{md:"1"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v(" Bill.No. ")])]),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],model:{value:t.bill_no,callback:function(a){e.$set(t,"bill_no",a)},expression:"item.bill_no"}},"v-text-field",e.veeValidate("bill_no"+s,"Enter Bill.No"),!1))],1),a("v-col",{attrs:{md:"1"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v(" Description ")])]),a("v-col",{staticClass:"py-0",attrs:{md:e.perDiem.length>1?"7":"8"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],attrs:{counter:"600"},model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"item.description"}},"v-text-field",e.veeValidate("description["+s+"]","Enter Description"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[e.perDiem.length>1?a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.perDiem.splice(s,1)}}},[a("v-icon",{staticClass:"pointer",attrs:{color:"red"},domProps:{textContent:e._s("mdi-delete-outline")}})],1):e._e()],1)],1)})),1),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-btn",{staticClass:"font-weight-bold",attrs:{text:"",small:"",color:"primary"},on:{click:function(t){return e.addNewRow()}}},[a("v-icon",{domProps:{textContent:e._s("mdi-plus-box-outline")}}),e._v(" Add Another Date ")],1)],1)],1)],1):e._e()],1),a("v-col",{staticClass:"text-right py-0 pt-2"},[a("span",{staticClass:"black--text"},[e._v(" Sub Total: ")]),a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s((e.requestDetail.currency||e.formValues.currency)+". "+e.formatCurrency(e.totalAmount)))])]),a("v-col",{staticClass:"text-right py-0 pt-2",attrs:{cols:"12"}},[a("v-btn",{staticClass:"font-weight-bold",attrs:{text:"",color:"primary"},on:{click:function(t){return e.copyPerDiem()}}},[e._v(" Copy Per Diem ")])],1),a("v-col",{attrs:{cols:"12"}},[a("v-row",{staticClass:"pointer pl-3",attrs:{align:"center"},on:{click:function(t){e.showLodging=!e.showLodging}}},[a("div",{staticClass:"font-weight-bold text-subtitle-1 py-3"},[e._v("Lodging")]),a("v-icon",{domProps:{textContent:e._s(e.showLodging?"mdi-menu-up":"mdi-menu-down")}})],1),e.showLodging?a("v-card",{attrs:{outlined:""}},[a("v-row",{staticClass:"mx-3",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v(" Departure ")])]),a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v("Arrival")])])],1),a("v-divider"),a("v-row",{staticClass:"ma-3",attrs:{"no-gutters":""}},e._l(e.heading,(function(t,s){return a("v-col",{key:s,staticClass:"blue-grey--text font-weight-bold",class:"Amount"===t.text?"text-center":"",attrs:{cols:t.cols}},[e._v(" "+e._s(t.text)+" ")])})),1),a("v-divider"),a("v-row",{staticClass:"ma-3",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},e._l(e.lodging,(function(t,s){return a("v-row",{key:s,attrs:{align:"start","no-gutters":""}},[a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("vue-date-time-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mx-2",attrs:{"default-time":"09:00"},model:{value:t.departure_time,callback:function(a){e.$set(t,"departure_time",a)},expression:"item.departure_time"}},"vue-date-time-picker",e.veeValidate("departure_time"+s+"-lodging","From Date"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:255",expression:"'max:255'"}],staticClass:"mx-2",attrs:{counter:"255"},model:{value:t.departure_place,callback:function(a){e.$set(t,"departure_place",a)},expression:"item.departure_place"}},"v-text-field",e.veeValidate("departure_place"+s+"-lodging","Enter place"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("vue-date-time-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mx-2",attrs:{"default-time":"17:00"},model:{value:t.arrival_time,callback:function(a){e.$set(t,"arrival_time",a)},expression:"item.arrival_time"}},"vue-date-time-picker",e.veeValidate("arrival_time"+s+"-lodging","To Date"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:255",expression:"'max:255'"}],staticClass:"mx-2",attrs:{counter:"255"},model:{value:t.arrival_place,callback:function(a){e.$set(t,"arrival_place",a)},expression:"item.arrival_place"}},"v-text-field",e.veeValidate("arrival_place"+s+"-lodging","Enter place"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",attrs:{type:"number",min:"1"},model:{value:t.day,callback:function(a){e.$set(t,"day",a)},expression:"item.day"}},"v-text-field",e.veeValidate("day"+s+"-lodging","Enter Days"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",attrs:{min:"0",type:"number"},model:{value:t.rate_per_day,callback:function(a){e.$set(t,"rate_per_day",a)},expression:"item.rate_per_day"}},"v-text-field",e.veeValidate("rate_per_day"+s+"-lodging","Enter rate per day"),!1))],1),a("v-col",{staticClass:"text-center py-0 pt-7",attrs:{md:"2"}},[e._v(" "+e._s(e.formatCurrency(t.day*t.rate_per_day))+" ")]),a("v-col",{attrs:{md:"1"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v(" Bill.No. ")])]),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],model:{value:t.bill_no,callback:function(a){e.$set(t,"bill_no",a)},expression:"item.bill_no"}},"v-text-field",e.veeValidate("bill_no"+s+"-lodging","Enter Bill.No"),!1))],1),a("v-col",{attrs:{md:"1"}},[a("div",{staticClass:"blue-grey--text font-weight-bold py-3"},[e._v(" Description ")])]),a("v-col",{staticClass:"py-0",attrs:{md:e.lodging.length>1?"7":"8"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],attrs:{counter:"600"},model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"item.description"}},"v-text-field",e.veeValidate("description["+s+"]-lodging","Enter Description"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[e.lodging.length>1?a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.lodging.splice(s,1)}}},[a("v-icon",{staticClass:"pointer",attrs:{color:"red"},domProps:{textContent:e._s("mdi-delete-outline")}})],1):e._e()],1)],1)})),1),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-btn",{staticClass:"font-weight-bold",attrs:{text:"",small:"",color:"primary"},on:{click:function(t){return e.addNewRowForLodging()}}},[a("v-icon",{domProps:{textContent:e._s("mdi-plus-box-outline")}}),e._v(" Add Another Date ")],1)],1)],1)],1):e._e()],1),a("v-col",{staticClass:"text-right py-0 pt-2"},[a("span",{staticClass:"black--text"},[e._v(" Sub Total: ")]),a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s((e.requestDetail.currency||e.formValues.currency)+". "+e.formatCurrency(e.totalAmountForLodging)))])]),a("v-col",{attrs:{cols:"12"}},[a("v-row",{staticClass:"pointer pl-3",attrs:{align:"center"},on:{click:function(t){e.showOthers=!e.showOthers}}},[a("div",{staticClass:"font-weight-bold text-subtitle-1 py-3"},[e._v("Others")]),a("v-icon",{domProps:{textContent:e._s(e.showOthers?"mdi-menu-up":"mdi-menu-down")}})],1),e.showOthers?a("v-card",{attrs:{outlined:""}},[a("v-row",{staticClass:"ma-3",attrs:{"no-gutters":""}},e._l(e.headingforOthers,(function(t,s){return a("v-col",{key:s,staticClass:"blue-grey--text font-weight-bold",class:"Amount"===t.text?"text-center":"",attrs:{cols:t.cols}},[e._v(" "+e._s(t.text)+" ")])})),1),a("v-divider"),a("v-row",{staticClass:"ma-3",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},e._l(e.others,(function(t,s){return a("v-row",{key:s,attrs:{align:"start","no-gutters":""}},[a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("vue-date-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mx-2",model:{value:t.date,callback:function(a){e.$set(t,"date",a)},expression:"item.date"}},"vue-date-picker",e.veeValidate("date"+s+"-others","Select Date"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:255",expression:"'max:255'"}],staticClass:"mx-2",attrs:{counter:"255"},model:{value:t.heading,callback:function(a){e.$set(t,"heading",a)},expression:"item.heading"}},"v-text-field",e.veeValidate("heading"+s+"-others","Enter heading"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",attrs:{type:"number",min:"1"},model:{value:t.day,callback:function(a){e.$set(t,"day",a)},expression:"item.day"}},"v-text-field",e.veeValidate("day"+s+"-others","Enter Unit"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",attrs:{min:"1",type:"number"},model:{value:t.rate_per_day,callback:function(a){e.$set(t,"rate_per_day",a)},expression:"item.rate_per_day"}},"v-text-field",e.veeValidate("rate_per_day"+s+"-others","Enter Unit Price"),!1))],1),a("v-col",{staticClass:"text-center py-0 pt-7",attrs:{md:"2"}},[e._v(" "+e._s(e.formatCurrency(t.day*t.rate_per_day))+" ")]),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"mr-2",model:{value:t.bill_no,callback:function(a){e.$set(t,"bill_no",a)},expression:"item.bill_no"}},"v-text-field",e.veeValidate("bill_no"+s+"-others","Enter Bill.No"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:e.others.length>1?"2":"3"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"max:600",expression:"'max:600'"}],staticClass:"mr-2",attrs:{counter:"600"},model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"item.description"}},"v-text-field",e.veeValidate("description["+s+"]-others","Enter Description"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"1"}},[e.others.length>1?a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.others.splice(s,1)}}},[a("v-icon",{staticClass:"pointer",attrs:{color:"red"},domProps:{textContent:e._s("mdi-delete-outline")}})],1):e._e()],1)],1)})),1),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-btn",{staticClass:"font-weight-bold",attrs:{text:"",small:"",color:"primary"},on:{click:function(t){return e.addNewRowForOthers()}}},[a("v-icon",{domProps:{textContent:e._s("mdi-plus-box-outline")}}),e._v(" Add Another Date ")],1)],1)],1)],1):e._e()],1),a("v-col",{staticClass:"text-right py-0 pt-2"},[a("span",{staticClass:"black--text"},[e._v(" Sub Total: ")]),a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s((e.requestDetail.currency||e.formValues.currency)+". "+e.formatCurrency(e.totalAmountForOthers)))])])],1),a("v-row",[a("v-col",{staticClass:"text-right py-0 pt-2",attrs:{cols:"12"}},[a("span",{staticClass:"black--text"},[e._v(" Grand Total: ")]),a("span",{staticClass:"font-weight-bold indigo--text"},[e._v(e._s((e.requestDetail.currency||e.formValues.currency)+". "+e.formatCurrency(e.totalAmount+e.totalAmountForLodging+e.totalAmountForOthers)||0))])])],1),a("v-row",["Travel"===e.formType?a("v-col",{staticClass:"text-right py-0 pt-2",attrs:{md:"4",cols:"12"}},[a("file-upload",e._b({directives:[{name:"validate",rawName:"v-validate",value:e.travel_report_mandatory?"required":"",expression:"travel_report_mandatory? 'required':''"}],model:{value:e.formValues.travel_report,callback:function(t){e.$set(e.formValues,"travel_report",t)},expression:"formValues.travel_report"}},"file-upload",e.veeValidate("travel_report",e.travel_report_mandatory?"Travel_Report *":"Travel Report"),!1))],1):e._e()],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"auto"}},[a("create-task-attachments",{model:{value:e.attachments,callback:function(t){e.attachments=t},expression:"attachments"}}),a("div",{staticClass:"py-0"},e._l(e.attachments,(function(t,s){return a("ul",{key:s},[a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(i){var n=i.hover;return a("li",{},[a("span",[e._v(" "+e._s(t.caption)+" "),n?a("a",{on:{click:function(t){return e.attachments.splice(s,1)}}},[a("v-icon",{attrs:{color:"danger",small:""}},[e._v("mdi-close")])],1):e._e()])])}}],null,!0)})],1)})),0)],1)],1),e.settleFromExpense&&e.requestDetail.advance_amount>e.totalAmount+e.totalAmountForLodging+e.totalAmountForOthers?a("v-row",{staticClass:"pt-9"},[a("v-col",{staticClass:"blue-grey lighten-5",attrs:{cols:"12"}},[a("div",[a("div",[e._v(" Total settlement amount "),a("span",{staticClass:"danger--text"},[e._v("("+e._s(e.requestDetail.currency+" "+e.formatCurrency(e.totalAmount+e.totalAmountForLodging+e.totalAmountForOthers||0))+")")]),e._v(" is "+e._s(e.totalAmount+e.totalAmountForLodging+e.totalAmountForOthers>e.requestDetail.total_amount?"higher":"less")+" than the total requested advance amount "),a("span",{staticClass:"indigo--text"},[e._v("("+e._s(e.requestDetail.currency+". "+e.formatCurrency(e.requestDetail.requested_amount))+")")]),e._v(" by "),a("span",{staticClass:"danger--text"},[e._v(" "+e._s(e.requestDetail.currency+" "+e.formatCurrency(Math.abs(e.requestDetail.requested_amount-e.totalAmount-e.totalAmountForLodging-e.totalAmountForOthers))))])]),a("div",[e._v("Select option below to settle remaining amount")]),a("v-radio-group",{model:{value:e.options.settle_with,callback:function(t){e.$set(e.options,"settle_with",t)},expression:"options.settle_with"}},e._l(e.settle_options,(function(e,t){return a("div",{key:t},[a("v-radio",{attrs:{label:"Settle with "+e,value:e}})],1)})),0)],1),a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[a("file-upload",{attrs:{label:"Cheque"===e.options.settle_with?"Upload Cheque *":"Upload Documents *","hide-details":""},model:{value:e.options.attachment,callback:function(t){e.$set(e.options,"attachment",t)},expression:"options.attachment"}}),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("attachment"))+" ")])],1)],1)],1),a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{"prepend-inner-icon":"mdi-information-outline",counter:"600"},model:{value:e.options.remark,callback:function(t){e.$set(e.options,"remark",t)},expression:"options.remark"}},"v-text-field",e.veeValidate("","Remarks *"),!1))],1)],1):e._e(),a("v-row",[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{counter:"600","prepend-inner-icon":"mdi-text"},model:{value:e.formValues.remarks,callback:function(t){e.$set(e.formValues,"remarks",t)},expression:"formValues.remarks"}},"v-text-field",e.veeValidate("remarks","Remarks *"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-checkbox",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|true",expression:"'required|true'"}],attrs:{label:"Use your default signature *"},model:{value:e.formValues.add_signature,callback:function(t){e.$set(e.formValues,"add_signature",t)},expression:"formValues.add_signature"}},"v-checkbox",e.veeValidate("add_signature","Signature"),!1))],1)],1),e.requiresApproversSelection?a("div",{staticClass:"font-weight-bold blue-grey--text text-subtitle-1 py-3"},[e._v(" Select Approvers ")]):e._e(),e.requiresApproversSelection?a("v-card",{attrs:{outlined:""}},[a("v-card-text",[a("v-row",{attrs:{align:"center"}},e._l(e.approvalList,(function(t,s){return a("v-col",{key:t.approval_level,attrs:{cols:"12",lg:"6",md:"6",sm:"12"}},[a("vue-users-auto-complete",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{params:{user_status:"current"},"items-to-include":t.employee},model:{value:e.selected_approvers[s].employee,callback:function(t){e.$set(e.selected_approvers[s],"employee",t)},expression:"selected_approvers[index].employee"}},"vue-users-auto-complete",e.veeValidate("selectedApprovers["+s+"]","Approval Level "+t.approval_level),!1))],1)})),1)],1)],1):e._e()],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"black--text",attrs:{text:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),a("v-btn",{attrs:{color:"primary",depressed:""},on:{click:function(t){return e.save()}}},[e._v(" Save ")])],1)],1)},i=[],n=a("1da1"),r=(a("96cf"),a("a9e3"),a("d81d"),a("99af"),a("159b"),a("b0c0"),a("a4d3"),a("e01a"),a("b64b"),a("c44a")),o=a("741f"),l=a("d567"),c=a("a79c"),d=a("f12b"),u=a("b1a9"),p=a("cf45"),m=a("ab8a"),v=a("21dd"),f=a("f82f"),h=a("6e28"),_=a("7bb1"),x=a("a438"),g=a("ef8c");_["b"].Validator.extend("true",{getMessage:function(e){return e+" must be selected to use your default signature."},validate:function(e){return!0===e}});var b={components:{NonFieldFormErrors:m["default"],VueDatePicker:o["default"],VueDateTimePicker:l["a"],FileUpload:f["a"],CreateTaskAttachments:u["a"],VueUsersAutoComplete:g["default"]},mixins:[d["a"],r["a"]],props:{settleFromExpense:{type:[String,Number],default:""},as:{type:String,default:""},formType:{type:String,default:""}},data:function(){return{selected_approvers:[],approvalList:[],endpoint:"",formValues:{currency:"NPR"},attachments:[],requestDetail:{detail:[]},settle_options:[],attachment:null,showPerDiem:!0,showLodging:!0,showOthers:!0,options:{},heading:[{text:"Date/Time",cols:"2"},{text:"Place",cols:"2"},{text:"Date/Time",cols:"2"},{text:"Place",cols:"2"},{text:"Days",cols:"1"},{text:"Rate per day",cols:"1"},{text:"Amount",cols:"2",align:"right"}],headingforOthers:[{text:"Date",cols:"2"},{text:"Description",cols:"2"},{text:"Unit",cols:"1"},{text:"Unit Price",cols:"1"},{text:"Amount",cols:"2",align:"right"},{text:"Bill.No",cols:"1"},{text:"Description",cols:"2"}],perDiem:[],lodging:[],others:[],travel_report_mandatory:null,CURRENCIES:x["a"]}},computed:{totalAmount:function(){return this.perDiem.map((function(e){return e.day*e.rate_per_day})).reduce(this.getSum,0)||0},totalAmountForLodging:function(){return this.lodging.map((function(e){return e.day*e.rate_per_day})).reduce(this.getSum,0)||0},totalAmountForOthers:function(){return this.others.map((function(e){return e.day*e.rate_per_day})).reduce(this.getSum,0)||0},requiresApproversSelection:function(){return this.selected_approvers.length>0}},created:function(){this.getSettlementOption(),this.settleFromExpense?this.fetchRequestDetail():(this.addNewRow(),this.addNewRowForLodging(),this.addNewRowForOthers()),this.endpoint=v["a"].postRequest(this.getOrganizationSlug)+"?as=".concat(this.as,"&expense_type=").concat(this.formType),this.getSelectedApprovers()},methods:{formatCurrency:p["d"],getSelectedApprovers:function(){var e=this,t=v["a"].getSelectableApprovers(this.getOrganizationSlug);this.getData(t).then((function(t){e.approvalList=t,e.approvalList.forEach((function(t){e.selected_approvers.push({approval_level:t.approval_level,employee:[]})}))}))},addNewRow:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.perDiem.push({departure_time:"",departure_place:"",arrival_time:"",arrival_place:"",day:1,rate_per_day:0,bill_no:"",description:""});case 1:case"end":return t.stop()}}),t)})))()},addNewRowForLodging:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.lodging.push({departure_time:"",departure_place:"",arrival_time:"",arrival_place:"",day:1,rate_per_day:0,bill_no:"",description:""});case 1:case"end":return t.stop()}}),t)})))()},addNewRowForOthers:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.others.push({date:"",heading:"",day:1,rate_per_day:0,bill_no:"",description:""});case 1:case"end":return t.stop()}}),t)})))()},getSum:function(e,t){return e+t},getSettlementOption:function(){var e=this,t="/reimbursement/".concat(this.getOrganizationSlug,"/setting/");this.$http.get(t).then((function(t){e.settle_options=t.results[0].options,e.travel_report_mandatory=t.results[0].travel_report_mandatory}))},fetchRequestDetail:function(){var e=this;this.$http.get(h["a"].getDetail(this.getOrganizationSlug,this.settleFromExpense)+"?as=".concat(this.as,"&expense_type=").concat(this.formType)).then((function(t){e.requestDetail=t,e.populateFormValues(t)}))},populateFormValues:function(e){var t=this;e.documents.forEach((function(e){t.attachments.push({file:e.attachment,caption:e.name})})),e.detail.forEach((function(e){"Per diem"===e.detail_type&&t.perDiem.push({departure_time:e.departure_time,departure_place:e.departure_place,arrival_time:e.arrival_time,arrival_place:e.arrival_place,day:e.day,rate_per_day:e.rate_per_day,description:e.description}),"Lodging"===e.detail_type&&t.lodging.push({departure_time:e.departure_time,departure_place:e.departure_place,arrival_time:e.arrival_time,arrival_place:e.arrival_place,day:e.day,rate_per_day:e.rate_per_day,description:e.description}),"Other"===e.detail_type&&t.others.unshift({heading:e.heading,date:e.date,day:e.day,rate_per_day:e.rate_per_day,description:e.description})}))},getFormValues:function(){var e=this,t={reason:this.settleFromExpense?this.requestDetail.reason:this.formValues.reason,currency:this.settleFromExpense?this.requestDetail.currency:this.formValues.currency,description:this.settleFromExpense?this.requestDetail.description:this.formValues.description,remark:this.formValues.remarks,add_signature:this.formValues.add_signature},a=[];this.perDiem.forEach((function(e){""===e.departure_time&&""===e.departure_place&&""===e.arrival_time&&""===e.arrival_place||a.push({detail_type:"Per diem",departure_time:e.departure_time,departure_place:e.departure_place,arrival_time:e.arrival_time,arrival_place:e.arrival_place,day:e.day,rate_per_day:e.rate_per_day,bill_no:e.bill_no,description:e.description})})),this.lodging.forEach((function(e){""===e.departure_time&&""===e.departure_place&&""===e.arrival_time&&""===e.arrival_place||a.push({detail_type:"Lodging",departure_time:e.departure_time,departure_place:e.departure_place,arrival_time:e.arrival_time,arrival_place:e.arrival_place,day:e.day,rate_per_day:e.rate_per_day,bill_no:e.bill_no,description:e.description})})),this.others.forEach((function(e){""===e.heading&&""===e.date||a.push({detail_type:"Other",heading:e.heading,date:e.date,day:e.day,rate_per_day:e.rate_per_day,bill_no:e.bill_no,description:e.description})}));var s=Object(c["b"])(t);for(var i in a.forEach((function(e,t){s.append("detail[".concat(t,"]detail_type"),e.detail_type),s.append("detail[".concat(t,"]departure_time"),e.departure_time||""),s.append("detail[".concat(t,"]departure_place"),e.departure_place||""),s.append("detail[".concat(t,"]arrival_time"),e.arrival_time||""),s.append("detail[".concat(t,"]arrival_place"),e.arrival_place||""),s.append("detail[".concat(t,"]heading"),e.heading||""),s.append("detail[".concat(t,"]date"),e.date||""),s.append("detail[".concat(t,"]day"),e.day),s.append("detail[".concat(t,"]rate_per_day"),e.rate_per_day),s.append("detail[".concat(t,"]bill_no"),e.bill_no||0),s.append("detail[".concat(t,"]description"),e.description||"")})),this.attachments.forEach((function(e,t){s.append("attachment[".concat(t,"]"),e.file),s.append("name[".concat(t,"]"),e.caption)})),this.settleFromExpense&&s.append("advance_expense",this.settleFromExpense),this.requestDetail.advance_amount>this.totalAmount+this.totalAmountForLodging+this.totalAmountForOthers&&Object.keys(this.options).length&&Object.keys(this.options).forEach((function(t){s.append("option.".concat(t),e.options[t])})),this.formValues.travel_report&&s.append("travel_report",this.formValues.travel_report),this.selected_approvers){var n=this.selected_approvers[i];s.append("selected_approvers[".concat(i,"]approval_level"),n.approval_level),s.append("selected_approvers[".concat(i,"]recipient"),n.employee)}return s},save:function(){this.crud.message="Travel settlement request submitted successfully.",this.insertData(this.endpoint,this.getFormValues())},copyPerDiem:function(){this.lodging=this.deepCopy(this.perDiem)}}},y=b,C=a("2877"),D=a("6544"),w=a.n(D),q=a("c6a6"),k=a("8336"),V=a("b0af"),S=a("99d9"),A=a("ac7c"),R=a("62ad"),F=a("ce7e"),E=a("ce87"),T=a("132d"),N=a("67b6"),$=a("43a6"),O=a("0fd9b"),P=a("2fa4"),I=a("8654"),j=Object(C["a"])(y,s,i,!1,null,"3d91ed6e",null);t["a"]=j.exports;w()(j,{VAutocomplete:q["a"],VBtn:k["a"],VCard:V["a"],VCardActions:S["a"],VCardText:S["c"],VCheckbox:A["a"],VCol:R["a"],VDivider:F["a"],VHover:E["a"],VIcon:T["a"],VRadio:N["a"],VRadioGroup:$["a"],VRow:O["a"],VSpacer:P["a"],VTextField:I["a"]})},ce87:function(e,t,a){"use strict";var s=a("16b7"),i=a("f2e7"),n=a("58df"),r=a("d9bd");t["a"]=Object(n["a"])(s["a"],i["a"]).extend({name:"v-hover",props:{disabled:{type:Boolean,default:!1},value:{type:Boolean,default:void 0}},methods:{onMouseEnter:function(){this.runDelay("open")},onMouseLeave:function(){this.runDelay("close")}},render:function(){return this.$scopedSlots.default||void 0!==this.value?(this.$scopedSlots.default&&(e=this.$scopedSlots.default({hover:this.isActive})),Array.isArray(e)&&1===e.length&&(e=e[0]),e&&!Array.isArray(e)&&e.tag?(this.disabled||(e.data=e.data||{},this._g(e.data,{mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave})),e):(Object(r["c"])("v-hover should only contain a single element",this),e)):(Object(r["c"])("v-hover is missing a default scopedSlot or bound value",this),null);var e}})},f0d5:function(e,t,a){"use strict";a("d3b7"),a("3ca3"),a("ddb0");var s=a("c44a");t["a"]={components:{NonFieldFormErrors:function(){return a.e("chunk-6441e173").then(a.bind(null,"ab8a"))}},mixins:[s["a"]],data:function(){return{crud:{name:"record",message:"",addAnother:!1},formValues:{},loading:!1}}}},f12b:function(e,t,a){"use strict";var s=a("f0d5"),i=a("983c"),n=a("f70a"),r=a("6c6f");t["a"]={mixins:[s["a"],i["a"],n["a"],r["a"]]}},f70a:function(e,t,a){"use strict";a("d3b7"),a("caad");t["a"]={methods:{insertData:function(e,t){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=s.validate,n=void 0===i||i,r=s.clearForm,o=void 0===r||r,l=arguments.length>3?arguments[3]:void 0;return new Promise((function(s,i){!a.loading&&e&&(a.clearErrors(),a.$validator.validateAll().then((function(r){n||(r=!0),r&&(a.loading=!0,a.$http.post(e,t,l||{}).then((function(e){a.clearErrors(),o&&(a.formValues={}),a.crud.addAnother||a.$emit("create"),a.crud.message&&setTimeout((function(){a.notifyUser(a.crud.message)}),1e3),s(e),a.loading=!1})).catch((function(e){a.pushErrors(e),a.notifyInvalidFormResponse(),i(e),a.loading=!1})))})))}))},patchData:function(e,t){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=s.validate,n=void 0===i||i,r=s.clearForm,o=void 0===r||r,l=arguments.length>3?arguments[3]:void 0;return new Promise((function(s,i){a.updateData(e,t,{validate:n,clearForm:o},"patch",l).then((function(e){s(e)})).catch((function(e){i(e)}))}))},putData:function(e,t){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=s.validate,n=void 0===i||i,r=s.clearForm,o=void 0===r||r,l=arguments.length>3?arguments[3]:void 0;return new Promise((function(s,i){a.updateData(e,t,{validate:n,clearForm:o},"put",l).then((function(e){s(e)})).catch((function(e){i(e)}))}))},updateData:function(e,t){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=s.validate,n=void 0===i||i,r=s.clearForm,o=void 0===r||r,l=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;return new Promise((function(s,i){!a.loading&&e&&["put","patch"].includes(l)&&(a.clearErrors(),a.$validator.validateAll().then((function(r){n||(r=!0),r&&(a.loading=!0,a.$http[l](e,t,c||{}).then((function(e){a.$emit("update"),a.clearErrors(),o&&(a.formValues={}),a.crud.message&&setTimeout((function(){a.notifyUser(a.crud.message)}),1e3),s(e),a.loading=!1})).catch((function(e){a.pushErrors(e),a.notifyInvalidFormResponse(),i(e),a.loading=!1})))})))}))},clearErrors:function(){this.clearNonFieldErrors(),this.$validator.errors.clear()}}}},f72a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vue-page-wrapper",{attrs:{title:e.htmlTitle,"bread-crumbs":e.breadCrumbItems}},[a("settle-data-table",{attrs:{as:"hr",heading:e.heading}})],1)},i=[],n=a("0549"),r=a("a133"),o={components:{SettleDataTable:r["a"],VuePageWrapper:n["default"]},data:function(){return{htmlTitle:"Settle Expense Request | Expense Management | Admin",breadCrumbItems:[{text:"Expense Management",disabled:!0},{text:"Settle Requests",disabled:!0}],heading:{title:"Expense Settlement/Reimbursement Request",subheading:"The list below contains list of settle expanse by you."}}}},l=o,c=a("2877"),d=Object(c["a"])(l,s,i,!1,null,"5f339a26",null);t["default"]=d.exports},f82f:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-text-field",{class:e.appliedClass,attrs:{id:e.id,label:e.label,"data-cy":"input-file-upload",error:e.errorMessages.length>0,"error-messages":e.errorMessages,"hide-details":e.hideDetails,hint:e.hint,"persistent-hint":!!e.hint,disabled:e.disabled,readonly:"","prepend-inner-icon":"mdi-attachment","append-icon":"mdi-close"},on:{"click:prepend":e.pickFile,"click:append":function(t){return e.clear()},click:e.pickFile,blur:function(t){return e.$emit("blur")}},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),a("input",{ref:"upload",staticClass:"d-none",attrs:{id:"fileUpload",type:"file",multiple:"multiple"},on:{change:e.upload}})],1)},i=[],n=a("1da1"),r=a("5530"),o=(a("96cf"),a("a9e3"),a("ac1f"),a("1276"),a("b0c0"),a("2f62")),l={props:{value:{type:[String,File,Object],default:void 0},default:{type:[String,File],default:void 0},text:{type:String,default:void 0},id:{type:String,default:""},label:{type:String,default:"Browse file from here"},hint:{type:String,default:void 0},errorMessages:{type:[String,Array],default:function(){return[]}},hideDetails:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},appliedClass:{type:String,default:""},returnObject:{type:Boolean,default:!1},maxSize:{type:Number,default:5}},data:function(){return{fileName:null}},watch:{default:{handler:function(e){!e||e instanceof File||(this.fileName=e)},immediate:!0},value:function(e){e||(this.fileName=""),document.getElementById("fileUpload").value=null}},methods:Object(r["a"])(Object(r["a"])({},Object(o["d"])({setSnackBar:"common/setSnackBar"})),{},{pickFile:function(){this.$refs.upload.click()},upload:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:s=new FileReader,s.readAsDataURL(e.target.files[0]),i="",1===e.target.files[0].name.split(".").length?i="Please upload known file type.":e.target.files[0].size>1024*t.maxSize*1024?i="File size cannot be greater than ".concat(t.maxSize,"MB."):"svg"===e.target.files[0].name.split(".").pop()&&(i="SVG image not allowed here."),i?t.setSnackBar({text:i,color:"red"}):s.onload=function(){t.returnObject?t.$emit("input",{file_name:e.target.files[0].name,file_content:e.target.files[0]}):t.$emit("input",e.target.files[0]),t.$emit("blur"),t.$emit("update",s.result),t.fileName=e.target.files[0].name};case 5:case"end":return a.stop()}}),a)})))()},clear:function(){this.fileName=null,this.returnObject?this.$emit("input",{file_name:"",file_content:""}):this.$emit("input",this.fileName)}})},c=l,d=a("2877"),u=a("6544"),p=a.n(u),m=a("8654"),v=Object(d["a"])(c,s,i,!1,null,null,null);t["a"]=v.exports;p()(v,{VTextField:m["a"]})}}]);