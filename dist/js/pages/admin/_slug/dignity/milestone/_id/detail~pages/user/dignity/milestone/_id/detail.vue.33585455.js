(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/admin/_slug/dignity/milestone/_id/detail~pages/user/dignity/milestone/_id/detail.vue","chunk-2d2160c2","chunk-2d2160c2","chunk-2d2160c2","chunk-2d2160c2","chunk-2d2160c2"],{"1ed9":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"mb-3"},[i("vue-card-title",{attrs:{title:"Milestone Attachments",subtitle:"Refer the following information for milestone attachments.",icon:"mdi-file-document-outline",clickable:""},on:{click:function(e){t.showMore=!t.showMore}}},[i("template",{slot:"actions"},[i("v-avatar",{attrs:{size:"30",color:"teal"}},[i("span",{staticClass:"white--text text-caption font-weight-bold",domProps:{textContent:t._s(t.attachmentCount)}})]),i("v-icon",{staticClass:"pointer",domProps:{textContent:t._s(t.showMore?"mdi-menu-up":"mdi-menu-down")},on:{click:function(e){t.showMore=!t.showMore}}})],1)],2),t.showMore?i("div",[i("v-divider"),i("v-card-text",[t.milestoneAttachments.length?t._l(t.milestoneAttachments,(function(e,a){return i("v-row",{key:a,staticClass:"ma-3",attrs:{align:"start"}},[i("v-hover",{scopedSlots:t._u([{key:"default",fn:function(n){var s=n.hover;return i("div",{},[i("span",[t._v(" "+t._s(a+1)+". "+t._s(e.caption||"N/A")+" ")]),i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var n=a.on;return[i("v-icon",t._g({attrs:{small:""},domProps:{textContent:t._s("mdi-eye-outline")},on:{click:function(i){return t.viewAttachment(e.attachment)}}},n))]}}],null,!0)},[i("span",{domProps:{textContent:t._s("View Attachment")}})]),i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var n=a.on;return[i("v-icon",t._g({attrs:{size:"13"},domProps:{textContent:t._s("mdi-content-save-outline")},on:{click:function(i){return t.downloadAttachment(e.attachment)}}},n))]}}],null,!0)},[i("span",{domProps:{textContent:t._s("Download Attachment")}})]),s&&t.isHradmin?i("v-icon",{attrs:{small:""},domProps:{textContent:t._s("mdi-close")},on:{click:function(e){t.deleteNotification.dialog=!0,t.deleteAttachmentIndex=a}}}):t._e()],1)}}],null,!0)})],1)})):i("vue-no-data",{attrs:{height:100,text:"There are no attachments on this milestones"}})],2),i("v-divider"),t.milestoneDetail.approved||t.readOnly||!t.canAddAttachments()?t._e():i("v-card-actions",{staticClass:"primaryLight"},[i("v-row",{staticClass:"px-3",attrs:{align:"center"}},[i("v-col",[i("file-upload",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{hint:"Files with jpg, png, odt extensions isn't available for preview."},model:{value:t.form.attachment,callback:function(e){t.$set(t.form,"attachment",e)},expression:"form.attachment"}},"file-upload",t.veeValidate("attachment","Attachment *"),!1))],1),i("v-col",[i("v-text-field",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],model:{value:t.form.caption,callback:function(e){t.$set(t.form,"caption",e)},expression:"form.caption"}},"v-text-field",t.veeValidate("caption","Caption *"),!1))],1),i("v-col",{staticClass:"mr-3",attrs:{cols:"1"}},[i("v-btn",{attrs:{small:"",color:"primary",depressed:""},domProps:{textContent:t._s("Add")},on:{click:t.addAttachment}})],1)],1)],1)],1):t._e(),i("vue-dialog",{attrs:{notify:t.deleteNotification},on:{close:function(e){t.deleteNotification.dialog=!1},agree:t.deleteAttachment}})],1)},n=[],s=i("1da1"),o=i("5530"),l=(i("96cf"),i("a434"),i("b0c0"),i("f82f")),r=i("e585"),c=i("c44a"),d=i("2f62"),m=i("dd34"),u={components:{FileUpload:l["a"],VueNoData:r["default"]},mixins:[c["a"]],props:{milestoneDetail:{type:Object,required:!0},readOnly:{type:Boolean,default:!0},isHradmin:{type:Boolean,default:!1}},data:function(){return{form:{attachment:"",caption:""},deleteAttachmentIndex:null,deleteNotification:{dialog:!1,heading:"Confirm Delete",text:"Are you sure you want to delete this attachment?"},attachmentCount:"",milestoneAttachments:[],showMore:!1}},computed:Object(o["a"])({},Object(d["c"])({getAuthStateUser:"auth/getAuthStateUser"})),created:function(){this.getMilestoneAttachments()},methods:{canAddAttachments:function(){return this.milestoneDetail.assigned_to.id===this.getAuthStateUserId||this.milestoneDetail.created_by.id===this.getAuthStateUserId},getMilestoneAttachments:function(){var t=this;this.$http.get(m["a"].getMilestoneAttachment(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,this.milestoneDetail.id)).then((function(e){t.milestoneAttachments=e.results,t.attachmentCount=e.count}))},deleteAttachment:function(){var t=this,e=this.milestoneAttachments[this.deleteAttachmentIndex].id;this.$http.delete(m["a"].deleteMilestoneAttachment(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,this.milestoneDetail.id,e)).then((function(){t.notifyUser("Successfully deleted attachment","green"),t.deleteNotification.dialog=!1,t.milestoneAttachments.splice(t.deleteAttachmentIndex,1),t.getMilestoneAttachments()}))},addAttachment:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.validateAllFields();case 2:if(!e.sent){e.next=8;break}i=new FormData,i.append("attachment",t.form.attachment,t.form.attachment.name),i.append("caption",t.form.caption),i.append("milestone",t.milestoneDetail.id),t.$http.post(m["a"].postMilestoneAttachment(t.getOrganizationSlug,t.$route.params.id,t.$route.params.goalId,t.milestoneDetail.id),i).then((function(e){t.notifyUser("Successfully uploaded attachment","green"),t.milestoneAttachments.push(e),t.form={},t.getMilestoneAttachments()})).catch((function(e){t.pushErrors(e)}));case 8:case"end":return e.stop()}}),e)})))()},downloadAttachment:function(t){window.open(t)},viewAttachment:function(t){var e="https://docs.google.com/viewerng/viewer?url=".concat(t);window.open(e,"_blank")}}},h=u,p=i("2877"),v=i("6544"),f=i.n(v),g=i("8212"),_=i("8336"),C=i("b0af"),x=i("99d9"),k=i("62ad"),b=i("ce7e"),y=i("ce87"),D=i("132d"),w=i("0fd9b"),A=i("8654"),S=i("3a2f"),V=Object(p["a"])(h,a,n,!1,null,null,null);e["a"]=V.exports;f()(V,{VAvatar:g["a"],VBtn:_["a"],VCard:C["a"],VCardActions:x["a"],VCardText:x["c"],VCol:k["a"],VDivider:b["a"],VHover:y["a"],VIcon:D["a"],VRow:w["a"],VTextField:A["a"],VTooltip:S["a"]})},"5f9e":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"mb-3"},[i("vue-card-title",{attrs:{icon:"mdi-file-document-outline",title:"Milestones CheckLists",subtitle:"List of checklist"}},[i("template",{slot:"actions"},[i("v-icon",{domProps:{textContent:t._s(t.showMore?"mdi-menu-up":"mdi-menu-down")},on:{click:function(e){t.showMore=!t.showMore}}})],1)],2),t.showMore?i("div",[i("v-divider"),i("v-card-text",[i("v-col",[i("v-row",[i("v-col",{attrs:{md:"6",cols:"12"}},[i("div",{domProps:{textContent:t._s("Pending Checklist")}}),1===t.milestoneDetail.status?i("span",[t._v("'Please move the milestone to "),i("b",[t._v("In Progress")]),t._v(" to complete checklist'")]):t._e(),t.loading?i("div",{domProps:{textContent:t._s("Loading pending checklist.")}}):t.pendingChecklists.length?t._l(t.pendingChecklists,(function(e){return i("v-checkbox",{key:e.id,attrs:{value:!1,label:e.check_list_title,disabled:!(2===t.milestoneDetail.status&&(t.userId===t.getAuthStateUser.user.id||t.isHrAdmin)),"hide-details":""},on:{change:function(i){t.checkListID=e.id,t.completemilestone()}}})})):i("div",{domProps:{textContent:t._s("All checklists are completed")}})],2),i("v-divider",{attrs:{vertical:""}}),i("v-col",{attrs:{md:"5",cols:"12"}},[i("div",{domProps:{textContent:t._s("Completed Checklist")}}),t.loading?i("div",{domProps:{textContent:t._s("Loading completed checklist.")}}):t.completedChecklists.length?i("v-list",t._l(t.completedChecklists,(function(e){return i("div",{key:e.id,attrs:{avatar:""}},[i("strong",[t._v(t._s(e.check_list_title))]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var n=a.on;return[2!==t.milestoneDetail.status||t.userId!==t.getAuthStateUser.user.id&&!t.isHrAdmin?t._e():i("v-icon",t._g({attrs:{size:"15"},domProps:{textContent:t._s("mdi-undo-variant")},on:{click:function(i){t.checkListID=e.id,t.UndoCheckList()}}},n))]}}],null,!0)},[i("span",[t._v("Undo Checklist")])])],1)})),0):i("div",{domProps:{textContent:t._s("No checklists are completed yet")}})],1)],1)],1)],1)],1):t._e(),i("vue-dialog",{attrs:{notify:t.completeChecklist},on:{close:function(e){t.completeChecklist.dialog=!1},agree:t.completemilestone}})],1)},n=[],s=i("1da1"),o=i("5530"),l=(i("96cf"),i("a9e3"),i("4de4"),i("d3b7"),i("2f62")),r=i("63e9"),c={props:{milestoneId:{type:[Number,String],required:!0},userId:{type:[Number,String],required:!0},milestoneDetail:{type:Object,required:!0},readOnly:{type:Boolean,default:!0},isHrAdmin:{type:Boolean,default:!1}},data:function(){return{completeChecklist:{heading:"Confirm Completion",text:"Are you sure you want to complete this check list?",dialog:!1},checkListID:null,showMore:!0,milestone:"",checkLists:[],completion:0,completedChecklists:[],pendingChecklists:[],loading:!1}},computed:Object(o["a"])({},Object(l["c"])({getAuthStateUser:"auth/getAuthStateUser"})),watch:{milestone:function(){this.completedChecklists=this.milestone.results.filter((function(t){return t.completed_on})),this.pendingChecklists=this.milestone.results.filter((function(t){return!t.completed_on}))}},created:function(){this.fetchChecklistDetail()},methods:Object(o["a"])(Object(o["a"])({},Object(l["d"])({setSnackBar:"common/setSnackBar"})),{},{fetchChecklistDetail:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$http.get(r["a"].getMilestoneCheckList(t.getOrganizationSlug,t.$route.params.id,t.$route.params.goalId,t.milestoneId)).then((function(e){t.milestone=e,t.checklists=e.results})).finally((function(){t.loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},completemilestone:function(){var t=this;this.loading=!0,this.pendingChecklists=[],this.$http.post(r["a"].completeMilestoneCheckList(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,this.milestoneId,this.checkListID)+(this.isHrAdmin?"?as=hr":"")).then((function(){t.setSnackBar({text:"Successfully completed checklist.",color:"green"}),t.checkListID=null,t.completeChecklist.dialog=!1,t.fetchChecklistDetail()}))},UndoCheckList:function(){var t=this;this.loading=!0,this.completedChecklists=[],this.$http.post(r["a"].completeMilestoneCheckList(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,this.milestoneId,this.checkListID)+(this.isHrAdmin?"?as=hr":"")).then((function(){t.setSnackBar({text:"Successfully Undone checklist.",color:"green"}),t.checkListID=null,t.completeChecklist.dialog=!1,t.fetchChecklistDetail()}))}})},d=c,m=i("2877"),u=i("6544"),h=i.n(u),p=i("b0af"),v=i("99d9"),f=i("ac7c"),g=i("62ad"),_=i("ce7e"),C=i("132d"),x=i("8860"),k=i("0fd9b"),b=i("3a2f"),y=Object(m["a"])(d,a,n,!1,null,null,null);e["a"]=y.exports;h()(y,{VCard:p["a"],VCardText:v["c"],VCheckbox:f["a"],VCol:g["a"],VDivider:_["a"],VIcon:C["a"],VList:x["a"],VRow:k["a"],VTooltip:b["a"]})},"8f4e":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"mb-3"},[i("vue-card-title",{attrs:{title:"Milestone Comments",subtitle:"Refer the following information for comments on this milestone.",icon:"mdi-message-processing-outline",clickable:""},on:{click:function(e){t.showMore=!t.showMore}}},[i("template",{slot:"actions"},[i("v-icon",{staticClass:"pointer",domProps:{textContent:t._s(t.showMore?"mdi-menu-up":"mdi-menu-down")},on:{click:function(e){t.showMore=!t.showMore}}})],1)],2),t.showMore?i("div",[i("v-divider"),t.loading?i("v-skeleton-loader",{attrs:{type:"table"}}):t._e(),i("v-card-text",[t.loading?t._e():i("div",[t.comments.length?i("v-list",t._l(t.comments,(function(e,a){return i("v-list-item",{key:e.id},[i("v-list-item-avatar",[i("v-img",{attrs:{src:e.created_by.profile_picture}})],1),i("v-list-item-content",[i("v-list-item-title",[i("a",{staticClass:"mr-2",domProps:{textContent:t._s(e.created_by.full_name)},on:{click:function(i){return t.viewProfileDetail(e.created_by.id)}}}),i("span",{staticClass:"mx-1 text-caption grey--text",domProps:{textContent:t._s(t.humanizeDate(e.created_at))}})]),i("v-list-item-subtitle",{staticClass:"my-1"},[i("div",{style:t.showIndex===a?"display: none":"display: block"},[t._v(" "+t._s(e.comment.slice(0,110))+" ")]),e.comment.length>90?i("a",{style:t.showIndex===a?"display: none":"display: block",on:{click:function(e){t.showIndex=a}}},[t._v("Read more")]):t._e(),t.showIndex===a?i("div",{staticClass:"text-wrap",domProps:{innerHTML:t._s(t.getClickableLink(e.comment))}}):t._e()])],1),i("v-list-item-icon",[e.created_by.id===t.auth.user.id?i("v-menu",{attrs:{bottom:"",right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-icon",t._g({attrs:{small:""},domProps:{textContent:t._s("mdi-menu-down")}},a))]}}],null,!0)},[i("v-list",[i("v-list-item",{on:{click:function(e){t.deleteNotification.dialog=!0,t.selectedCommentIndex=a}}},[i("v-list-item-title",[i("v-icon",{attrs:{small:""},domProps:{textContent:t._s("mdi-delete")}}),i("span",{domProps:{textContent:t._s("Delete Comment")}})],1)],1)],1)],1):t._e()],1)],1)})),1):i("vue-no-data",{attrs:{height:100,text:"There are no comments on this milestone"}}),0!==t.nextCommentsCount?i("div",{staticClass:"text-center"},[i("a",{staticClass:"font-weight-bold",on:{click:function(e){t.limit+=5,t.getComments()}}},[t._v("View "+t._s(t.nextCommentsCount)+" more comments")])]):t._e()],1)]),i("v-divider"),!t.readOnly&&t.canComment()?i("v-card-actions",{staticClass:"primaryLight"},[i("v-row",{staticClass:"px-4",attrs:{align:"center","no-gutters":""}},[i("v-col",{attrs:{cols:"1"}},[i("v-avatar",{attrs:{size:"35"}},[i("v-img",{attrs:{src:t.auth.user.profile_picture}})],1)],1),i("v-col",[i("v-textarea",t._b({directives:[{name:"validate",rawName:"v-validate",value:"max:1000",expression:"'max:1000'"}],staticStyle:{width:"100%"},attrs:{rows:"1",placeholder:"Add a comment",type:"text"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.addComment.apply(null,arguments))}},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}},"v-textarea",t.veeValidate("comment",""),!1))],1)],1)],1):t._e()],1):t._e(),i("vue-dialog",{attrs:{notify:t.deleteNotification},on:{close:function(e){t.deleteNotification.dialog=!1},agree:t.deleteComment}})],1)},n=[],s=i("5530"),o=(i("a434"),i("c44a")),l=i("2f62"),r=i("dd34"),c=i("ea98"),d=i("e585"),m=i("cf45"),u={components:{VueDialog:c["a"],VueNoData:d["default"]},mixins:[o["a"]],props:{milestoneDetail:{type:Object,required:!0},readOnly:{type:Boolean,default:!0}},data:function(){return{deleteNotification:{dialog:!1,heading:"Confirm Delete",text:"Are you sure you want to delete this comment?"},comment:"",comments:[],selectedCommentIndex:null,loading:!0,showMore:!0,showIndex:null,count:null,limit:5}},computed:Object(s["a"])(Object(s["a"])({},Object(l["c"])({auth:"auth/getAuthStateUser"})),{},{nextCommentsCount:function(){return this.count-this.comments.length}}),created:function(){this.getComments()},methods:{canComment:function(){return this.milestoneDetail.assigned_to.id===this.getAuthStateUserId||this.milestoneDetail.created_by.id===this.getAuthStateUserId},getClickableLink:m["e"],humanizeDate:function(t){return this.$dayjs(t).fromNow()},getComments:function(){var t=this;this.loading=!0;var e=this.milestoneDetail.id;this.$http.get(r["a"].getMilestoneComments(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,e),{params:{limit:this.limit}}).then((function(e){t.count=e.count,t.loading=!1,t.comments=e.results}))},addComment:function(){var t=this,e=this.milestoneDetail.id,i=new FormData;i.append("comment",this.comment),i.append("milestone",e),this.$http.post(r["a"].postMilestoneComments(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,e),i).then((function(e){t.count+=1,t.comments.unshift(e),t.comment="",t.getComments()}))},deleteComment:function(){var t=this,e=this.milestoneDetail.id;this.$http.delete(r["a"].deleteMilestoneComments(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,e,this.comments[this.selectedCommentIndex].id)).then((function(){t.count-=1,t.notifyUser("Successfully deleted comment","green"),t.comments.splice(t.selectedCommentIndex,1),t.deleteNotification.dialog=!1,0===t.comments.length&&(t.limit=5,t.getComments())}))},viewProfileDetail:function(t){this.$router.push({name:"user-employee-directory-id-profile-detail",params:{id:t}})}}},h=u,p=i("2877"),v=i("6544"),f=i.n(v),g=i("8212"),_=i("b0af"),C=i("99d9"),x=i("62ad"),k=i("ce7e"),b=i("132d"),y=i("adda"),D=i("8860"),w=i("da13"),A=i("8270"),S=i("5d23"),V=i("34c3"),I=i("e449"),M=i("0fd9b"),O=i("3129"),$=i("a844"),P=Object(p["a"])(h,a,n,!1,null,null,null);e["a"]=P.exports;f()(P,{VAvatar:g["a"],VCard:_["a"],VCardActions:C["a"],VCardText:C["c"],VCol:x["a"],VDivider:k["a"],VIcon:b["a"],VImg:y["a"],VList:D["a"],VListItem:w["a"],VListItemAvatar:A["a"],VListItemContent:S["a"],VListItemIcon:V["a"],VListItemSubtitle:S["b"],VListItemTitle:S["c"],VMenu:I["a"],VRow:M["a"],VSkeletonLoader:O["a"],VTextarea:$["a"]})},9725:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{attrs:{height:"100%"}},[i("vue-card-title",{attrs:{title:"Milestone Recent Activities",subtitle:"Recent Activities Information.",icon:"mdi-playlist-check"}}),i("v-divider"),i("v-card-text",{staticClass:"pa-0 scrollbar-sm"},[t.loading?i("div",t._l(3,(function(t){return i("v-skeleton-loader",{key:t,attrs:{type:"list-item-avatar-three-line"}})})),1):i("div",t._l(t.recentActivities,(function(e,a){return i("div",{key:a,class:a%2===0?"grey lighten-5":"white"},[i("div",{staticClass:"d-flex py-4 px-6"},[i("v-avatar",{staticClass:"mr-4",attrs:{size:35}},[i("v-img",{attrs:{src:e.created_by.profile_picture,contain:""}})],1),i("div",[i("div",[t._v(t._s(e.created_by.full_name))]),i("span",{staticClass:"accent--text"},[t._v(" "+t._s(e.milestone.title)+" ")]),t._v(" : "),i("label",[t._v(t._s(e.description))]),i("div",{domProps:{textContent:t._s("Just Now"!==t.humanizeTime(e.created_at)?t.humanizeTime(e.created_at)+" ago":t.humanizeTime(e.created_at))}})])],1),a<t.recentActivities.length-1?i("v-divider"):t._e()],1)})),0),i("infinite-loading-base",{attrs:{endpoint:t.endpoint},on:{setInfiniteResponse:t.setInfiniteResponse}})],1)],1)},n=[],s=(i("99af"),i("dd34")),o=i("cdd1"),l={components:{InfiniteLoadingBase:o["a"]},props:{params:{type:String,default:""},admin:{type:Boolean,default:!1},isNormalUser:{type:Boolean,default:!1}},data:function(){return{recentActivities:[],endpoint:"",loading:!0}},created:function(){this.endpoint=s["a"].getMilestoneRecentActivities(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,this.$route.params.milestoneId)},methods:{setInfiniteResponse:function(t){this.recentActivities=this.recentActivities.concat(t.results),this.loading=!1}}},r=l,c=i("2877"),d=i("6544"),m=i.n(d),u=i("8212"),h=i("b0af"),p=i("99d9"),v=i("ce7e"),f=i("adda"),g=i("3129"),_=Object(c["a"])(r,a,n,!1,null,null,null);e["a"]=_.exports;m()(_,{VAvatar:u["a"],VCard:h["a"],VCardText:p["c"],VDivider:v["a"],VImg:f["a"],VSkeletonLoader:g["a"]})},b38e:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"mb-3"},[i("v-card-title",{class:t.milestoneStatus(t.milestoneDetail.status-1).color,attrs:{"primary-title":""}},[i("div",{staticClass:"font-weight-medium"},[i("div",{staticClass:"white--text text-body-1",domProps:{textContent:t._s(t.milestoneStatus(t.milestoneDetail.status-1).text)}}),4!==t.milestoneDetail.status?i("div",{staticClass:"white--text text-caption"},[t._v(" Deadline "+t._s(t.humanizeDate(t.milestoneDetail.deadline))+" ")]):t._e()]),i("v-spacer"),t.canUpdateStatus&&!t.readOnly?i("v-menu",{attrs:{bottom:"",origin:"center center",transition:"scale-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-btn",t._g({attrs:{icon:"",color:"white",small:""}},a),[i("v-icon",[t._v("mdi-menu-down")])],1)]}}],null,!1,1409415438)},[i("v-list",t._l(t.updatableStatus,(function(e){return i("v-list-item",{key:e.text,on:{click:function(i){t.updateStatus.value=e,t.updateStatus.dialog=!0}}},[i("v-list-item-title",{domProps:{textContent:t._s(e.text)}})],1)})),1)],1):t._e()],1),i("v-divider"),t.nonFieldErrors?i("non-field-form-errors",{attrs:{"non-field-errors":t.nonFieldErrors}}):t._e(),i("v-card-text",{staticClass:"black--text"},[i("v-row",{attrs:{align:"center"}},[i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Assigned By")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("v-avatar",{staticClass:"mr-2",attrs:{size:20}},[i("v-img",{attrs:{src:t.milestoneDetail.created_by.profile_picture}})],1),i("span",{domProps:{textContent:t._s(t.milestoneDetail.created_by.full_name)}})],1),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Responsible Person")]),t.milestoneDetail.assigned_to.id!==t.getAuthStateUser.user.id||t.readOnly?t._e():i("v-tooltip",{attrs:{bottom:""}})],1),i("v-col",{attrs:{cols:"6"}},[i("div",{staticClass:"my-1"},[i("v-avatar",{staticClass:"mr-2",attrs:{size:20}},[i("v-img",{attrs:{src:t.milestoneDetail.assigned_to.profile_picture}})],1),i("span",{staticClass:"primary--text"},[t._v(" "+t._s(t._f("truncate")(t.milestoneDetail.assigned_to.full_name,12))+" ")])],1)]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Scheduled From:")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("span",[t._v(t._s(t.milestoneDetail.created_at?t.milestoneDetail.created_at.substring(0,10)+", "+t.milestoneDetail.created_at.substring(11,19):"N/A")+" ")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Deadline:")])]),t.updateDeadline.edit?t._e():i("v-col",{attrs:{md:"4",cols:"6"}},[i("div",[t._v(t._s(t._f("dayjs")(t.milestoneDetail.deadline,"YYYY-MM-DD")))]),i("div",[t._v(" "+t._s(t._f("dayjs")(t.milestoneDetail.deadline,"h:mm a"))+" ")])]),t.canEditDeadline()?i("v-col",{attrs:{md:"2"}},[i("v-icon",{attrs:{size:"13"},domProps:{textContent:t._s("mdi-pencil")},on:{click:function(e){t.updateDeadline.edit=!0,t.updateDeadline.value=t.milestoneDetail.deadline}}})],1):t._e(),t.updateDeadline.edit?i("div",[i("vue-date-time-picker",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"prepend-inner-icon":"mdi-phone-outline"},model:{value:t.updateDeadline.value,callback:function(e){t.$set(t.updateDeadline,"value",e)},expression:"updateDeadline.value"}},"vue-date-time-picker",t.veeValidate("deadline","New Deadline *"),!1)),i("v-row",[i("v-spacer"),i("v-btn",{attrs:{small:""},domProps:{textContent:t._s("Save")},on:{click:t.addNewDeadline}}),i("v-btn",{attrs:{small:"",outlined:""},domProps:{textContent:t._s("Cancel")},on:{click:function(e){t.updateDeadline.edit=!1,t.updateDeadline.value=""}}})],1)],1):t._e(),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Created At:")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("span",[t._v(t._s(t._f("dayjs")(t.milestoneDetail.created_at,"MMM DD YYYY, h:mm:ss a")))])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Started Working:")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("span",[t._v(t._s(t.milestoneDetail.start?t.milestoneDetail.start:"N/A"))])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Finished Working:")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("span",[t._v(t._s(t.milestoneDetail.end?t.milestoneDetail.end:"N/A"))])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Approved:")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[t.milestoneDetail.approved?i("span",[i("v-icon",[t._v(" mdi-check-all ")])],1):i("span",[t._v(" No ")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[i("div",{staticClass:"font-weight-medium"},[t._v("Description:")])]),i("v-col",{attrs:{md:"6",cols:"6"}},[t.milestoneDetail.description?i("span",{on:{click:function(e){t.readMore=!t.readMore}}},[i("div",{staticClass:"text-justify pointer",domProps:{innerHTML:t._s(t.readMore?t.$sanitize(t.milestoneDetail.description):t.$sanitize(t.milestoneDetail.description).slice(0,100)+"......")}})]):i("span",[t._v("-")])])],1)],1),i("vue-dialog",{attrs:{notify:t.updateStatus},on:{close:function(e){t.updateStatus.dialog=!1},agree:function(e){return t.updateMilestoneStatus(t.updateStatus.value.id)}}})],1)},n=[],s=i("1da1"),o=i("5530"),l=(i("96cf"),i("caad"),i("99af"),i("7db0"),i("4de4"),i("a4d3"),i("e01a"),i("ea98")),r=i("d567"),c=i("c44a"),d=i("dd34"),m=i("2f62"),u=i("ab8a"),h={components:{NonFieldFormErrors:u["default"],VueDateTimePicker:r["a"],VueDialog:l["a"]},mixins:[c["a"]],props:{milestoneDetail:{type:Object,required:!0},readOnly:{type:Boolean,default:!0}},data:function(){return{showAllObservers:!1,updateDeadline:{value:!1,edit:!1},priorityColorMap:{UNDEFINED:"grey",MINOR:"green",MAJOR:"purple",CRITICAL:"red"},updateStatus:{value:"",dialog:!1,heading:"Confirm Update",subheading:"You are about to update the status of this milestone.",text:"Are you sure you want to update the status of this milestone?"},readMore:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(m["c"])({getAuthStateUser:"auth/getAuthStateUser"})),{},{isCreator:function(){return this.milestoneDetail.created_by.id===this.getAuthStateUser.user.id},isFutureObjective:function(){return new Date(this.milestoneDetail.starts_at)>new Date},isResponsible:function(){return this.milestoneDetail.assigned_to.id===this.getAuthStateUser.user.id},canUpdateStatus:function(){return(this.isCreator||this.isResponsible&&![3,5].includes(this.milestoneDetail.status))&&!this.milestoneDetail.approved},updatableStatus:function(){var t=this,e=[];if(this.isFutureObjective&&this.isCreator||(e=[{text:"Pending",color:"orange",id:1},{text:"In Progress",color:"blue",id:2},{text:"Completed",color:"green",id:4}]),this.isCreator&&(e=e.concat([{text:"On Hold",color:"pink",id:3},{text:"Closed",color:"green",id:5}]),[3,5].includes(this.milestoneDetail.status)))return[{text:"Pending",color:"orange",id:1}];var i=this.get(e.find((function(e){return e.id===t.milestoneDetail.status})),"text");return e.filter((function(t){return t.text!==i}))}}),methods:Object(o["a"])(Object(o["a"])({},Object(m["d"])({setSnackBar:"common/setSnackBar"})),{},{milestoneDescription:function(){return this.$sanitize(this.milestoneDetail.description)},canEditDeadline:function(){return!this.updateDeadline.edit&&this.canUpdateStatus&&this.milestoneDetail.changeable_deadline&&!this.readOnly&&this.milestoneDetail.created_by.id===this.getAuthStateUser.user.id&&!this.milestoneDetail.approved},milestoneStatus:function(t){var e=[{text:"Pending",color:"orange"},{text:"In Progress",color:"blue"},{text:"On Hold",color:"pink"},{text:"Completed",color:"green"},{text:"Closed",color:"purple"}];return e[t]},updateMilestoneStatus:function(t){var e=this,i={status:t},a=["Pending","In Progress","On Hold","Completed","Closed"];this.$http.patch(d["a"].updateMilestone(this.getOrganizationSlug,this.$route.params.id,this.$route.params.goalId,this.milestoneDetail.id),i).then((function(){e.setSnackBar({text:"Successfully moved milestone to "+a[t-1]+".",color:"green"}),e.$emit("refresh")})).catch((function(t){if(e.pushErrors(t),e.nonFieldErrors.length){var i=e.nonFieldErrors[0]["non field errors"]||e.nonFieldErrors[0].status||e.nonFieldErrors[0].detail||"You cannot perform this operation";e.setSnackBar({text:i,color:"red"})}e.notifyInvalidFormResponse(t.response.status[0]||t.response.data.status[0]),e.updateStatus.dialog=!1}))},addNewDeadline:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.validateAllFields();case 2:if(!e.sent){e.next=5;break}i={deadline:t.updateDeadline.value},t.$http.patch(d["a"].updateMilestone(t.getOrganizationSlug,t.$route.params.id,t.$route.params.goalId,t.milestoneDetail.id)+"?as=hr",i).then((function(e){t.setSnackBar({text:"Successfully updated deadline",color:"green"}),t.milestoneDetail.deadline=e.deadline,t.updateDeadline.edit=!1})).catch((function(e){t.pushErrors(e)}));case 5:case"end":return e.stop()}}),e)})))()}})},p=h,v=i("2877"),f=i("6544"),g=i.n(f),_=i("8212"),C=i("8336"),x=i("b0af"),k=i("99d9"),b=i("62ad"),y=i("ce7e"),D=i("132d"),w=i("adda"),A=i("8860"),S=i("da13"),V=i("5d23"),I=i("e449"),M=i("0fd9b"),O=i("2fa4"),$=i("3a2f"),P=Object(v["a"])(p,a,n,!1,null,null,null);e["a"]=P.exports;g()(P,{VAvatar:_["a"],VBtn:C["a"],VCard:x["a"],VCardText:k["c"],VCardTitle:k["d"],VCol:b["a"],VDivider:y["a"],VIcon:D["a"],VImg:w["a"],VList:A["a"],VListItem:S["a"],VListItemTitle:V["c"],VMenu:I["a"],VRow:M["a"],VSpacer:O["a"],VTooltip:$["a"]})},c197:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.divClass},[i("v-img",{class:t.imgClass,attrs:{src:"/svg/three-dots.svg",height:t.height,contain:""}}),i("h3",{staticClass:"text-center grey--text",domProps:{textContent:t._s(t.message)}})],1)},n=[],s={props:{message:{type:String,default:"Please wait. Fetching data just for you ..."},divClass:{type:String,default:"pa-12"},imgClass:{type:String,default:"my-6"},height:{type:String,default:"20"}},data:function(){return{}}},o=s,l=i("2877"),r=i("6544"),c=i.n(r),d=i("adda"),m=Object(l["a"])(o,a,n,!1,null,null,null);e["default"]=m.exports;c()(m,{VImg:d["a"]})},e6e4:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"mb-3"},[i("vue-card-title",{attrs:{title:""+t.milestoneDetail.title,icon:"mdi-calendar-check-outline"}},[i("template",{slot:"actions"},[t.canEditMilestone?i("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-btn",t._g({attrs:{icon:""},on:{click:function(e){t.actionData=t.milestoneDetail,t.updateMilestoneForm=!0}}},a),[i("v-icon",{attrs:{small:""},domProps:{textContent:t._s("mdi-pencil")}})],1)]}}],null,!1,2348636602)},[i("span",{domProps:{textContent:t._s("Update Milestone")}})]):t._e()],1)],2),i("v-divider"),i("v-dialog",{attrs:{transition:"dialog-bottom-transition",fullscreen:"",scrollable:"",persistent:""},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.updateMilestoneForm=!1}},model:{value:t.updateMilestoneForm,callback:function(e){t.updateMilestoneForm=e},expression:"updateMilestoneForm"}},[i("v-card",[i("vue-card-title",{attrs:{title:"Update Milestone",subtitle:"Here you can update milestone ",icon:"mdi-file-document-outline",dark:"",closable:""},on:{close:function(e){t.updateMilestoneForm=!1,t.$emit("refresh")}}}),i("v-divider"),i("v-card-text",[t.updateMilestoneForm?i("MilestoneForm",{attrs:{"form-bottom-sheet":t.updateMilestoneForm,"parent-task":t.milestoneDetail.parent,"action-data":t.actionData},on:{"dismiss-form":function(e){t.updateMilestoneForm=!1,t.$emit("refresh")}}}):t._e()],1)],1)],1)],1)},n=[],s=i("5530"),o=(i("a9e3"),i("ab89")),l=i("2f62"),r={components:{MilestoneForm:o["a"]},props:{milestoneDetail:{type:Object,required:!0},objectiveCurrentStatus:{type:Number,default:0},readOnly:{type:Boolean,default:!0},isHradmin:{type:Boolean,default:!1}},data:function(){return{updateMilestoneForm:!1,actionData:void 0,configs:{toolbar:!1,spellChecker:!1}}},computed:Object(s["a"])(Object(s["a"])({},Object(l["c"])({getAuthStateUser:"auth/getAuthStateUser"})),{},{canEditMilestone:function(){return!this.readOnly&&this.isHradmin&&this.milestoneDetail.created_by.id===this.getAuthStateUser.user.id&&!this.milestoneDetail.approved}})},c=r,d=i("2877"),m=i("6544"),u=i.n(m),h=i("8336"),p=i("b0af"),v=i("99d9"),f=i("169a"),g=i("ce7e"),_=i("132d"),C=i("3a2f"),x=Object(d["a"])(c,a,n,!1,null,null,null);e["a"]=x.exports;u()(x,{VBtn:h["a"],VCard:p["a"],VCardText:v["c"],VDialog:f["a"],VDivider:g["a"],VIcon:_["a"],VTooltip:C["a"]})}}]);