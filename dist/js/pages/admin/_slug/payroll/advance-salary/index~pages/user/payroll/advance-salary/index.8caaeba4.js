(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/admin/_slug/payroll/advance-salary/index~pages/user/payroll/advance-salary/index"],{"1e6c":function(t,e,a){"use strict";var s=a("9d65"),i=a("4e82"),n=a("c3f0"),r=a("80d2"),o=a("58df"),u=Object(o["a"])(s["a"],Object(i["a"])("windowGroup","v-window-item","v-window"));e["a"]=u.extend().extend().extend({name:"v-window-item",directives:{Touch:n["a"]},props:{disabled:Boolean,reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},value:{required:!1}},data:function(){return{isActive:!1,inTransition:!1}},computed:{classes:function(){return this.groupClasses},computedTransition:function(){return this.windowGroup.internalReverse?"undefined"!==typeof this.reverseTransition?this.reverseTransition||"":this.windowGroup.computedTransition:"undefined"!==typeof this.transition?this.transition||"":this.windowGroup.computedTransition}},methods:{genDefaultSlot:function(){return this.$slots.default},genWindowItem:function(){return this.$createElement("div",{staticClass:"v-window-item",class:this.classes,directives:[{name:"show",value:this.isActive}],on:this.$listeners},this.genDefaultSlot())},onAfterTransition:function(){this.inTransition&&(this.inTransition=!1,this.windowGroup.transitionCount>0&&(this.windowGroup.transitionCount--,0===this.windowGroup.transitionCount&&(this.windowGroup.transitionHeight=void 0)))},onBeforeTransition:function(){this.inTransition||(this.inTransition=!0,0===this.windowGroup.transitionCount&&(this.windowGroup.transitionHeight=Object(r["g"])(this.windowGroup.$el.clientHeight)),this.windowGroup.transitionCount++)},onTransitionCancelled:function(){this.onAfterTransition()},onEnter:function(t){var e=this;this.inTransition&&this.$nextTick((function(){e.computedTransition&&e.inTransition&&(e.windowGroup.transitionHeight=Object(r["g"])(t.clientHeight))}))}},render:function(t){var e=this;return t("transition",{props:{name:this.computedTransition},on:{beforeEnter:this.onBeforeTransition,afterEnter:this.onAfterTransition,enterCancelled:this.onTransitionCancelled,beforeLeave:this.onBeforeTransition,afterLeave:this.onAfterTransition,leaveCancelled:this.onTransitionCancelled,enter:this.onEnter}},this.showLazyContent((function(){return[e.genWindowItem()]})))}})},"27f7":function(t,e,a){"use strict";var s=a("b85c"),i=a("5530"),n=a("1da1"),r=(a("96cf"),a("b64b"),a("d3b7"),a("ac1f"),a("841c"),a("3ca3"),a("ddb0"),a("2b3d"),a("8b61"));e["a"]={mixins:[r["a"]],data:function(){return{fetchedResults:[],response:{},extra_data:"",appliedFilters:{},footerProps:{itemsPerPageOptions:[10,20,30,40,50,100]},pagination:{sortBy:["modified_at"],descending:!1,totalItems:0,page:1,rowsPerPage:10,pageCount:0},triggerDataTable:!0,fullParams:"",dataTableFetch:void 0,proceedApi:!0}},computed:{responseNotEmpty:function(){return this.response&&Object.keys(this.response).length>0&&this.response.constructor===Object}},created:function(){this.dataTableFetch?this.loadDataTableChange():this.getParams(this.DataTableFilter)},methods:{fetchDataTable:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.loading&&t.proceedApi){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.next=5,t.$http.get(t.crud.endpoint.common||t.crud.endpoint.get,{params:t.fullParams}).then((function(e){t.loadDataTable(e),t.processAfterTableLoad(e)})).catch((function(e){t.pushErrors(e),t.notifyInvalidFormResponse()})).finally((function(){t.loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},processAfterTableLoad:function(){},getParams:function(t){var e=Object(i["a"])(Object(i["a"])({},t),{},{offset:(this.pagination.page-1)*this.pagination.rowsPerPage,limit:this.pagination.rowsPerPage,ordering:this.pagination.descending?this.pagination.sortBy:"-"+this.pagination.sortBy});this.fullParams=this.convertToURLSearchParams(e)},loadDataTable:function(t){this.response=t,this.fetchedResults=t.results,this.pagination.totalItems=t.count,this.extra_data=t.extra_data,this.triggerDataTable=!0},fetchData:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.warn("DatatableMixin: fetchData has been deprecated. Please use the function in page itself."),s=Object(i["a"])(Object(i["a"])(Object(i["a"])({},t),e.appliedFilters),{},{search:e.search,offset:(e.pagination.page-1)*e.pagination.rowsPerPage,limit:e.pagination.rowsPerPage,ordering:e.pagination.descending?e.pagination.sortBy:"-"+e.pagination.sortBy}),n=e.convertToURLSearchParams(s),e.loading=!0,a.next=6,e.$http.get(e.endpoint,{params:n}).then((function(t){e.response=t,e.fetchedResults=t.results,e.pagination.totalItems=t.count})).finally((function(){e.loading=!1}));case 6:case"end":return a.stop()}}),a)})))()},applyFilters:function(t){this.appliedFilters=t,this.fetchData(t)},convertToURLSearchParams:function(t){for(var e=new URLSearchParams,a=0,i=Object.keys(t);a<i.length;a++){var n=i[a],r=t[n];if(void 0===r&&(r=""),Array.isArray(r)){var o,u=Object(s["a"])(r);try{for(u.s();!(o=u.n()).done;){var l=o.value;e.append(n,l)}}catch(c){u.e(c)}finally{u.f()}}else e.append(n,r)}return e},loadDataTableChange:function(){var t=this;this.triggerDataTable&&(this.getParams(this.DataTableFilter),this.$nextTick((function(){t.fetchDataTable()})))}},watch:{DataTableFilter:function(t){this.fetchedResults=[],this.getParams(t),this.fetchDataTable(),this.pagination.page=1},"pagination.sortBy":function(){this.fetchedResults=[],this.loadDataTableChange()},"pagination.descending":function(){this.fetchedResults=[],this.loadDataTableChange()},"pagination.page":function(){this.fetchedResults=[],this.loadDataTableChange()},"pagination.rowsPerPage":function(){this.fetchedResults=[],this.loadDataTableChange()}}}},"96d7":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[a("vue-card-title",{attrs:{title:t.heading.title,subtitle:t.heading.subheading,icon:"mdi-cash"}},[a("template",{slot:"actions"},["hr"===t.as?a("v-btn",{attrs:{icon:""},on:{click:function(e){t.showFilters=!t.showFilters}}},[a("v-icon",{attrs:{small:""},domProps:{textContent:t._s("mdi-filter-variant")}})],1):t._e()],1)],2),a("v-divider"),a("v-slide-y-transition",[a("v-row",{directives:[{name:"show",rawName:"v-show",value:t.showFilters,expression:"showFilters"}],staticClass:"px-1",attrs:{align:"center"}},[a("v-col",[t.showFilters?a("div",{staticClass:"mx-5"},[a("vue-search",{attrs:{search:t.search},on:{"update:search":function(e){t.search=e}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1):t._e()])],1)],1),t.showFilters?a("v-divider"):t._e(),a("v-tabs",{attrs:{"show-arrows":"","slider-color":"blue"},model:{value:t.searchFilters.activeStatus,callback:function(e){t.$set(t.searchFilters,"activeStatus",e)},expression:"searchFilters.activeStatus"}},t._l(t.tabs,(function(e){return a("v-tab",{key:e.tabName,attrs:{ripple:"",disabled:t.loading}},[a("span",{staticClass:"pr-2 text-capitalize"},[t._v(" "+t._s(e.tabName)+" ")]),a("v-chip",{staticClass:"white--text",attrs:{color:e.color,small:""}},[t._v(" "+t._s(e.count)+" ")])],1)})),1),a("v-divider"),a("v-data-table",{attrs:{headers:t.headers,items:t.fetchedResults,"sort-desc":t.pagination.descending,"sort-by":t.pagination.sortBy,page:t.pagination.page,"items-per-page":t.pagination.rowsPerPage,"footer-props":t.footerProps,"server-items-length":t.pagination.totalItems,"mobile-breakpoint":0,"must-sort":""},on:{"update:sortDesc":function(e){return t.$set(t.pagination,"descending",e)},"update:sort-desc":function(e){return t.$set(t.pagination,"descending",e)},"update:sortBy":function(e){return t.$set(t.pagination,"sortBy",e)},"update:sort-by":function(e){return t.$set(t.pagination,"sortBy",e)},"update:page":function(e){return t.$set(t.pagination,"page",e)},"update:itemsPerPage":function(e){return t.$set(t.pagination,"rowsPerPage",e)},"update:items-per-page":function(e){return t.$set(t.pagination,"rowsPerPage",e)}},scopedSlots:t._u([{key:"item",fn:function(e){return[a("tr",["hr"===t.as?a("td",{staticStyle:{width:"15%"}},[a("vue-user",{attrs:{user:e.item.employee}})],1):t._e(),a("td",{staticClass:"text-right",staticStyle:{width:"14%"}},[a("div",{domProps:{textContent:t._s(e.item.amount.toLocaleString())}})]),a("td",{staticClass:"text-center",domProps:{textContent:t._s(e.item.requested_for?t.humanizeDate(e.item.requested_for):"N/A")}}),a("td",{staticClass:"text-right",domProps:{textContent:t._s(e.item.limit_amount?e.item.limit_amount.toLocaleString():e.item.limit_amount)}}),a("td",{staticClass:"text-center"},[a("div",[a("v-chip",{attrs:{color:t.statusColor[e.item.status],small:"",outlined:""},domProps:{textContent:t._s(e.item.status)}})],1)]),a("td",{staticClass:"text-center"},[a("vue-context-menu",{attrs:{"context-list":[{name:"View  Request",icon:"mdi-eye-outline",color:"blue"},{name:"Send Advance Request",icon:"mdi-file-send",color:"blue",hide:!(!e.item.advance_salary_request&&"Approved"===e.item.status&&"hr"!==t.as)}]},on:{click0:function(a){t.surplusId=e.item.id,t.showSurplusRequest=!0},click1:function(a){return t.$emit("open-surplus-request",e.item)}}})],1)])]}}])},[a("template",{slot:"no-data"},[a("data-table-no-data",{attrs:{loading:t.loading}})],1)],2),t.showSurplusRequest?a("v-bottom-sheet",{attrs:{persistent:"",scrollable:""},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.showSurplusRequest=!1}},model:{value:t.showSurplusRequest,callback:function(e){t.showSurplusRequest=e},expression:"showSurplusRequest"}},[a("surplus-detail",{attrs:{"surplus-id":t.surplusId,role:t.as},on:{close:function(e){t.showSurplusRequest=!1,t.fetchDataTable()}}})],1):t._e()],1)],1)},i=[],n=a("5530"),r=(a("ac1f"),a("841c"),a("02cb")),o=a("a51f"),u=a("e4bf"),l=a("2f62"),c=a("258f"),d=a("27f7"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("vue-card-title",{attrs:{title:"View Details of Advance Salary Surplus request",subtitle:"Here you can view details of advance salary surplus request.",icon:"mdi-eye",dark:"",closable:""},on:{close:function(e){return t.$emit("close")}}}),a("v-card-text",[a("v-row",[a("v-col",[a("div",[a("v-icon",{domProps:{textContent:t._s("mdi-account-check")}}),t._v(" Employee Name ")],1),a("vue-user",{staticClass:"mx-7",attrs:{user:t.surplusDetails.employee}})],1),a("v-col",[a("div",[a("v-icon",{attrs:{size:"20"},domProps:{textContent:t._s("mdi-calendar")}}),t._v(" Requested Date: ")],1),a("div",{staticClass:"mx-7"},[a("div",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.humanizeDate(t.surplusDetails.created_at))+" ")]),a("div",[t._v(" "+t._s(t.getTime(t.surplusDetails.created_at))+" ")])])]),a("v-col",[a("div",[a("v-icon",{domProps:{textContent:t._s("mdi-cash-multiple")}}),t._v(" Amount Limit: ")],1),a("div",{staticClass:"mx-7 font-weight-bold"},[t._v(" "+t._s(t.surplusDetails.limit_amount?t.surplusDetails.limit_amount.toLocaleString():t.surplusDetails.limit_amount)+" ")])]),a("v-col",[a("div",[a("v-icon",{domProps:{textContent:t._s("mdi-cash-multiple")}}),t._v(" Amount Requested: ")],1),a("div",{staticClass:"mx-7 red--text"},[t._v(" NRs. "+t._s(t.surplusDetails.amount?t.surplusDetails.amount.toLocaleString():t.surplusDetails.amount)+" ")])]),a("v-col",{attrs:{cols:"12"}},[a("div",[a("v-icon",{attrs:{size:"20"},domProps:{textContent:t._s("mdi-file-document-outline")}}),t._v(" Remarks For Request ")],1),a("div",{staticClass:"mx-7 font-weight-bold"},[t._v(" "+t._s(t.surplusDetails.reason_for_request)+" ")])]),"Requested"!==t.surplusDetails.status?a("v-col",{attrs:{cols:"12"}},[a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("div",[a("v-icon",{domProps:{textContent:t._s("mdi-account-check")}}),t._v(" "+t._s(t.surplusDetails.status)+" By ")],1),a("vue-user",{staticClass:"mx-7",attrs:{user:t.surplusDetails.acted_by}})],1),a("v-col",[a("div",[a("v-icon",{attrs:{size:"20"},domProps:{textContent:t._s("mdi-calendar")}}),t._v(" "+t._s(t.surplusDetails.status)+" Date: ")],1),a("div",{staticClass:"mx-7"},[a("div",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.humanizeDate(t.surplusDetails.acted_on))+" ")]),a("div",[t._v(" "+t._s(t.getTime(t.surplusDetails.acted_on))+" ")])])]),a("v-col",{attrs:{cols:"12"}},[a("div",[a("v-icon",{attrs:{size:"20"},domProps:{textContent:t._s("mdi-file-document-outline")}}),t._v(" Action Remarks ")],1),a("div",{staticClass:"mx-7 font-weight-bold"},[t._v(" "+t._s(t.surplusDetails.action_remarks)+" ")])])],1)],1):t._e(),"Requested"===t.surplusDetails.status&&"hr"===t.role?a("v-col",{attrs:{cols:"12"}},[a("v-textarea",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],attrs:{"prepend-inner-icon":"mdi-alpha-i-circle"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}},"v-textarea",t.veeValidate("remarks","Remarks For Approval/Decline *"),!1))],1):t._e()],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"black",text:""},on:{click:function(e){return t.$emit("close")}}},[t._v(" Cancel ")]),"Requested"===t.surplusDetails.status&&"hr"===t.role?a("v-btn",{staticClass:"white--text",attrs:{color:"red",depressed:""},on:{click:function(e){return t.requestAction("deny")}}},[t._v(" Declined Request ")]):t._e(),"Requested"===t.surplusDetails.status&&"hr"===t.role?a("v-btn",{staticClass:"white--text",attrs:{color:"success",depressed:""},on:{click:function(e){return t.requestAction("approve")}}},[t._v(" Approve Request ")]):t._e()],1)],1)},h=[],m=(a("a9e3"),a("c44a")),v={components:{VueUser:r["default"]},mixins:[m["a"]],props:{surplusId:{type:[String,Number],required:!0},role:{type:String,required:!0}},data:function(){return{remarks:"",surplusDetails:{}}},created:function(){this.fetchSurplusDetails()},methods:{fetchSurplusDetails:function(){var t=this;this.$http.get(c["a"].surplusRequest(this.getOrganizationSlug,this.surplusId)+"?as=".concat("hr"===this.role?"hr":"")).then((function(e){t.surplusDetails=e}))},humanizeDate:function(t){return this.$dayjs(t).format("YYYY-MM-DD")},getTime:function(t){return this.$dayjs(t).format("HH:mm:ss a")},requestAction:function(t){var e=this;this.$http.post(c["a"].surplusRequestAction(this.getOrganizationSlug,this.surplusId,t)+"?as=hr",{remarks:this.remarks}).then((function(){e.notifyUser("Successfully ".concat("deny"===t?"Declined":"Approved"," Surplus Request. ")),e.$emit("close")})).catch((function(t){e.pushErrors(t)}))}}},f=v,g=a("2877"),b=a("6544"),w=a.n(b),_=a("8336"),x=a("b0af"),D=a("99d9"),y=a("62ad"),C=a("ce7e"),T=a("132d"),R=a("0fd9b"),P=a("2fa4"),S=a("a844"),q=Object(g["a"])(f,p,h,!1,null,null,null),k=q.exports;w()(q,{VBtn:_["a"],VCard:x["a"],VCardActions:D["a"],VCardText:D["c"],VCol:y["a"],VDivider:C["a"],VIcon:T["a"],VRow:R["a"],VSpacer:P["a"],VTextarea:S["a"]});var A={components:{VueContextMenu:u["default"],DataTableNoData:o["default"],VueUser:r["default"],SurplusDetail:k},mixins:[d["a"]],props:{heading:{type:Object,default:function(){return{}}},as:{type:String,default:""}},data:function(){return{htmlTitle:"Advance Salary | Payroll | Admin",breadCrumbItems:[{text:"Payroll",disabled:!1,to:{name:"admin-slug-payroll-overview",params:{slug:this.$route.params.slug}}},{text:"Advance Salary",disabled:!0}],hover:!0,loading:!1,headers:[{text:"Employee Name",value:"full_name",align:"left",width:"20%",sortable:!0},{text:"Requested Amount",value:"amount",width:"20%",align:"right",sortable:!0},{text:"Requested Date",value:"created_at",width:"20%",align:"center",sortable:!0},{text:"Amount Limit",align:"right",value:"status",sortable:!1},{text:"Status",align:"center",value:"status",sortable:!1},{text:"Action",align:"center",sortable:!1}],dataTableFetch:!0,tabs:[{tabName:"Requested",value:"Requested",count:"0",color:"orange"},{tabName:"Approved",value:"Approved",count:"0",color:"teal"},{tabName:"Denied",value:"Denied",count:"0",color:"red"},{tabName:"All",value:"",count:"0",color:"blue"}],search:"",statusColor:{Requested:"orange",Approved:"green",Denied:"red"},surplusId:"",showSurplusRequest:!1,searchFilters:{activeStatus:0},showFilters:!1}},computed:Object(n["a"])(Object(n["a"])({},Object(l["c"])({getSupervisorOrgSlug:"supervisor/getOrganizationSlug"})),{},{DataTableFilter:function(){return{search:this.search,status:this.tabs[this.searchFilters.activeStatus].value,as:this.as||""}}}),created:function(){this.crud.endpoint.common=c["a"].surplusRequests(this.getOrganizationSlug),"hr"!==this.as&&this.headers.shift()},methods:{humanizeDate:function(t){return this.$dayjs(t).format("YYYY-MM-DD")},processAfterTableLoad:function(t){this.updateCounts(t.counts||t.stats)},updateCounts:function(t){this.tabs[0].count=t["Requested"],this.tabs[1].count=t["Approved"],this.tabs[2].count=t["Denied"],this.tabs[3].count=t["All"]},refreshData:function(){this.fetchDataTable(),this.showRequestDetails=!1}}},O=A,V=a("288c"),$=a("cc20"),F=a("8fea"),j=a("0789"),B=a("71a3"),I=a("fe57"),L=Object(g["a"])(O,s,i,!1,null,null,null);e["a"]=L.exports;w()(L,{VBottomSheet:V["a"],VBtn:_["a"],VCard:x["a"],VChip:$["a"],VCol:y["a"],VDataTable:F["a"],VDivider:C["a"],VIcon:T["a"],VRow:R["a"],VSlideYTransition:j["g"],VTab:B["a"],VTabs:I["a"]})},c671:function(t,e,a){"use strict";var s=a("1e6c");e["a"]=s["a"].extend({name:"v-tab-item",props:{id:String},methods:{genWindowItem:function(){var t=s["a"].options.methods.genWindowItem.call(this);return t.data.domProps=t.data.domProps||{},t.data.domProps.id=this.id||this.value,t}}})}}]);