(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/user/leave/request"],{"0227":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vue-page-wrapper",{attrs:{title:e.htmlTitle,"bread-crumbs":e.breadCrumbItems}},[a("v-card",[a("vue-card-title",{attrs:{title:"Request Leave",subtitle:"Request for Leave Here.",icon:"mdi-send-outline"}},[a("template",{slot:"actions"},[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{icon:""},on:{click:function(t){e.moreLeaveTypes=!e.moreLeaveTypes}}},n),[a("v-icon",{attrs:{small:""},domProps:{textContent:e._s("mdi-swap-horizontal")}})],1)]}}])},[a("span",{domProps:{textContent:e._s("Display More Leave Types")}})])],1)],2),a("v-divider"),a("v-data-table",{attrs:{headers:e.balanceHeaders,items:e.fetchedResults,"sort-desc":e.pagination.descending,"sort-by":e.pagination.sortBy,page:e.pagination.page,"items-per-page":e.pagination.rowsPerPage,"footer-props":e.footerProps,"server-items-length":e.pagination.totalItems,"must-sort":"","item-key":"name","mobile-breakpoint":0},on:{"update:sortDesc":function(t){return e.$set(e.pagination,"descending",t)},"update:sort-desc":function(t){return e.$set(e.pagination,"descending",t)},"update:sortBy":function(t){return e.$set(e.pagination,"sortBy",t)},"update:sort-by":function(t){return e.$set(e.pagination,"sortBy",t)},"update:page":function(t){return e.$set(e.pagination,"page",t)},"update:itemsPerPage":function(t){return e.$set(e.pagination,"rowsPerPage",t)},"update:items-per-page":function(t){return e.$set(e.pagination,"rowsPerPage",t)}},scopedSlots:e._u([{key:"item",fn:function(t){return[a("tr",[a("td",[e._v(" "+e._s(t.item.leave_type.name)+" ")]),t.item.rule.can_apply_beyond_zero_balance&&t.item.usable_balance<=0?a("td",{staticClass:"text-center"},[a("v-chip",{attrs:{label:""}},[e._v(" "+e._s(t.item.rule.beyond_limit+t.item.usable_balance)+" Credit left ")])],1):a("td",[["Time Off","Credit Hour"].includes(t.item.leave_type.category)?a("div",[a("span",{staticClass:"font-weight-bold text-body-1"},[e._v(" "+e._s(parseInt(t.item.usable_balance/60)+":"+parseInt(t.item.usable_balance%60))+" ")]),e._v(" Hours Left ")]):a("div",[a("span",{staticClass:"font-weight-bold text-body-1"},[e._v(" "+e._s(t.item.usable_balance)+" ")]),e._v(" Days Left ")])]),a("td",[t.item.rule.can_apply_beyond_zero_balance&&t.item.usable_balance<=0?a("div",[a("v-btn",{attrs:{disabled:0===t.item.beyond_limit,depressed:""},on:{click:function(a){return e.applyLeave(t.item)}}},[e._v(" "+e._s(0===t.item.beyond?"Limit Reached":"Apply")+" ")])],1):a("div",[a("v-btn",{attrs:{disabled:0===t.item.usable_balance,depressed:"",color:"primary"},on:{click:function(a){return e.applyLeave(t.item)}}},[e._v(" "+e._s(0===t.item.usable_balance?"Limit Reached":"Apply")+" ")])],1)]),a("td",[a("vue-context-menu",{attrs:{"context-list":[{name:"View History",icon:"mdi-eye-outline",color:"blue"}]},on:{click0:function(a){e.viewHistory(t.item.leave_type.name,t.item.id),e.history=!0}}})],1)])]}}])},[a("template",{slot:"no-data"},[a("data-table-no-data",{attrs:{loading:e.loading}})],1)],2)],1),a("v-bottom-sheet",{attrs:{persistent:"",scrollable:""},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.showForm=!1}},model:{value:e.showForm,callback:function(t){e.showForm=t},expression:"showForm"}},[a("v-card",[e.showForm?a("leave-request",{attrs:{request:e.applyRequest,"leave-types":e.leaveTypes,as:""},on:{"close-form":e.closeForm}}):e._e()],1)],1),a("v-bottom-sheet",{attrs:{persistent:"",scrollable:""},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.history=!1}},model:{value:e.history,callback:function(t){e.history=t},expression:"history"}},[e.history?a("balance-history",{attrs:{"user-id":e.getAuthStateUserId,"leave-type-id":e.leaveTypeId,name:e.leaveType,slug:e.getOrganizationSlug},on:{close:function(t){e.history=!1}}}):e._e()],1)],1)},s=[],i=(a("d81d"),a("b0c0"),a("0549")),o=a("a51f"),r=a("1f2a"),l=a("78a2"),c=a("227f"),d=a("e4bf"),u=a("8cd3"),p={components:{VueContextMenu:d["default"],VuePageWrapper:i["default"],DataTableNoData:o["default"],LeaveRequest:r["a"],BalanceHistory:l["a"]},mixins:[u["a"]],data:function(){return{htmlTitle:"Request | Leave | User",breadCrumbItems:[{text:"Leave",disabled:!1,to:{name:"user-leave-overview"}},{text:"Request",disabled:!0}],balanceHeaders:[{text:"Leave Type",sortable:!1},{text:"Balance",sortable:!1},{text:"Action",sortable:!1},{text:"History",sortable:!1}],rowsPerPageItems:[10,20,30,40,50],history:!1,dataTableFetch:!0,leaveType:"",loading:!1,showForm:!1,applyRequest:{},leaveTypeId:"",moreLeaveTypes:!0,leaveTypes:[]}},computed:{dataTableFilter:function(){return{visible:this.moreLeaveTypes}}},created:function(){this.dataTableEndpoint=c["a"].getRequestBalance(this.getOrganizationSlug,this.getAuthStateUserId)},methods:{processAfterTableLoad:function(){this.leaveTypes=this.fetchedResults.map((function(e){return{id:e.id,name:e.leave_type.name,leave_type_id:e.leave_type.id,require_docs:e.rule.require_docs}}))},applyLeave:function(e){this.showForm=!0,this.applyRequest=e},closeForm:function(){this.showForm=!1,this.fetchDataTable()},viewHistory:function(e,t){this.leaveTypeId=t,this.leaveType=e,this.history=!0}}},m=p,b=a("2877"),f=a("6544"),y=a.n(f),v=a("288c"),h=a("8336"),g=a("b0af"),_=a("cc20"),T=a("8fea"),w=a("ce7e"),P=a("132d"),k=a("3a2f"),x=Object(b["a"])(m,n,s,!1,null,null,null);t["default"]=x.exports;y()(x,{VBottomSheet:v["a"],VBtn:h["a"],VCard:g["a"],VChip:_["a"],VDataTable:T["a"],VDivider:w["a"],VIcon:P["a"],VTooltip:k["a"]})},"8cd3":function(e,t,a){"use strict";var n=a("5530"),s=(a("d3b7"),a("f0d5"));t["a"]={mixins:[s["a"]],data:function(){return{dataTableEndpoint:"",fetchedResults:[],response:null,footerProps:{itemsPerPageOptions:[10,20,30,40,50,100]},pagination:{sortBy:["modified_at"],descending:!1,totalItems:0,page:1,rowsPerPage:10,pageCount:0},loadTableOnInit:!0}},computed:{filterParams:function(){var e=Object(n["a"])(Object(n["a"])({},this.dataTableFilter),{},{offset:(this.pagination.page-1)*this.pagination.rowsPerPage,limit:this.pagination.rowsPerPage,ordering:this.pagination.descending?this.pagination.sortBy:"-"+this.pagination.sortBy});return this.convertToURLSearchParams(e,!1)}},watch:{filterParams:function(){var e=this;this.$nextTick((function(){e.fetchDataTable()}))},dataTableFilter:function(){this.pagination.page=1}},created:function(){var e=this;setTimeout((function(){e.loadTableOnInit&&e.fetchDataTable()}),0)},methods:{fetchDataTable:function(e,t){var a=this;return new Promise((function(n,s){!e&&!a.dataTableEndpoint||a.loading||(a.loadTableOnInit=!1,a.loading=!0,a.fetchedResults=[],a.$http.get(e||a.dataTableEndpoint,t||{params:a.filterParams}).then((function(e){a.response=e,a.fetchedResults=e.results,a.pagination.totalItems=e.count,a.processAfterTableLoad(e),n(e),a.loading=!1})).catch((function(e){a.pushErrors(e),a.notifyInvalidFormResponse(),s(e),a.loading=!1})))}))},processAfterTableLoad:function(){}}}}}]);