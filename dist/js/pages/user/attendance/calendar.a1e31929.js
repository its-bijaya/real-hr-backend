(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/user/attendance/calendar"],{3860:function(e,t,a){"use strict";var s=a("604c");t["a"]=s["a"].extend({name:"button-group",provide:function(){return{btnToggle:this}},computed:{classes:function(){return s["a"].options.computed.classes.call(this)}},methods:{genData:s["a"].options.methods.genData}})},"7e58":function(e,t,a){},a609:function(e,t,a){"use strict";var s=a("5530"),n=(a("7e58"),a("3860")),r=a("a9ad"),i=a("58df");t["a"]=Object(i["a"])(n["a"],r["a"]).extend({name:"v-btn-toggle",props:{backgroundColor:String,borderless:Boolean,dense:Boolean,group:Boolean,rounded:Boolean,shaped:Boolean,tile:Boolean},computed:{classes:function(){return Object(s["a"])(Object(s["a"])({},n["a"].options.computed.classes.call(this)),{},{"v-btn-toggle":!0,"v-btn-toggle--borderless":this.borderless,"v-btn-toggle--dense":this.dense,"v-btn-toggle--group":this.group,"v-btn-toggle--rounded":this.rounded,"v-btn-toggle--shaped":this.shaped,"v-btn-toggle--tile":this.tile},this.themeClasses)}},methods:{genData:function(){var e=this.setTextColor(this.color,Object(s["a"])({},n["a"].options.methods.genData.call(this)));return this.group?e:this.setBackgroundColor(this.backgroundColor,e)}}})},d774:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vue-page-wrapper",{attrs:{title:e.htmlTitle,"bread-crumbs":e.breadCrumbItems}},[a("attendance-calendar",{attrs:{params:e.queryParams,"trigger-reload":e.refreshCalendar,"user-view":"Normal"},on:{adjustAttendance:e.adjustAttendance,requestLeave:e.requestLeave}}),a("v-bottom-sheet",{attrs:{persistent:""},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.adjustmentRequest.dialog=!1}},model:{value:e.adjustmentRequest.dialog,callback:function(t){e.$set(e.adjustmentRequest,"dialog",t)},expression:"adjustmentRequest.dialog"}},[a("v-card",[e.adjustmentRequest.dialog?a("adjustment-request-form",{attrs:{"list-of-attendance":[e.adjustmentRequest.data]},on:{close:function(t){e.adjustmentRequest.dialog=!1},create:function(t){e.adjustmentRequest.dialog=!1},"reload-form":function(t){e.adjustmentRequest.dialog=!1,e.refreshCalendar=!e.refreshCalendar}}}):e._e()],1)],1),a("v-bottom-sheet",{attrs:{persistent:""},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.leaveRequest.dialog=!1}},model:{value:e.leaveRequest.dialog,callback:function(t){e.$set(e.leaveRequest,"dialog",t)},expression:"leaveRequest.dialog"}},[a("v-card",[e.leaveRequest.dialog?a("leave-request",{attrs:{"time-sheet-for":e.leaveRequest.data.timesheet_for,"applied-from-calendar":"",as:""},on:{"close-form":function(t){e.leaveRequest.dialog=!1},create:function(t){e.leaveRequest.dialog=!1},"reload-form":function(t){e.refreshCalendar=!e.refreshCalendar}}}):e._e()],1)],1)],1)},n=[],r=a("0549"),i=a("f62a"),o=a("7cf6"),d=a("1f2a"),c={components:{AdjustmentRequestForm:i["a"],VuePageWrapper:r["default"],AttendanceCalendar:o["a"],LeaveRequest:d["a"]},data:function(){return{htmlTitle:"Calendar | Attendance | User",breadCrumbItems:[{text:"Attendance",disabled:!1,to:{name:"user-attendance-overview"}},{text:"Calendar",disabled:!0}],adjustmentRequest:{dialog:!1,data:""},leaveRequest:{dialog:!1,data:""},queryParams:this.$route.query,refreshCalendar:!1}},methods:{adjustAttendance:function(e){this.adjustmentRequest={dialog:!0,data:e}},requestLeave:function(e){this.leaveRequest={dialog:!0,data:e}}}},l=c,u=a("2877"),m=a("6544"),f=a.n(m),h=a("288c"),p=a("b0af"),v=Object(u["a"])(l,s,n,!1,null,null,null);t["default"]=v.exports;f()(v,{VBottomSheet:h["a"],VCard:p["a"]})},f62a:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-form",{ref:"adjustmentForm"},[a("v-card",[a("vue-card-title",{attrs:{title:"Adjust Attendance Entries",subtitle:"Send your attendance entry request",icon:"mdi-file-document-outline",dark:"",closable:""},on:{close:e.closeForm}}),a("v-divider"),a("v-card-text",{staticClass:"scrollbar-md"},[e.nonFieldErrors?a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}}):e._e(),e._l(e.attendanceList,(function(t,s){return[a("v-row",{key:"date"+s,attrs:{align:"center"}},[a("v-col",{staticClass:"px-2"},[a("v-chip",{staticClass:"mx-1",attrs:{label:"",small:""}},[e._v("Adjustment Date : "+e._s(e._f("dayjs")(t.timesheet_for,"YYYY-MM-DD")))])],1)],1),a("v-row",{key:s,staticClass:"horizontal-scrollbar",attrs:{align:"center"}},[a("v-col",{staticClass:"px-2"},[a("v-btn-toggle",{attrs:{mandatory:"","data-cy":"btn-category",dense:"","active-class":"primary white--text"},on:{change:function(a){return e.changeCategory(t,s)}},model:{value:t.category,callback:function(a){e.$set(t,"category",a)},expression:"adjustmentItem.category"}},e._l(e.$options.TimesheetEntryTypes,(function(t,s){return a("v-btn",{key:"category-"+s,attrs:{value:t.value,small:"",text:""},domProps:{textContent:e._s(t.text)}})})),1)],1),a("v-col",{staticClass:"px-2 text-right",attrs:{cols:"12",sm:"4",md:"2"}},[t.timestamp?a("vue-date-time-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|dateTime",expression:"'required|dateTime'"}],attrs:{clearable:!1,"applied-class":"py-0 my-0","initial-time-view":"","disable-calendar-view":""},model:{value:t.timestamp,callback:function(a){e.$set(t,"timestamp",a)},expression:"adjustmentItem.timestamp"}},"vue-date-time-picker",e.veeValidate("timestamp-"+(s+1),"Timesheet Entry *"),!1)):e._e()],1),a("v-col",{staticClass:"text-right",attrs:{cols:"12",sm:"4",md:"2"}},[a("v-checkbox",{staticClass:"ma-0 pa-0",attrs:{label:"Shift extends to next day","hide-details":"",dense:""},on:{change:function(t){return e.updateTimestamp(t,s)}},model:{value:t.extends_to_next_day,callback:function(a){e.$set(t,"extends_to_next_day",a)},expression:"adjustmentItem.extends_to_next_day"}})],1),a("v-col",{staticClass:"px-2 py-0",attrs:{md:"10",sm:"10",cols:"10"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{counter:255},model:{value:t.description,callback:function(a){e.$set(t,"description",a)},expression:"adjustmentItem.description"}},"v-text-field",e.veeValidate("description-"+(s+1),"Remarks *"),!1))],1),a("v-col",{staticClass:"py-0",attrs:{md:"2",sm:"1",cols:"2"}},[a("v-icon",{attrs:{color:"primary",size:"20"},domProps:{textContent:e._s("mdi-plus-box-outline")},on:{click:function(a){return e.addNewRow(s,t)}}}),e.attendanceList.filter((function(e){return e.timesheet===t.timesheet})).length>1?a("v-icon",{attrs:{color:"red"},domProps:{textContent:e._s("mdi-trash-can-outline")},on:{click:function(t){return e.attendanceList.splice(s,1)}}}):e._e()],1)],1),s<e.attendanceList.length-1?a("v-divider",{key:"divider-"+s,staticClass:"pb-3"}):e._e()]}))],2),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",depressed:"",right:"",loading:e.loading},on:{click:e.insertFormData}},[a("v-icon",{attrs:{size:"14"},domProps:{textContent:e._s("mdi-send-outline")}}),e._v(" Send ")],1)],1)],1)],1)},n=[],r=(a("159b"),a("99af"),a("7db0"),a("a434"),a("a4d3"),a("e01a"),a("d567")),i=a("6e60"),o=a("a438"),d=a("f0d5"),c=a("f70a"),l=a("7bb1");l["b"].Validator.extend("dateTime",{validate:function(e){return/(\d{4})-(\d{2})-(\d{2})T(\d{1}|\d{2})[:(\d{2})]*/.test(e)},getMessage:function(e){return"".concat(e," date and time required.")}});var u={components:{VueDateTimePicker:r["a"]},mixins:[c["a"],d["a"]],props:{listOfAttendance:{type:Array,required:!0}},TimesheetEntryTypes:o["d"],data:function(){return{attendanceList:[]}},created:function(){var e=this;this.listOfAttendance.forEach((function(t){e.$set(e.attendanceList,"timestamp","".concat(t.timesheet_for).concat(t.work_time?"T"+t.work_time.start_time:"T00:00:00")),e.attendanceList.push({timesheet_for:t.timesheet_for,timesheet:t.id,category:"",description:"",extends_to_next_day:!1})}))},methods:{insertFormData:function(){var e=this;this.crud.message="Successfully created Attendance entry",this.insertData(i["a"].sendAdjustment(this.getOrganizationSlug),this.getFormValues()).catch((function(t){var a=t.response.data.adjustments,s={response:{data:a}};e.pushIndexedErrors(s,"",!1,"")}))},changeCategory:function(e,t){var a=this.listOfAttendance.find((function(t){return t.timesheet_for===e.timesheet_for})),s="".concat(a.timesheet_for);"Punch Out"===e.category?s="".concat(a.timesheet_for).concat(a.work_time?"T"+a.work_time.end_time:""):"Punch In"===e.category&&(s="".concat(a.timesheet_for).concat(a.work_time?"T"+a.work_time.start_time:"T00:00:00")),this.attendanceList[t].timestamp=s},addNewRow:function(e,t){var a;this.attendanceList.splice(e+1,0,{timesheet:t.timesheet,timesheet_for:t.timesheet_for,category:"",description:"",extends_to_next_day:!1}),this.$set(this.attendanceList[e+1],"timestamp","".concat(t.timesheet_for,"T").concat(null===(a=t.work_time)||void 0===a?void 0:a.start_time))},getFormValues:function(){for(var e=[],t={},a=0;a<this.attendanceList.length;a++)t.timesheet=this.attendanceList[a].timesheet,t.timestamp=this.attendanceList[a].timestamp||null,t.category=this.attendanceList[a].category,t.description=this.attendanceList[a].description,t.status="Requested",e.push(t),t={};var s={};return s.adjustments=e,s},formatDate:function(e){return this.$dayjs(e).format("HH:mm a")},processAfterInsert:function(){this.closeForm()},closeForm:function(){this.attendanceList=null,this.$emit("reload-form")},updateTimestamp:function(e,t){var a=this.attendanceList[t].timestamp,s=new Date(a);e?s.setDate(s.getDate()+1):s.setDate(s.getDate()-1);var n=this.$dayjs(s).format("YYYY-MM-DD"),r=this.$dayjs(s).format("HH:mm"),i=n+"T"+r;this.$set(this.attendanceList[t],"timestamp",i)}}},m=u,f=a("2877"),h=a("6544"),p=a.n(h),v=a("8336"),g=a("a609"),b=a("b0af"),_=a("99d9"),y=a("ac7c"),x=a("cc20"),k=a("62ad"),C=a("ce7e"),q=a("4bd4"),j=a("132d"),w=a("0fd9b"),R=a("2fa4"),T=a("8654"),V=Object(f["a"])(m,s,n,!1,null,null,null);t["a"]=V.exports;p()(V,{VBtn:v["a"],VBtnToggle:g["a"],VCard:b["a"],VCardActions:_["a"],VCardText:_["c"],VCheckbox:y["a"],VChip:x["a"],VCol:k["a"],VDivider:C["a"],VForm:q["a"],VIcon:j["a"],VRow:w["a"],VSpacer:R["a"],VTextField:T["a"]})}}]);