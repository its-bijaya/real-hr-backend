(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/user/payroll/advance-salary/index","chunk-2d2160c2","chunk-2d2160c2","chunk-2d2160c2","chunk-2d2160c2","chunk-2d2160c2"],{c197:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.divClass},[a("v-img",{class:e.imgClass,attrs:{src:"/svg/three-dots.svg",height:e.height,contain:""}}),a("h3",{staticClass:"text-center grey--text",domProps:{textContent:e._s(e.message)}})],1)},n=[],r={props:{message:{type:String,default:"Please wait. Fetching data just for you ..."},divClass:{type:String,default:"pa-12"},imgClass:{type:String,default:"my-6"},height:{type:String,default:"20"}},data:function(){return{}}},i=r,o=a("2877"),l=a("6544"),u=a.n(l),c=a("adda"),d=Object(o["a"])(i,s,n,!1,null,null,null);t["default"]=d.exports;u()(d,{VImg:c["a"]})},c5ab:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vue-page-wrapper",{attrs:{title:e.htmlTitle,"bread-crumbs":e.breadCrumbItems}},[a("v-tabs",{attrs:{"slider-color":"blue"},model:{value:e.activeTabs,callback:function(t){e.activeTabs=t},expression:"activeTabs"}},[e._l(e.tabItems,(function(t){return a("v-tab",{key:t.value,attrs:{ripple:"",disabled:e.loading}},[a("span",{staticClass:"pr-2 text-capitalize"},[e._v(" "+e._s(t.tabName)+" ")])])})),a("v-spacer"),a("v-btn",{staticClass:"mt-1",attrs:{color:"primary",small:"",depressed:""},on:{click:function(t){e.showRequestAdvance=!0}}},[e._v(" Request Advance ")]),a("v-tab-item",[0===e.activeTabs?a("v-card",[a("vue-card-title",{attrs:{title:"Advance Salary",subtitle:"Here you can request / view advance salary",icon:"mdi-cash"}}),a("v-divider"),e.showFilters?a("v-divider"):e._e(),a("v-tabs",{attrs:{"slider-color":"blue"},model:{value:e.searchFilters.activeStatus,callback:function(t){e.$set(e.searchFilters,"activeStatus",t)},expression:"searchFilters.activeStatus"}},e._l(e.tabs,(function(t){return a("v-tab",{key:t.tabName,attrs:{ripple:"",disabled:e.loading}},[a("span",{staticClass:"pr-2 text-capitalize"},[e._v(" "+e._s(t.tabName)+" ")]),a("v-chip",{staticClass:"white--text",attrs:{color:t.color,small:""}},[e._v(" "+e._s(t.count)+" ")])],1)})),1),a("v-divider"),a("v-data-table",{attrs:{headers:e.headers,items:e.fetchedResults,"sort-desc":e.pagination.descending,"sort-by":e.pagination.sortBy,page:e.pagination.page,"items-per-page":e.pagination.rowsPerPage,"footer-props":e.footerProps,"server-items-length":e.pagination.totalItems,"must-sort":"","mobile-breakpoint":0},on:{"update:sortDesc":function(t){return e.$set(e.pagination,"descending",t)},"update:sort-desc":function(t){return e.$set(e.pagination,"descending",t)},"update:sortBy":function(t){return e.$set(e.pagination,"sortBy",t)},"update:sort-by":function(t){return e.$set(e.pagination,"sortBy",t)},"update:page":function(t){return e.$set(e.pagination,"page",t)},"update:itemsPerPage":function(t){return e.$set(e.pagination,"rowsPerPage",t)},"update:items-per-page":function(t){return e.$set(e.pagination,"rowsPerPage",t)}},scopedSlots:e._u([{key:"item",fn:function(t){return[a("tr",[a("td",{staticClass:"text-center",domProps:{textContent:e._s(t.item.amount.toLocaleString())}}),a("td",{domProps:{textContent:e._s(e.humanizeDate(t.item.created_at))}}),a("td",{domProps:{textContent:e._s(t.item.request_type)}}),a("td",{staticClass:"text-center",domProps:{textContent:e._s(t.item.amount_to_be_paid?t.item.amount_to_be_paid.toLocaleString():"N/A")}}),a("td",{staticClass:"text-center"},["Requested"===t.item.status?a("div",[a("v-menu",{attrs:{"nudge-width":10,"open-on-hover":!0,bottom:"",right:"",transition:"scale-transition",origin:"top left"},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-chip",{staticClass:"white--text",attrs:{small:"",outlined:"",color:e.statusColor[t.item.status]}},[a("v-avatar",{staticStyle:{"margin-left":"-12px"},attrs:{left:""}},[a("v-img",e._g({attrs:{src:t.item.recipient.profile_picture_thumb||t.item.recipient.profile_picture}},n))],1),e._v(" "+e._s(t.item.status)+" ")],1)]}}],null,!0)},[a("vue-hover-card",{attrs:{user:t.item.recipient}})],1)],1):a("div",[a("v-chip",{attrs:{color:e.statusColor[t.item.status],small:"",outlined:""},domProps:{textContent:e._s(t.item.status)}})],1)]),a("td",{staticClass:"text-center"},[a("vue-context-menu",{attrs:{"context-list":"Repayment"===t.item.status?[{name:"View  Request",icon:"mdi-eye-outline",color:"blue"},{name:"View Payslip",icon:"mdi-sack-percent",color:"blue"}]:"Requested"===t.item.status?[{name:"View  Request",icon:"mdi-eye-outline",color:"blue"},{name:"Cancel Request",icon:"mdi-cancel",color:"danger"}]:[{name:"View  Request",icon:"mdi-eye-outline",color:"blue"}]},on:{click0:function(a){e.showRequestDetails=!0,e.selectedRequest=t.item},click1:function(a){"Requested"===t.item.status?(e.requestDetails=t.item)(e.disassociateAdvanceSalaryDialog.dialog=!0):e.generateAdvanceSalary(t.item.id)}}})],1)])]}}],null,!1,2120473198)},[a("template",{slot:"no-data"},[a("data-table-no-data",{attrs:{loading:e.loading}})],1)],2),a("v-bottom-sheet",{attrs:{persistent:"",scrollable:""},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.showRequestDetails=!1}},model:{value:e.showRequestDetails,callback:function(t){e.showRequestDetails=t},expression:"showRequestDetails"}},[e.selectedRequest?a("v-card",[a("vue-card-title",{attrs:{title:"View Request Status",subtitle:"Here you can view details of advance salary request",icon:"mdi-eye-outline",closable:"",dark:""},on:{close:function(t){e.showRequestDetails=!1}}}),a("v-divider"),a("v-card-text",[e.showRequestDetails?a("advance-salary-request-status",{attrs:{"item-request":e.selectedRequest},on:{closeForm:e.refreshData}}):e._e()],1)],1):e._e()],1),a("vue-dialog",{attrs:{notify:e.disassociateAdvanceSalaryDialog},on:{close:function(t){e.disassociateAdvanceSalaryDialog.dialog=!1},agree:e.disassociateAdvanceSalary}}),a("v-bottom-sheet",{attrs:{persistent:""},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.deleteAdvanceSalary=!1}},model:{value:e.deleteAdvanceSalary,callback:function(t){e.deleteAdvanceSalary=t},expression:"deleteAdvanceSalary"}})],1):e._e()],1),1===e.activeTabs?a("v-tab-item",[a("surplus-request",{key:e.id,attrs:{heading:e.surplusHeading},on:{"open-surplus-request":e.openSurplusRequest}})],1):e._e()],2),a("v-dialog",{attrs:{scrollable:"",persistent:"",width:"920px"},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.viewAdvanceSalaryPayslip=!1}},model:{value:e.viewAdvanceSalaryPayslip,callback:function(t){e.viewAdvanceSalaryPayslip=t},expression:"viewAdvanceSalaryPayslip"}},[a("v-card",[a("vue-card-title",{attrs:{title:"View Advance Salary payslip",subtitle:"Here you can view advance salary payslip",icon:"mdi-eye-outline",closable:"",dark:""},on:{close:function(t){e.viewAdvanceSalaryPayslip=!1}}}),a("v-divider"),e.viewAdvanceSalaryPayslip?a("advance-salary-generate",{attrs:{"item-request":e.payslipDetails},on:{closeForm:function(t){e.viewAdvanceSalaryPayslip=!1,e.getDetails()}}}):e._e()],1)],1),e.showRequestAdvance?a("v-dialog",{attrs:{scrollable:"","max-width":"1000"},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.showRequestAdvance=!1}},model:{value:e.showRequestAdvance,callback:function(t){e.showRequestAdvance=t},expression:"showRequestAdvance"}},[e.showRequestAdvance?a("request-advance",{attrs:{"surplus-detail":e.surplusDetail},on:{change:function(t){e.activeTabs=t},close:function(t){e.showRequestAdvance=!1,e.fetchDataTable(),e.id=t,e.surplusDetail={}}}}):e._e()],1):e._e()],1)},n=[],r=a("5530"),i=(a("ac1f"),a("841c"),a("d3b7"),a("0549")),o=a("27f7"),l=a("a51f"),u=a("e4bf"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:"Request Advance",subtitle:"Here you can request advance salary.",icon:"mdi-send-outline",closable:""},on:{close:function(t){return e.$emit("close")}}}),a("v-divider"),e.nonFieldErrors?a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}}):e._e(),a("v-card-text",{staticClass:"scrollbar-md"},[e.loading?a("v-row",{attrs:{align:"center",justify:"center"}},[a("default-svg-loader")],1):e.notApplicable?a("v-row",[a("div",[e._v(" Currently you cannot request Advance Salary. Please consult with HR for further details. ")])]):a("v-row",[a("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[a("span",[e._v("The maximum amount that you can request for advance salary:")]),a("span",{staticClass:"text-subtitle-2 font-weight-bold blueGrey--text pl-2",domProps:{textContent:e._s(e.payrollInfo.limit_amount?e.payrollInfo.limit_amount.toLocaleString():"N/A")}})]),a("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[a("span",[e._v("The maximum duration that you may request for advance salary repayment:")]),a("span",{staticClass:"text-subtitle-2 font-weight-bold blueGrey--text pl-2",domProps:{textContent:e._s(e.payrollInfo.disbursement_limit_for_repayment+" disbursement")}},[e._v(" Disbursement ")])]),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-row",{attrs:{"no-gutters":"",align:"end"}},[a("v-checkbox",{staticClass:"py-0",attrs:{"hide-details":""},model:{value:e.excessRequest,callback:function(t){e.excessRequest=t},expression:"excessRequest"}}),a("span",{staticClass:"danger--text text--lighten-2 mb-1"},[e._v("I would like to request more than my limit amount")])],1)],1),a("v-col",{attrs:{cols:"12"}},[a("v-card",{staticClass:"very-light-blue",attrs:{flat:""}},[a("v-row",{staticClass:"mx-2"},[a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-icon",{attrs:{size:"16"},domProps:{textContent:e._s("mdi-cash")}}),a("div",{staticClass:"mx-1"},[e._v("Enter Amount (NRs.) *:")])],1),a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},[a("v-col",{staticClass:"text-left",attrs:{md:"4",cols:"12"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mx-2 my-0 py-0",attrs:{type:"number",min:"0"},model:{value:e.formValues.amount,callback:function(t){e.$set(e.formValues,"amount",t)},expression:"formValues.amount"}},"v-text-field",e.veeValidate("amount",""),!1))],1)],1)],1),!e.excessRequest||e.surplusCondition&&e.excessRequest?a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-icon",{attrs:{size:"16"},domProps:{textContent:e._s("mdi-calendar")}}),a("div",{staticClass:"mx-1"},[e._v("Select Date For Advance Salary: *")])],1),a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},[a("v-col",{staticClass:"text-left",attrs:{md:"6",cols:"12"}},[a("vue-date-picker",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"applied-class":"my-0 py-0","hide-details":"","prepend-inner-icon":""},model:{value:e.formValues.requested_for,callback:function(t){e.$set(e.formValues,"requested_for",t)},expression:"formValues.requested_for"}},"vue-date-picker",e.veeValidate("Date",""),!1))],1),a("v-col",{staticClass:"mt-1",attrs:{cols:"12"}},[a("span",{staticClass:"danger--text"},[e._v(" "+e._s(e.errors.first("Date"))+" ")])])],1)],1):e._e(),!e.excessRequest||e.surplusCondition&&e.excessRequest?a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-row",{staticClass:"mx-1",attrs:{"no-gutters":""}},[a("v-icon",{attrs:{size:"16"},domProps:{textContent:e._s("mdi-timer-outline")}}),a("div",{staticClass:"mx-1"},[e._v("Select duration For Repayment:")])],1),a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"12",md:"4"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mx-2 my-0 py-0",attrs:{type:"number","hide-details":""},model:{value:e.formValues.disbursement_count_for_repayment,callback:function(t){e.$set(e.formValues,"disbursement_count_for_repayment",t)},expression:"formValues.disbursement_count_for_repayment"}},"v-text-field",e.veeValidate("disbursement count",""),!1))],1),a("v-col",{staticClass:"pl-3",attrs:{cols:"8"}},[e._v("Disbursement")]),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("disbursement count"))+" ")])],1)],1):e._e(),!e.excessRequest||e.surplusCondition&&e.excessRequest?a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-icon",{attrs:{size:"16"},domProps:{textContent:e._s("mdi-file-upload-outline")}}),a("div",{staticClass:"mx-1"},[e._v("Upload Support Documents:")])],1),a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[a("file-upload",{attrs:{"hide-details":""},model:{value:e.attachment,callback:function(t){e.attachment=t},expression:"attachment"}}),a("span",{staticClass:"danger--text mt-1"},[e._v(" "+e._s(e.errors.first("attachment"))+" ")])],1),a("v-col",{staticClass:"mx-2",attrs:{cols:"3"}},[a("v-icon",{attrs:{color:"primary",disabled:!e.attachment},domProps:{textContent:e._s("mdi-plus-box")},on:{click:function(t){return e.appendFiles()}}})],1)],1)],1):e._e(),!e.excessRequest||e.surplusCondition&&e.excessRequest?a("v-col",{attrs:{cols:"12",md:"8"}},[a("div",e._l(e.formValues.attachments,(function(t,s){return a("ul",{key:s},[a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(n){var r=n.hover;return a("li",{},[a("span",[e._v(" "+e._s(t.file.name)+" "),r?a("a",{on:{click:function(t){return e.formValues.attachments.splice(s,1)}}},[a("v-icon",{attrs:{color:"danger",small:""}},[e._v("mdi-close")])],1):e._e()])])}}],null,!0)})],1)})),0)]):e._e(),a("v-col",{attrs:{cols:"12"}},[a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:600",expression:"'required|max:600'"}],staticClass:"py-0 my-0",attrs:{counter:"600","prepend-inner-icon":"mdi-file-upload-outline"},model:{value:e.formValues.reason_for_request,callback:function(t){e.$set(e.formValues,"reason_for_request",t)},expression:"formValues.reason_for_request"}},"v-text-field",e.veeValidate("reason_for_request","Reason For Request *"),!1))],1)],1)],1)],1)],1)],1),e.amountIsEqual?e._e():a("v-col",[a("span",{staticClass:"danger--text"},[e._v("Error: Sum must be equal to total amount")])]),!e.excessRequest||e.surplusCondition&&e.excessRequest?a("v-col",{attrs:{cols:"12"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12"}},[a("v-card",{staticClass:"very-light-blue",attrs:{flat:""}},[a("v-list-item",[a("v-list-item-content",{staticClass:"py-0"},[a("v-list-item-title",{staticClass:"text-h6 blueGrey--text text-center py-0"},[e._v("Repayment Options")])],1)],1),a("v-card-text",{staticClass:"py-0"},[a("v-row",{staticClass:"mx-1",attrs:{"no-gutters":""}},[a("div",[e._v("Requested Advance Salary Amount:")]),a("div",{staticClass:"ml-1 text-subtitle-2 blueGrey--text"},[e._v(" NRs. "+e._s(e.formValues.amount)+" ")])]),a("v-row",{staticClass:"mx-1",attrs:{"no-gutters":""}},[a("div",[e._v("System Disbursed Amount:")]),a("div",{staticClass:"ml-1 text-subtitle-2 blueGrey--text"},[e._v(" NRs. "+e._s(e.formValues.amount&&e.formValues.disbursement_count_for_repayment?(e.formValues.amount/e.formValues.disbursement_count_for_repayment).toFixed(2):0)+" ")])]),e.disbursementCount?a("v-row",{attrs:{"no-gutters":"",align:"baseline"}},e._l(e.disbursementCount,(function(t){return a("v-col",{key:t,staticClass:"text-left `",attrs:{cols:"12",md:"2"}},[a("v-text-field",{staticClass:"mx-2",attrs:{value:(e.formValues.amount/e.disbursementCount).toFixed(2)||0,type:"number",label:"Installment "+t,"hide-details":""},on:{input:function(a){return e.setAmountRepaymentPlan(a,t-1)}}})],1)})),1):e._e()],1)],1)],1)],1)],1):e._e()],1)],1),a("v-divider"),a("v-card-actions",{staticClass:"py-0 very-light-blue"},[a("v-col",{staticClass:"text-right",attrs:{md:"12"}},[a("v-btn",{attrs:{small:"",depressed:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),a("v-btn",{attrs:{disabled:!e.amountIsEqual||e.notApplicable,small:"",depressed:"",loading:e.loading,color:"primary"},on:{click:e.submitRequest}},[e._v(" Confirm Request ")])],1)],1)],1)},d=[],m=a("1da1"),p=(a("96cf"),a("4fad"),a("b680"),a("a434"),a("a9e3"),a("159b"),a("b64b"),a("d81d"),a("c197")),v=a("c44a"),f=a("741f"),h=a("f82f"),b=a("258f"),y=a("a79c"),g=a("ab8a"),_={components:{FileUpload:h["a"],VueDatePicker:f["default"],DefaultSvgLoader:p["default"],NonFieldFormErrors:g["default"]},mixins:[v["a"]],props:{surplusDetail:{type:Object,default:function(){return{}}}},data:function(){return{disbursementCount:0,payrollInfo:{},loading:!1,notApplicable:!1,attachment:null,amountIsEqual:!0,formValues:{disbursement_count_for_repayment:1,attachments:[],repayment_plan:[]},excessRequest:!1,documents:[]}},computed:{surplusCondition:function(){return Object.entries(this.surplusDetail).length}},watch:{"formValues.disbursement_count_for_repayment":function(e){this.disbursementCount=parseInt(e);var t=(this.formValues.amount/e).toFixed(2)||0;this.formValues.repayment_plan=[];for(var a=0;a<e;a++)this.formValues.repayment_plan.push(t);this.amountIsEqual=!0},"formValues.amount":function(e){var t=(e/this.formValues.disbursement_count_for_repayment).toFixed(2)||0;this.formValues.repayment_plan=[];for(var a=0;a<this.formValues.disbursement_count_for_repayment;a++)this.formValues.repayment_plan.push(t);this.amountIsEqual=!0}},mounted:function(){this.getAdvanceSalaryInfo(),this.surplusCondition&&(this.formValues.amount=this.surplusDetail.amount,this.excessRequest=!0)},methods:{appendFiles:function(){this.attachment?(this.formValues.attachments.unshift({file:this.attachment}),this.attachment=null):this.setSnackBar({text:"Please add attachment",color:"red"})},setAmountRepaymentPlan:function(e,t){this.formValues.repayment_plan.splice(t,1,e);var a=this.formValues.repayment_plan.reduce((function(e,t){return Number(e)+Number(t)}));this.amountIsEqual=a===Number(this.formValues.amount)},submitRequest:function(){this.excessRequest&&this.surplusCondition?this.conformRequest():this.excessRequest?this.requestSurplusAmount():this.conformRequest()},conformRequest:function(){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return",!0);case 2:return t.next=4,e.validateAllFields();case 4:if(!t.sent){t.next=15;break}e.loading=!0,e.clearNonFieldErrors(),e.$validator.errors.clear(),a=e.deepCopy(e.formValues),Object.keys(e.formValues.attachments).forEach((function(t){a["attachment".concat(t)]=e.formValues.attachments[t]})),a.repayment_plan=JSON.stringify(a.repayment_plan.map(Number)),delete a.attachments,s=Object(y["b"])(a),e.surplusCondition&&(s.append("above_limit","true"),s.append("surplus_request",e.surplusDetail.id)),e.$http.post(b["a"].advanceSalaryRequest(e.getOrganizationSlug),s).then((function(t){e.notifyUser("Successfully Requested Advance Salary.","green"),e.$emit("close",t.id),e.$emit("change",0),e.loading=!1})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse(),e.loading=!1}));case 15:case"end":return t.stop()}}),t)})))()},requestSurplusAmount:function(){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.validateAllFields();case 4:if(!t.sent){t.next=8;break}e.loading=!0,a={amount:e.formValues.amount,reason_for_request:e.formValues.reason_for_request},e.$http.post(b["a"].surplusRequests(e.getOrganizationSlug),a).then((function(t){e.notifyUser("Successfully Requested Surplus Amount.","green"),e.$emit("close",t.id),e.$emit("change",1)})).catch((function(t){e.pushErrors(t),e.notifyInvalidFormResponse(),e.loading=!1}));case 8:case"end":return t.stop()}}),t)})))()},getAdvanceSalaryInfo:function(){var e=this;this.loading=!0,this.$http.get(b["a"].infoAdvanceSalaryRequest(this.getOrganizationSlug)).then((function(t){e.payrollInfo=t,e.payrollInfo.disbursement_limit_for_repayment&&(e.disbursementCount=e.payrollInfo.disbursement_limit_for_repayment,e.formValues.disbursement_count_for_repayment=e.payrollInfo.disbursement_limit_for_repayment)})).catch((function(){e.notApplicable=!0})).finally((function(){e.loading=!1}))}}},x=_,q=a("2877"),C=a("6544"),R=a.n(C),S=a("8336"),w=a("b0af"),A=a("99d9"),V=a("ac7c"),k=a("62ad"),D=a("ce7e"),P=a("ce87"),F=a("132d"),T=a("da13"),I=a("5d23"),O=a("0fd9b"),$=a("8654"),E=Object(q["a"])(x,c,d,!1,null,null,null),N=E.exports;R()(E,{VBtn:S["a"],VCard:w["a"],VCardActions:A["a"],VCardText:A["c"],VCheckbox:V["a"],VCol:k["a"],VDivider:D["a"],VHover:P["a"],VIcon:F["a"],VListItem:T["a"],VListItemContent:I["a"],VListItemTitle:I["c"],VRow:O["a"],VTextField:$["a"]});var z=a("2f62"),j=a("6a8c"),B=a("ea98"),H=a("49bb"),L=a("b389"),M=a("96d7"),U={components:{SurplusRequest:M["a"],VuePageWrapper:i["default"],VueContextMenu:u["default"],DataTableNoData:l["default"],RequestAdvance:N,AdvanceSalaryRequestStatus:j["a"],VueDialog:B["a"],VueHoverCard:H["a"],AdvanceSalaryGenerate:L["a"]},mixins:[o["a"]],props:{},data:function(){return{htmlTitle:"Advance Salary | Payroll | User",breadCrumbItems:[{text:"Payroll",disabled:!0},{text:"Advance Salary",disabled:!0}],loading:!1,menu:!1,id:"",headers:[{text:"Requested Amount",value:"amount",align:"",sortable:!0},{text:"Requested Date",value:"created_at",align:"",sortable:!0},{text:"Requested Type",value:"requested_type",align:"",sortable:!1},{text:"Amount To Be Paid",value:"amount_to_be_paid",align:"",sortable:!0},{text:"Status",align:"center",value:"status",sortable:!1},{text:"Action",align:"center",sortable:!1}],surplusDetail:{},tabItems:[{tabName:"Advance Request"},{tabName:"Surplus Request"}],tabs:[{tabName:"Requested",value:"Requested",count:"0",color:"orange"},{tabName:"Approved",value:"Approved",count:"0",color:"teal"},{tabName:"Repayment",value:"Repayment",count:"0",color:"cyan"},{tabName:"Completed",value:"Completed",count:"0",color:"success"},{tabName:"Canceled",value:"Canceled",count:"0",color:"danger"},{tabName:"Denied",value:"Denied",count:"0",color:"indigo"},{tabName:"All",value:"",count:"0",color:"blue"}],requestDetails:{},search:"",viewAdvanceSalaryPayslip:!1,payslipDetails:{},statusColor:{Requested:"orange",Repayment:"cyan",Approved:"green",Denied:"indigo",Completed:"success",Canceled:"danger"},activeTabs:0,showRequestHistory:!1,surplusHeading:{title:"Surplus Request Details",subheading:"The list below contains the information of surplus request."},showRequestDetails:!1,selectedRequest:{},countUpdated:!1,showRequestAdvance:!1,deleteAdvanceSalary:!1,searchFilters:{activeStatus:0,user:""},showFilters:!1,autoCompleteParam:{organization:this.getOrganizationSlug},disassociateAdvanceSalaryDialog:{dialog:!1,heading:"Cancel Advance Salary",subheading:"Cancel Advance Salary",text:"Are you sure you want to cancel the advance salary request ? This action cannot be undone."}}},computed:Object(r["a"])(Object(r["a"])({},Object(z["c"])({getSupervisorOrgSlug:"supervisor/getOrganizationSlug"})),{},{DataTableFilter:function(){return{employee:this.searchFilters.user||"",status:this.tabs[this.searchFilters.activeStatus].value}}}),watch:{activeTabs:function(){this.fetchDataTable()}},created:function(){this.autoCompleteParam={organization:this.getOrganization},this.crud.endpoint.common=b["a"].getAdvanceSalaryRequest(this.supervisor?this.getSupervisorOrgSlug:this.getOrganizationSlug),this.$route.query.tab&&(this.activeTabs=1),this.fetchDataTable()},methods:{searchData:function(){this.getParams({search:this.search}),this.fetchDataTable()},generateAdvanceSalary:function(e){var t=this;this.$http.get(b["a"].generatePaySlip(this.getOrganizationSlug,e)).then((function(e){t.payslipDetails=e,t.viewAdvanceSalaryPayslip=!0})).finally((function(){t.loading=!1}))},openSurplusRequest:function(e){this.surplusDetail=e,this.showRequestAdvance=!0},processAfterTableLoad:function(e){this.updateCounts(e.counts)},humanizeDate:function(e){return this.$dayjs(e).format("YYYY-MM-DD")},updateCounts:function(e){this.tabs[0].count=e["Requested"],this.tabs[1].count=e["Approved"],this.tabs[2].count=e["Repayment"],this.tabs[3].count=e["Completed"],this.tabs[4].count=e["Canceled"],this.tabs[5].count=e["Denied"],this.tabs[6].count=e["All"]},disassociateAdvanceSalary:function(){var e=this;this.$http.post(b["a"].cancelAdvanceSalaryRequest(this.getOrganizationSlug,this.requestDetails.id)).then((function(){e.setSnackBar({text:"Your request has been canceled",color:"green"})})).catch((function(t){if(e.pushErrors(t),e.nonFieldErrors.length){var a=e.nonFieldErrors[0].detail||"You cannot perform this operation";e.setSnackBar({text:a,color:"red"})}})).finally((function(){e.disassociateAdvanceSalaryDialog.dialog=!1,e.fetchDataTable()}))},refreshData:function(e){!0===e&&(this.countUpdated=!1,this.fetchDataTable()),this.showRequestDetails=!1}}},G=U,Y=a("8212"),J=a("288c"),W=a("cc20"),K=a("8fea"),Q=a("169a"),X=a("adda"),Z=a("e449"),ee=a("2fa4"),te=a("71a3"),ae=a("c671"),se=a("fe57"),ne=Object(q["a"])(G,s,n,!1,null,null,null);t["default"]=ne.exports;R()(ne,{VAvatar:Y["a"],VBottomSheet:J["a"],VBtn:S["a"],VCard:w["a"],VCardText:A["c"],VChip:W["a"],VDataTable:K["a"],VDialog:Q["a"],VDivider:D["a"],VImg:X["a"],VMenu:Z["a"],VSpacer:ee["a"],VTab:te["a"],VTabItem:ae["a"],VTabs:se["a"]})},ce87:function(e,t,a){"use strict";var s=a("16b7"),n=a("f2e7"),r=a("58df"),i=a("d9bd");t["a"]=Object(r["a"])(s["a"],n["a"]).extend({name:"v-hover",props:{disabled:{type:Boolean,default:!1},value:{type:Boolean,default:void 0}},methods:{onMouseEnter:function(){this.runDelay("open")},onMouseLeave:function(){this.runDelay("close")}},render:function(){return this.$scopedSlots.default||void 0!==this.value?(this.$scopedSlots.default&&(e=this.$scopedSlots.default({hover:this.isActive})),Array.isArray(e)&&1===e.length&&(e=e[0]),e&&!Array.isArray(e)&&e.tag?(this.disabled||(e.data=e.data||{},this._g(e.data,{mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave})),e):(Object(i["c"])("v-hover should only contain a single element",this),e)):(Object(i["c"])("v-hover is missing a default scopedSlot or bound value",this),null);var e}})}}]);