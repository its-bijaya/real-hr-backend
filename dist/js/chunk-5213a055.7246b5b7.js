(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5213a055"],{"077d":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}));var i={"Salary Structure":{available_types:["Addition"],type:"Addition"},"Allowance Settings":{available_types:["Addition"],type:"Addition"},"Fringe Benefits":{available_types:["Addition","Extra Addition"],type:"Addition"},"Provident Fund":{available_types:["Deduction","Addition"],type:"Deduction"},CIT:{available_types:["Deduction"],type:"Deduction"},"Social Security Fund":{available_types:["Addition","Deduction"],type:"Addition"},"Salary TDS":{available_types:["Tax Deduction"],type:"Tax Deduction"},"Loan or Advances":{available_types:["Extra Addition"],type:"Extra Addition"},"Expense Settlement":{available_types:["Extra Deduction"],type:"Extra Deduction"},"Penalty/Deduction":{available_types:["Extra Deduction"],type:"Extra Deduction"}},n={Addition:[],Deduction:[],"Extra Addition":["duration_unit","absent_days_impact"],"Extra Deduction":["duration_unit","absent_days_impact"],"Tax Deduction":["duration_unit","taxable","absent_days_impact"],Type1Cnst:["taxable","benefit_type","absent_days_impact"],Type2Cnst:["duration_unit","taxable","benefit_type","absent_days_impact"]}},"7f8f":function(e,t,a){"use strict";t["a"]={postHeading:"/payroll/headings/",getHeadingById:function(e){return"/payroll/headings/".concat(e,"/")},updateHeadingById:function(e){return"/payroll/headings/".concat(e,"/")},deleteHeadingById:function(e){return"/payroll/headings/".concat(e,"/")},getVariables:"/payroll/headings/get_variables/",getHeadingChoices:"/payroll/headings/choices/",switchHeadingOrder:"/payroll/headings/switch_order/",updateUserPackageHeading:function(e){return"/payroll/headings/".concat(e,"/bulk-apply-to-users")},archiveUnArchivePayrollHeading:function(e){return"/payroll/headings/".concat(e,"/archive")}}},"90c6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.showTitle?a("v-row",[a("v-col",{attrs:{cols:"11"}},[a("div",{staticClass:"px-3 blue-grey--text text--darken-2 font-weight-bold"},[e._v(" Add New Heading ")])]),a("v-col",{staticClass:"pl-3",attrs:{cols:"1"}},[a("v-icon",{attrs:{size:16},domProps:{textContent:e._s(e.showDetail?"mdi-chevron-up":"mdi-chevron-down")},on:{click:function(t){e.showDetail=!e.showDetail}}})],1),a("v-col",{staticClass:"pa-0 ma-0 pr-3",attrs:{cols:"12"}},[a("v-divider")],1)],1):e._e(),a("v-card-text",{class:{"scrollbar-lg":e.showTitle}},[a("v-form",{ref:"payrollForm"},[e.nonFieldErrors.length>0?a("v-col",{attrs:{cols:"12"}},[a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}})],1):e._e(),e.showDetail?a("v-row",[a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:150",expression:"'required|max:150'"}],attrs:{disabled:e.formData.is_heading_used,counter:"150",type:"text"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}},"v-text-field",e.veeValidate("name","Name *"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:e.formData.is_heading_used,type:"number",readonly:""},model:{value:e.formData.order,callback:function(t){e.$set(e.formData,"order",t)},expression:"formData.order"}},"v-text-field",e.veeValidate("order","Order"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:e.formData.is_heading_used,items:e.payrollSettingTypeList,autocomplete:""},model:{value:e.formData.payroll_setting_type,callback:function(t){e.$set(e.formData,"payroll_setting_type",t)},expression:"formData.payroll_setting_type"}},"v-autocomplete",e.veeValidate("payroll_setting_type","Payroll Setting Type *"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:e.formData.is_heading_used,items:e.heading_type_options,autocomplete:""},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},"v-autocomplete",e.veeValidate("type","Type *"),!1),[["Extra Addition","Extra Deduction"].includes(e.formData.type)?a("template",{slot:"append-outer"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-icon",e._g({attrs:{color:"indigo",size:"20"},domProps:{textContent:e._s("mdi-help-rhombus-outline")}},i))]}}],null,!1,1926674847)},[a("ul",[a("li",[e._v(" If heading is taxable, tax for this heading will be calculated in the same payroll month. ")]),a("li",[e._v(" This variable amount will not be used in projecting AGS. ")])])])],1):e._e()],2)],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:e.getDisabledStatus("duration_unit")||e.formData.is_heading_used?"":"required",expression:"\n                getDisabledStatus('duration_unit') || formData.is_heading_used\n                  ? ''\n                  : 'required'\n              "}],attrs:{disabled:e.getDisabledStatus("duration_unit")||e.formData.is_heading_used,items:["Hourly","Daily","Monthly","Yearly","Unit Of Work"],autocomplete:""},model:{value:e.formData.duration_unit,callback:function(t){e.$set(e.formData,"duration_unit",t)},expression:"formData.duration_unit"}},"v-autocomplete",e.veeValidate("duration_unit","Duration Unit *"),!1),["Hourly"===e.formData.duration_unit?a("template",{slot:"append-outer"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-icon",e._g({attrs:{color:"indigo",size:"20"},domProps:{textContent:e._s("mdi-help-rhombus-outline")}},i))]}}],null,!1,1926674847)},[a("ul",[a("li",[e._v(" If heading is taxable, tax for this heading will be calculated in the same payroll month. ")]),a("li",[e._v(" This variable amount will not be used in projecting AGS. ")])])])],1):e._e()],2)],1),"Hourly"!==e.formData.duration_unit||"Addition"!==e.formData.type&&"Deduction"!==e.formData.type?e._e():a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"px-1",attrs:{items:["Overtime","Total Hour Worked"],autocomplete:""},model:{value:e.formData.hourly_heading_source,callback:function(t){e.$set(e.formData,"hourly_heading_source",t)},expression:"formData.hourly_heading_source"}},"v-autocomplete",e.veeValidate("hourly_heading_source","Choose Hourly Record *"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:e.getDisabledStatus("taxable")||e.formData.is_heading_used?"":"required",expression:"\n                getDisabledStatus('taxable') || formData.is_heading_used\n                  ? ''\n                  : 'required'\n              "}],attrs:{disabled:e.getDisabledStatus("taxable")||e.formData.is_heading_used,items:[{label:"Yes",value:!0},{label:"No",value:!1}],"item-text":"label","item-value":"value",autocomplete:""},model:{value:e.formData.taxable,callback:function(t){e.$set(e.formData,"taxable",t)},expression:"formData.taxable"}},"v-autocomplete",e.veeValidate("taxable","Is Taxable *"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:e.getDisabledStatus("absent_days_impact")||e.formData.is_heading_used?"":"required",expression:"\n                getDisabledStatus('absent_days_impact') ||\n                formData.is_heading_used\n                  ? ''\n                  : 'required'\n              "}],attrs:{disabled:e.getDisabledStatus("absent_days_impact")||e.formData.is_heading_used,items:[{label:"Yes",value:!0},{label:"No",value:!1}],"item-text":"label","item-value":"value",autocomplete:""},model:{value:e.formData.absent_days_impact,callback:function(t){e.$set(e.formData,"absent_days_impact",t)},expression:"formData.absent_days_impact"}},"v-autocomplete",e.veeValidate("absent_days_impact","Absent Days Impact *"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}},[a("v-autocomplete",e._b({directives:[{name:"validate",rawName:"v-validate",value:e.getDisabledStatus("benefit_type")||e.formData.is_heading_used?"":"required",expression:"\n                getDisabledStatus('benefit_type') || formData.is_heading_used\n                  ? ''\n                  : 'required'\n              "}],attrs:{disabled:e.getDisabledStatus("benefit_type")||e.formData.is_heading_used,items:["Monetary Benefit","Non Monetary Benefit","No Benefit"],autocomplete:""},model:{value:e.formData.benefit_type,callback:function(t){e.$set(e.formData,"benefit_type",t)},expression:"formData.benefit_type"}},"v-autocomplete",e.veeValidate("benefit_type","Benefit Type *"),!1))],1),a("v-col",{attrs:{md:"4",cols:"12"}}),a("v-col",{staticClass:"py-0",attrs:{md:"2",cols:"12"}},[a("v-checkbox",{directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"py-0 my-0",attrs:{label:"Year to Date"},model:{value:e.formData.year_to_date,callback:function(t){e.$set(e.formData,"year_to_date",t)},expression:"formData.year_to_date"}})],1),a("v-col",{staticClass:"py-0",attrs:{md:"2",cols:"12"}},[a("v-checkbox",{directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"py-0 my-0",attrs:{disabled:!e.enable_daily_unit_options,label:"Deduct amount if on leave"},model:{value:e.formData.deduct_amount_on_leave,callback:function(t){e.$set(e.formData,"deduct_amount_on_leave",t)},expression:"formData.deduct_amount_on_leave"}})],1),a("v-col",{staticClass:"py-0",attrs:{md:"3",cols:"12"}},[a("v-checkbox",{directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"py-0 my-0",attrs:{disabled:!e.enable_daily_unit_options,label:"Pay amount if present in holidays/offdays"},model:{value:e.formData.pay_when_present_holiday_offday,callback:function(t){e.$set(e.formData,"pay_when_present_holiday_offday",t)},expression:"formData.pay_when_present_holiday_offday"}})],1),a("v-col",{staticClass:"py-0",attrs:{md:"3",cols:"12"}},[a("v-checkbox",{directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"py-0 my-0",attrs:{label:"Make heading visible in package basic view",add:""},model:{value:e.formData.visible_in_package_basic_view,callback:function(t){e.$set(e.formData,"visible_in_package_basic_view",t)},expression:"formData.visible_in_package_basic_view"}})],1),a("v-col",{staticClass:"py-0",attrs:{md:"2",cols:"12"}},[a("v-checkbox",{directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"py-0 my-0",attrs:{label:"Include in payroll addons"},model:{value:e.formData.include_in_payroll_addons,callback:function(t){e.$set(e.formData,"include_in_payroll_addons",t)},expression:"formData.include_in_payroll_addons"}})],1)],1):e._e(),a("v-row",[a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-checkbox",{directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],staticClass:"py-0 my-0",attrs:{disabled:!e.enable_daily_unit_options,label:"Deduct amount if remote work"},model:{value:e.formData.deduct_amount_on_remote_work,callback:function(t){e.$set(e.formData,"deduct_amount_on_remote_work",t)},expression:"formData.deduct_amount_on_remote_work"}})],1)],1)],1),a("v-divider"),a("heading-rule",{attrs:{"conditional-variables":e.conditional_variables,"function-variables":e.function_variables,"rule-variables":e.rule_variables,"heading-type":e.formData.type,"enable-tds":e.enable_tds,error:e.isValidRule,"show-title":e.showTitle,"is-editable":e.formData.is_editable,"is-create-package":""},on:{"update:error":function(t){e.isValidRule=t}},scopedSlots:e._u([{key:"editable-switch",fn:function(){return[a("v-switch",{staticClass:"px-4 mb-4",attrs:{label:"Editable","hide-details":""},model:{value:e.formData.is_editable,callback:function(t){e.$set(e.formData,"is_editable",t)},expression:"formData.is_editable"}})]},proxy:!0}]),model:{value:e.formData.rules,callback:function(t){e.$set(e.formData,"rules",t)},expression:"formData.rules"}})],1),a("v-divider"),a("v-card-actions",[a("v-col",{staticClass:"text-right"},[a("v-btn",{attrs:{text:"",outlined:"",color:"primary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),e.id?a("v-btn",{attrs:{disabled:e.errors.any()||!e.isValidRule,depressed:"",color:"primary"},on:{click:e.updatePayrollHeading}},[e._v(" Update ")]):a("v-btn",{attrs:{disabled:e.errors.any()||!e.isValidRule,depressed:"",color:"primary"},on:{click:e.createPayrollHeadings}},[a("v-icon",{attrs:{small:"",left:""}},[e._v(" mdi-content-save-outline ")]),e._v(" Save ")],1)],1)],1)],1)},n=[],o=a("2909"),r=a("1da1"),s=(a("96cf"),a("a9e3"),a("b64b"),a("99af"),a("caad"),a("2532"),a("f12b")),l=a("e860"),d=a("7f8f"),u=a("077d"),c={components:{HeadingRule:l["a"]},mixins:[s["a"]],provide:function(){return{$validator:this.$validator}},props:{nextOrder:{type:[String,Number],default:""},id:{type:[String,Number],default:""},showTitle:{type:Boolean,default:!1}},data:function(){return{assignHeading:!1,formData:{is_editable:!1,order:this.nextOrder,organization:this.$route.params.slug,deduct_amount_on_leave:!1,pay_when_present_holiday_offday:!1,deduct_amount_on_remote_work:!1},heading_type_options:[],conditional_variables:[],function_variables:[],rule_variables:[],isValidRule:!0,enable_tds:!1,enable_daily_unit_options:!1,showDetail:!0}},computed:{payrollSettingTypeList:function(){return Object.keys(u["a"])}},watch:{"formData.order":function(){this.getAvailableVariables()},"formData.type":function(e){this.getAvailableVariables(),"Type2Cnst"===e?this.clearType2CnstField():"Type1Cnst"===e&&this.clearType1CnstField(),this.enable_tds="Tax Deduction"===e&&"Salary TDS"===this.formData.payroll_setting_type},"formData.duration_unit":function(e){this.getAvailableVariables(),this.enable_daily_unit_options="Daily"===e,this.enable_daily_unit_options||(this.formData.deduct_amount_on_leave=!1,this.formData.pay_when_present_holiday_offday=!1,this.formData.deduct_amount_on_remote_work=!1)},"formData.payroll_setting_type":function(e){e&&this.updateHeadingTypeList(this.formData.payroll_setting_type)}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.id){t.next=5;break}return t.next=3,e.getPayrollHeading();case 3:t.next=6;break;case 5:e.formData.order=e.nextOrder||e.$route.params.nextOrder;case 6:case"end":return t.stop()}}),t)})))()},methods:{getAvailableVariables:function(){var e=this;if(parseInt(this.formData.order)>=0){var t={order:this.formData.order,organization__slug:this.getOrganizationSlug,current_heading_type:this.formData.type,current_duration_unit:this.formData.duration_unit};this.insertData(d["a"].getVariables+"?organization__slug=".concat(this.getOrganizationSlug,"&as=hr"),t,{validate:!1}).then((function(t){e.conditional_variables=t.conditional_variables,e.rule_variables=t.rule_variables,e.function_variables=t.functions}))}},clearType2CnstField:function(){this.formData.benefit_type="",this.formData.absent_days_impact="",this.formData.taxable="",this.formData.duration_unit=null,this.$validator.errors.clear()},clearType1CnstField:function(){this.formData.benefit_type="",this.formData.absent_days_impact="",this.formData.taxable="",this.$validator.errors.clear()},createPayrollHeadings:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.crud.message="Successfully created payroll heading.",e.insertData(d["a"].postHeading+"?organization__slug=".concat(e.getOrganizationSlug,"&as=hr"),e.formData).then((function(){e.$emit("close"),e.$refs.payrollForm.reset()})).catch((function(t){var a=e.get(t.response.data,"rules.errors"),i={response:{data:a}};e.pushIndexedErrors(i,"",!1,""),e.pushErrors(t)}));case 2:case"end":return t.stop()}}),t)})))()},getPayrollHeading:function(){var e=this;this.getData(d["a"].getHeadingById(this.id)+"?organization__slug=".concat(this.getOrganizationSlug,"&as=hr")).then((function(t){e.formData=t,"Tax Deduction"===e.formData.type&&"Salary TDS"===e.formData.payroll_setting_type&&(e.enable_tds=!0)}))},updatePayrollHeading:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.crud.heading="Successfully Updated payroll heading.",e.putData(d["a"].updateHeadingById(e.id)+"?organization__slug=".concat(e.getOrganizationSlug,"&as=hr"),e.formData).then((function(){e.$emit("close"),e.$refs.payrollForm.reset()})).catch((function(t){var a=e.get(t.response.data,"rules.errors"),i={response:{data:a}};e.pushIndexedErrors(i,"",!1,"")}));case 2:case"end":return t.stop()}}),t)})))()},updateHeadingTypeList:function(e){var t=u["a"][e];this.$set(this.$data,"heading_type_options",[].concat(Object(o["a"])(t.available_types),["Type1Cnst","Type2Cnst"]))},getDisabledStatus:function(e){return!!this.formData.type&&u["b"][this.formData.type].includes(e)}}},p=c,v=a("2877"),m=a("6544"),f=a.n(m),h=a("c6a6"),_=a("8336"),g=a("99d9"),b=a("ac7c"),y=a("62ad"),x=a("ce7e"),w=a("4bd4"),D=a("132d"),C=a("0fd9b"),k=a("b73d"),S=a("8654"),E=a("3a2f"),T=Object(v["a"])(p,i,n,!1,null,null,null);t["a"]=T.exports;f()(T,{VAutocomplete:h["a"],VBtn:_["a"],VCardActions:g["a"],VCardText:g["c"],VCheckbox:b["a"],VCol:y["a"],VDivider:x["a"],VForm:w["a"],VIcon:D["a"],VRow:C["a"],VSwitch:k["a"],VTextField:S["a"],VTooltip:E["a"]})},"9d01":function(e,t,a){},b73d:function(e,t,a){"use strict";var i=a("5530"),n=(a("0481"),a("ec29"),a("9d01"),a("fe09")),o=a("c37a"),r=a("c3f0"),s=a("0789"),l=a("490a"),d=a("80d2");t["a"]=n["a"].extend({name:"v-switch",directives:{Touch:r["a"]},props:{inset:Boolean,loading:{type:[Boolean,String],default:!1},flat:{type:Boolean,default:!1}},computed:{classes:function(){return Object(i["a"])(Object(i["a"])({},o["a"].options.computed.classes.call(this)),{},{"v-input--selection-controls v-input--switch":!0,"v-input--switch--flat":this.flat,"v-input--switch--inset":this.inset})},attrs:function(){return{"aria-checked":String(this.isActive),"aria-disabled":String(this.isDisabled),role:"switch"}},validationState:function(){return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":null!==this.hasColor?this.computedColor:void 0},switchData:function(){return this.setTextColor(this.loading?void 0:this.validationState,{class:this.themeClasses})}},methods:{genDefaultSlot:function(){return[this.genSwitch(),this.genLabel()]},genSwitch:function(){return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.genInput("checkbox",Object(i["a"])(Object(i["a"])({},this.attrs),this.attrs$)),this.genRipple(this.setTextColor(this.validationState,{directives:[{name:"touch",value:{left:this.onSwipeLeft,right:this.onSwipeRight}}]})),this.$createElement("div",Object(i["a"])({staticClass:"v-input--switch__track"},this.switchData)),this.$createElement("div",Object(i["a"])({staticClass:"v-input--switch__thumb"},this.switchData),[this.genProgress()])])},genProgress:function(){return this.$createElement(s["c"],{},[!1===this.loading?null:this.$slots.progress||this.$createElement(l["a"],{props:{color:!0===this.loading||""===this.loading?this.color||"primary":this.loading,size:16,width:2,indeterminate:!0}})])},onSwipeLeft:function(){this.isActive&&this.onChange()},onSwipeRight:function(){this.isActive||this.onChange()},onKeydown:function(e){(e.keyCode===d["y"].left&&this.isActive||e.keyCode===d["y"].right&&!this.isActive)&&this.onChange()}}})},bc3e:function(e,t,a){"use strict";a("f70a0")},c677:function(e,t,a){"use strict";a("dcb6")},dcb6:function(e,t,a){},e860:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{attrs:{flat:""}},[e.basicView?e._e():a("v-card-title",{staticClass:"px-2"},[a("span",{class:{"red--text":!e.is_valid}},[e._v(" "+e._s("Rules & Condition "+(e.is_valid?"":"(Invalid rules)"))+" ")]),e._t("editable-switch")],2),a("div",{class:{"scrollbar-lg":!e.showTitle&&!e.basicView}},[e._l(e.output_rules,(function(t,i){return a("div",{key:""+i,staticClass:"py-0 blue-grey--text",class:e.appliedClass},[e.output_rules.length>1&&!e.basicView?a("v-col",[a("equation",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],key:"cond_"+i,attrs:{valid:t.valid_condition,variables:e.conditionalVariables,functions:e.functionVariables,operators:e.condition_operators,"read-only":e.readonly,type:"Condition","error-message":e.$validator.errors.first("condition_equation_errors-"+(i+1))},on:{"update:valid":function(a){return e.$set(t,"valid_condition",a)}},model:{value:t.condition,callback:function(a){e.$set(t,"condition",a)},expression:"rule.condition"}},"equation",e.veeValidate("condition_equation_errors-"+(i+1),""),!1))],1):e._e(),a("v-col",[a("equation",e._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],key:"eq_"+i,attrs:{valid:t.valid_rule,variables:e.ruleVariables,functions:e.functionVariables,operators:e.rule_operators,"read-only":e.readonly,"is-package-heading-equation":e.isPackageHeadingEquation,"rule-validator":t.rule_validator,"heading-type":e.headingType,type:"Rule","is-editable":e.isEditable,"is-update-package":e.isUpdatePackage,"is-create-package":e.isCreatePackage,"basic-view":e.basicView,"trigger-update":e.triggerUpdate,"error-message":e.$validator.errors.first("rule_equation_errors-"+(i+1))},on:{"update:valid":function(a){return e.$set(t,"valid_rule",a)},"update:ruleValidator":function(a){return e.$set(t,"rule_validator",a)},"update:rule-validator":function(a){return e.$set(t,"rule_validator",a)},"update:triggerUpdate":function(t){e.triggerUpdate=t},"update:trigger-update":function(t){e.triggerUpdate=t},input:function(t){return e.$validator.errors.clear()}},model:{value:t.rule,callback:function(a){e.$set(t,"rule",a)},expression:"rule.rule"}},"equation",e.veeValidate("rule_equation_errors-"+(i+1),""),!1))],1),e.output_rules.length>1&&!e.basicView?a("v-btn",{staticClass:"danger--text mx-3 mt-1",attrs:{small:"",outlined:""},on:{click:function(t){return e.removeRule(i)}}},[a("v-icon",{attrs:{size:"18"}},[e._v(" mdi-trash-can-outline ")]),a("span",{domProps:{textContent:e._s("Remove")}})],1):e._e()],1)})),e.basicView?e._e():a("v-btn",{staticClass:"primary--text ml-3 my-2",attrs:{disabled:-1!==["Extra Addition","Extra Deduction"].indexOf(e.headingType),small:"",outlined:""},on:{click:e.addRule}},[a("v-icon",{attrs:{size:"18"}},[e._v(" mdi-plus-circle-outline ")]),a("span",{domProps:{textContent:e._s("Add Another rule")}})],1)],2)],1)},n=[],o=(a("a434"),a("d81d"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("label",[e.basicView?e._e():a("span",{class:{"blue--text text--darken-1":e.component_focused&&e.is_valid,"red--text":!e.is_valid}},[e._v(e._s(e.type+" "+(e.is_valid?"":"("+e.error_messages[0]+")")))])]),a("div",{staticStyle:{display:"block"}},[a("v-menu",{staticStyle:{width:"100%"},attrs:{"offset-y":"",origin:"center center",transition:"scale-transition",bottom:"","allow-overflow":"","max-height":"300"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-row",{attrs:{align:"center"}},[a("v-col",e._g({ref:"equationCard",staticClass:"pa-0 ma-0",staticStyle:{width:"100%"},attrs:{cols:e.basicView?"11":"12"},on:{click:function(t){return e.$refs.inputbox.focus()}}},i),[a("div",{ref:"inputbox",staticClass:"customInput wrap py-1 px-1",attrs:{width:200,contenteditable:e.isCreatePackage||e.isEditable&&e.isUpdatePackage||!e.readonly},on:{focus:function(t){e.component_focused=!0},blur:function(t){e.component_focused=!1},keydown:e.updateInput,keyup:[e.updateCtrl,function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.keyUpRight(t)}]}}),a("v-divider",{class:{"blue darken-1":e.component_focused}}),e.basicView?a("label",[a("span",{class:{"blue--text text--darken-1":e.component_focused&&e.is_valid,"red--text":!e.is_valid}},[e._v(e._s(e.is_valid?"":e.type+"("+e.error_messages[0]+")"))])]):e._e()],1),e.basicView?a("v-col",{staticClass:"pa-0 ma-0 text-right",attrs:{cols:"1"}},[a("v-icon",{attrs:{color:"primary",size:"18"},on:{click:e.triggerUpdate}},[e._v(" mdi-pencil ")])],1):e._e()],1)]}}]),model:{value:e.show_menu,callback:function(t){e.show_menu=t},expression:"show_menu"}},[a("v-list",[e.filteredPropItems.length>0?e._l(e.filteredPropItems,(function(t,i){return a("v-list-item",{key:i,on:{click:function(a){return e.addItem(t)}}},[a("v-list-item-title",{staticClass:"py-1"},[a("span",{staticClass:"px-1 mx-1 white--text rounded",class:e.functions.includes(t)?"green":"light-blue"},[e._v(e._s(e.functions.includes(t)?t+" (function)":t))])])],1)})):e._e(),0===e.filteredPropItems.length?[a("v-list-item",[a("v-list-item-title",[e._v("No Variables Present")])],1)]:e._e()],2)],1)],1),a("div",{staticClass:"pt-2"},[a("span",{staticClass:"danger--text"},[e._v(e._s(e.errorMessage))])]),"Rule"!==e.type||e.isPackageHeadingEquation?e._e():a("div",[a("v-row",{attrs:{"no-gutters":"",align:"center"}},[a("v-col",{attrs:{cols:"12",md:"4"}},[e.isEditable?a("v-switch",{attrs:{label:"Number Only",readonly:-1!==["Extra Addition","Extra Deduction"].indexOf(e.headingType),"hide-details":""},model:{value:e.rule_validator.numberOnly,callback:function(t){e.$set(e.rule_validator,"numberOnly",t)},expression:"rule_validator.numberOnly"}}):e._e()],1),a("v-col",{attrs:{cols:"12",md:"4"}},[e.isEditable&&e.rule_validator.numberOnly?a("v-switch",{attrs:{label:"Has Range","hide-details":""},model:{value:e.rule_validator.hasRange,callback:function(t){e.$set(e.rule_validator,"hasRange",t)},expression:"rule_validator.hasRange"}}):e._e()],1),a("v-col",{attrs:{cols:"12",md:"12"}},[e.rule_validator.hasRange&&e.rule_validator.numberOnly&&e.isEditable?a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-text-field",{staticClass:"mr-2",attrs:{type:"number",label:"Maximum Allowed","hide-details":""},model:{value:e.rule_validator.max,callback:function(t){e.$set(e.rule_validator,"max",t)},expression:"rule_validator.max"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-text-field",{staticClass:"ml-2",attrs:{type:"number",label:"Minimum Allowed","hide-details":""},model:{value:e.rule_validator.min,callback:function(t){e.$set(e.rule_validator,"min",t)},expression:"rule_validator.min"}})],1)],1):e._e()],1)],1)],1)])}),r=[],s=a("2909"),l=a("d4ec"),d=a("bee2"),u=(a("99af"),a("ac1f"),a("5319"),a("caad"),a("2532"),a("a15b"),a("4d63"),a("25f0"),a("2ca0"),a("a9e3"),a("d3b7"),function(){function e(t){Object(l["a"])(this,e),this.numberOnly=-1!==["Extra Addition","Extra Deduction"].indexOf(t),this.hasRange=!1,this.min=0,this.max=0}return Object(d["a"])(e,null,[{key:"cleanValidator",value:function(e){return this.isEditable&&e.numberOnly?e.hasRange||(delete e.min,delete e.max):(delete e.hasRange,delete e.min,delete e.max),e}}]),e}()),c={props:{variables:{type:null,default:null},functions:{type:null,default:null},operators:{type:null,default:null},type:{type:null,default:null},value:{type:String,default:""},valid:{type:null,default:null},readOnly:{type:null,default:null},ruleValidator:{type:null,default:null},isPackageHeadingEquation:{type:null,default:null},headingType:{type:null,default:null},isEditable:{type:Boolean,default:!1},isUpdatePackage:{type:Boolean,default:!1},isCreatePackage:{type:Boolean,default:!1},basicView:{type:Boolean,default:!1},errorMessage:{type:String,default:""}},data:function(){return{readonly:!!this.readOnly,component_focused:!1,prop_items:this.variables,function_items:this.functions,input:this.value?this.getStyledEq(this.value):"",is_valid:!0,rule_validator:this.ruleValidator||new u(this.headingType),is_package_heading_equation:!!this.isPackageHeadingEquation,error_messages:[],show_menu:!1,variable_search_query:null,ctrlPressed:!1}},computed:{filteredPropItems:function(){return[].concat(Object(s["a"])(this.function_items),Object(s["a"])(this.prop_items))}},watch:{input:function(){var e=this.getInputInnerText();this.is_valid=this.validateEquation(e),this.$emit("input",e),this.$emit("update:valid",this.is_valid),this.renderMath()},value:function(){this.updateInputs()},variables:function(e){this.prop_items=e,this.updateInputs()},functions:function(e){this.function_items=e,this.updateInputs()},rule_validator:{handler:function(e){this.readonly=!this.isEditable&&!!this.isPackageHeadingEquation,this.is_valid=this.validateEquation(this.getInputInnerText()),this.$emit("update:valid",this.is_valid),this.$emit("update:ruleValidator",u.cleanValidator(e))},deep:!0},ruleValidator:function(e){this.rule_validator=e||new u(this.headingType)}},created:function(){this.readonly=!this.isEditable&&!!this.isPackageHeadingEquation},mounted:function(){this.input&&(this.$refs.inputbox.innerHTML=this.input,this.validateEquation(this.value)?(this.renderMath(),this.is_valid=!0):this.is_valid=!1),this.$emit("update:ruleValidator",this.rule_validator),this.$emit("update:valid",this.is_valid)},methods:{updateInputs:function(){var e=this.$refs.inputbox.innerHTML.replace(/&nbsp;/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<"),t=this.getStyledEq(this.value);t!==e&&(this.$refs.inputbox.innerHTML=t),this.input=t},getCaretPosition:function(){var e=this.$refs.inputbox,t=window.getSelection().getRangeAt(0),a=document.createTreeWalker(e,NodeFilter.ELEMENT_NODE,(function(e){var a=document.createRange();return a.selectNodeContents(e),a.compareBoundaryPoints(Range.END_TO_END,t)<1?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),!1),i=0,n=0;3==t.startContainer.nodeType&&(i+=t.startOffset);while(a.nextNode())i+=n,n=0,t.startContainer!=a.currentNode&&(a.currentNode instanceof Text?n+=a.currentNode.length:(a.currentNode instanceof HTMLSpanElement||a.currentNode instanceof HTMLDivElement)&&(a.nextNode(),n++));return i+n},setCaretPosition:function(e){var t,a=this.$refs.inputbox;a.focus();for(var i=0,n=0;n<a.childNodes.length;n++)if(i=n,t=a.childNodes[n],t.nodeType==Node.TEXT_NODE){if(!(t.length<=e))break;e-=t.length}else if(t.nodeType==Node.ELEMENT_NODE){if(!(e>0))break;e-=1}var o=a.childNodes[i],r=document.createRange();r.setStart(o,e),r.setEnd(o,e);var s=window.getSelection();s.removeAllRanges(),s.addRange(r)},elementContainsSelection:function(e){var t;if(window.getSelection){if(t=window.getSelection(),t.rangeCount>0){for(var a=0;a<t.rangeCount;++a)if(!this.isOrContains(t.getRangeAt(a).commonAncestorContainer,e))return!1;return!0}}else if((t=document.selection)&&"Control"!=t.type)return this.isOrContains(t.createRange().parentElement(),e);return!1},pasteHtmlAtCaret:function(e){var t,a,i;if(window.getSelection)if(t=window.getSelection(),i=this.$refs.inputbox,this.elementContainsSelection(i))if(t.getRangeAt&&t.rangeCount){a=t.getRangeAt(0),a.deleteContents();var n=document.createElement("div");n.innerHTML=e;var o,r,s=document.createDocumentFragment();while(o=n.firstChild)r=s.appendChild(o);a.insertNode(s),r&&(a=a.cloneRange(),a.setStartAfter(r),a.collapse(!0),t.removeAllRanges(),t.addRange(a))}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(e);else this.setEndOfContenteditable(i),this.pasteHtmlAtCaret(e,i)},setEndOfContenteditable:function(e){var t,a;document.createRange?(t=document.createRange(),t.selectNodeContents(e),t.collapse(!1),a=window.getSelection(),a.removeAllRanges(),a.addRange(t)):document.selection&&(t=document.body.createTextRange(),t.moveToElementText(e),t.collapse(!1),t.select())},isOrContains:function(e,t){while(e){if(e===t)return!0;e=e.parentNode}return!1},addItem:function(e,t){var a=e,i=!1;if(t){var n=["/","+","-","*","(",")","=","<",">","!"];n.includes(e)&&(a='<span class="text-subtitle-1 font-weight-bold blueGrey--text rounded mx-1" contenteditable="false">'.concat(e,"</span>"))}else i=!0,a="<span contenteditable=false class='".concat(this.functions.includes(e)?"green":"light-blue"," white--text rounded px-1 mx-1'>").concat(e,"</span>");this.pasteHtmlAtCaret(a),this.validateAndSetCursor(i)},validateAndSetCursor:function(e){var t=this;this.input=this.$refs.inputbox.innerHTML;var a=0;e&&(a=this.getCaretPosition());var i=this.getInputInnerText();this.is_valid=this.validateEquation(i),this.$emit("input",i),this.$emit("update:valid",this.is_valid),e&&this.$nextTick((function(){t.setCaretPosition(a)}))},updateCtrl:function(e){var t=e.which||e.keyCode;17===t&&(this.ctrlPressed=!1)},updateInput:function(e){var t=e.which||e.keyCode;if(8===t||46===t||this.ctrlPressed&&86===t){var a=this;setTimeout((function(){a.validateAndSetCursor()}),1)}else if(17===t)this.ctrlPressed=!0;else if(t>8&&t<46||t>=112&&t<=123||[91,92,144,145].includes(t));else{if(this.ctrlPressed)return;this.addItem(e.key,!0),e.preventDefault()}},getStyledEq:function(e){var t=["/","+","-","*","(",")","=","<",">","!"],a=[].concat(Object(s["a"])(this.variables),Object(s["a"])(this.functions)),i="";i=a.length>0?"".concat(a.join("|"),"|[").concat(t.join("]|["),"]"):"[".concat(t.join("]|["),"]");var n=new RegExp(i,"g"),o={};t.forEach((function(e){o[e]='<span class="text-subtitle-1 font-weight-bold blueGrey--text rounded mx-1" contenteditable="false">'.concat(e,"</span>")}));var r=Object(s["a"])(this.variables);r.forEach((function(e){o[e]='<span class="light-blue white--text rounded px-1 mx-1" contenteditable="false">'.concat(e,"</span>")}));var l=Object(s["a"])(this.functions);return l.forEach((function(e){o[e]='<span class="green white--text rounded px-1 mx-1" contenteditable="false">'.concat(e,"</span>")})),e.replace(n,(function(e){return o[e]}))},keyUpRight:function(){var e=this.$refs.inputbox,t=getSelection(),a=t.getRangeAt(e);if(!a.commonAncestorContainer.nodeValue||a.commonAncestorContainer.nodeValue.startsWith("__")||["/","+","-","*","(",")","=","<",">","!"].includes(a.commonAncestorContainer.nodeValue)){var i=a.commonAncestorContainer.parentElement.previousSibling;if(i){var n=document.createRange();n.setStartAfter(i),n.setEndAfter(i),t.removeAllRanges(),t.addRange(n)}}},filterFloat:function(e){var t=new RegExp("^(\\-|\\+)?([0-9]+(\\.[0-9]+)?|Infinity)$","g");return t.test(e)?Number(e):NaN},getInputInnerText:function(){return this.$refs.inputbox.innerText.replace(/\s/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<")},validateEquation:function(){return!0},saveSelection:function(e){var t;if(window.getSelection&&document.createRange){var a=window.getSelection().getRangeAt(0),i=a.cloneRange();return i.selectNodeContents(e),i.setEnd(a.startContainer,a.startOffset),t=i.toString().length,{start:t,end:t+a.toString().length}}if(document.selection){var n=document.selection.createRange(),o=document.body.createTextRange();return o.moveToElementText(e),o.setEndPoint("EndToStart",n),t=o.text.length,{start:t,end:t+n.text.length}}},restoreSelection:function(e,t){if(window.getSelection&&document.createRange){var a=0,i=document.createRange();i.setStart(e,0),i.collapse(!0);var n=[e],o=!1,r=!1,s=!1;while(!s&&(o=n.pop()))if(3===o.nodeType){var l=a+o.length;!r&&t.start>=a&&t.start<=l&&(i.setStart(o,t.start-a),r=!0),r&&t.end>=a&&t.end<=l&&(i.setEnd(o,t.end-a),s=!0),a=l}else{var d=o.childNodes.length;while(d--)n.push(o.childNodes[d])}var u=window.getSelection();u.removeAllRanges(),u.addRange(i)}else if(document.selection){var c=document.body.createTextRange();c.moveToElementText(e),c.collapse(!0),c.moveEnd("character",t.end),c.moveStart("character",t.start),c.select()}},renderMath:function(){},triggerUpdate:function(){this.basicView&&this.$emit("update:trigger-update",new Date)}}},p=c,v=(a("bc3e"),a("2877")),m=a("6544"),f=a.n(m),h=a("62ad"),_=a("ce7e"),g=a("132d"),b=a("8860"),y=a("da13"),x=a("5d23"),w=a("e449"),D=a("0fd9b"),C=a("b73d"),k=a("8654"),S=Object(v["a"])(p,o,r,!1,null,null,null),E=S.exports;f()(S,{VCol:h["a"],VDivider:_["a"],VIcon:g["a"],VList:b["a"],VListItem:y["a"],VListItemTitle:x["c"],VMenu:w["a"],VRow:D["a"],VSwitch:C["a"],VTextField:k["a"]});var T=a("c44a"),V={components:{Equation:E},mixins:[T["a"]],inject:["$validator"],props:{conditionalVariables:{type:null,default:null},functionVariables:{type:null,default:null},ruleVariables:{type:null,default:null},value:{type:String,default:""},readOnly:{type:null,default:null},isPackageHeadingEquation:{type:null,default:null},headingType:{type:null,default:null},error:{type:Boolean,default:!0},showTitle:{type:Boolean,default:!1},isEditable:{type:Boolean,default:!1},isUpdatePackage:{type:Boolean,default:!1},isCreatePackage:{type:Boolean,default:!1},basicView:{type:Boolean,default:!1},appliedClass:{type:String,default:""}},data:function(){return{readonly:!!this.readOnly,rule_operators:["+","-","*","/","^","(",")"],condition_numerals:[],condition_operators:["<=",">=",">","<","and","or","not","==","!=","+","-","*","/","^","(",")"],output_rules:this.value?this.toPresentation(this.value):[{rule:"0"}],is_valid:!0,triggerUpdate:new Date}},computed:{},watch:{output_rules:{handler:function(){this.$emit("input",this.isValid()?this.toRepresentation():null),this.is_valid=this.isValid()},deep:!0},value:function(e){e&&(this.output_rules=this.toPresentation(e))},triggerUpdate:function(){this.basicView&&this.$emit("update:trigger-update",new Date)}},methods:{addRule:function(){this.$set(this.output_rules,this.output_rules.length,{condition:"",rule:""})},removeRule:function(e){this.output_rules.splice(e,1)},toPresentation:function(e){var t=JSON.parse(e);return 1===t.length?t[0].valid_rule=!0:t.map((function(e){return e.valid_rule=!0,e.valid_condition=!0,e})),t},toRepresentation:function(){var e=null;return e=1===this.output_rules.length?JSON.stringify([{rule:this.output_rules[0].rule,rule_validator:this.output_rules[0].rule_validator}]):JSON.stringify(this.output_rules.map((function(e){return{condition:e.condition,rule:e.rule,rule_validator:e.rule_validator}}))),e},isValid:function(){var e=!0;return this.output_rules.length>0?1===this.output_rules.length?this.output_rules[0].rule&&this.output_rules[0].valid_rule||(e=!1):this.output_rules.forEach((function(t){t.rule&&t.valid_rule&&t.condition&&t.valid_condition||(e=!1)})):e=!1,this.$emit("update:error",e),e&&this.$validator.errors.clear(),e}}},$=V,R=(a("c677"),a("8336")),A=a("b0af"),O=a("99d9"),N=Object(v["a"])($,i,n,!1,null,null,null);t["a"]=N.exports;f()(N,{VBtn:R["a"],VCard:A["a"],VCardTitle:O["d"],VCol:h["a"],VIcon:g["a"]})},f70a0:function(e,t,a){}}]);