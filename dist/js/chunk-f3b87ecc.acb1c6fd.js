(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f3b87ecc"],{5877:function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-card",[e("vue-card-title",{attrs:{title:t.headingName,subtitle:"-",icon:"mdi-file-document-outline",dark:"",closable:""},on:{close:function(a){return t.$emit("close")}}}),e("v-divider"),e("v-data-table",{attrs:{headers:t.headers,items:t.tableData,loading:t.loading,"sort-desc":t.pagination.descending,"sort-by":t.pagination.sortBy,page:t.pagination.page,"items-per-page":t.pagination.rowsPerPage,"footer-props":{itemsPerPageOptions:[5]},"server-items-length":t.pagination.totalItems,dense:"","must-sort":""},on:{"update:sortDesc":function(a){return t.$set(t.pagination,"descending",a)},"update:sort-desc":function(a){return t.$set(t.pagination,"descending",a)},"update:sortBy":function(a){return t.$set(t.pagination,"sortBy",a)},"update:sort-by":function(a){return t.$set(t.pagination,"sortBy",a)},"update:page":function(a){return t.$set(t.pagination,"page",a)},"update:itemsPerPage":function(a){return t.$set(t.pagination,"rowsPerPage",a)},"update:items-per-page":function(a){return t.$set(t.pagination,"rowsPerPage",a)}},scopedSlots:t._u([{key:"item",fn:function(a){return[e("tr",[e("td",{domProps:{textContent:t._s(a.item.from_date)}}),e("td",{domProps:{textContent:t._s(a.item.to_date)}}),e("td",{staticClass:"text-right",domProps:{textContent:t._s(t.formatCurrency(a.item.amount))}}),e("td"),e("td"),e("td")])]}}])},[e("template",{slot:"no-data"},[e("data-table-no-data",{attrs:{loading:t.loading}})],1)],2)],1)},o=[],r=e("5530"),i=(e("a9e3"),e("99af"),e("d3b7"),e("d81d"),e("17cc")),l=e("cf45"),s=e("a51f"),c=e("2f62"),d={components:{DataTableNoData:s["default"]},mixins:[i["a"]],props:{payslipId:{type:[Number,String],required:!0},rate:{type:Number,default:null},headingId:{type:[Number,String],required:!0},userId:{type:[Number,String],required:!0},headingName:{type:String,required:!0},as:{type:String,required:!0}},data:function(){return{tableData:[],htmlTitle:"Salary Tax | Payroll",breadCrumbItems:[{text:"Payroll",disabled:!0},{text:"Salary Tax",disabled:!0}],headers:[{text:"From Date",sortable:!1},{text:"To Date",sortable:!1}],loading:!0}},computed:Object(r["a"])({},Object(c["c"])({orgSlug:"organization/getOrganizationSlug"})),created:function(){var t;this.pagination.sortBy="from_date",(t=this.headers).push.apply(t,[{text:this.headingName,sortable:!1,align:"right",width:"20%"},{sortable:!1},{sortable:!1},{sortable:!1}])},methods:{formatCurrency:l["d"],fetchDataTable:function(){var t=this;this.loading=!0;var a="/payroll/employees/".concat(this.userId,"/payslip/").concat(this.payslipId,"/ytd/").concat(this.headingId,"/?organization_slug=").concat(this.orgSlug,"&as=").concat(this.as);this.$http.get(a,{params:this.fullParams}).then((function(a){t.loadDataTable(a),t.rate?t.tableData=a.results.map((function(a){return Object(r["a"])(Object(r["a"])({},a),{},{amount:t.rate*a.amount})})):t.tableData=a.results})).finally((function(){t.loading=!1}))}}},u=d,p=e("2877"),m=e("6544"),g=e.n(m),f=e("b0af"),h=e("8fea"),y=e("ce7e"),b=Object(p["a"])(u,n,o,!1,null,null,null);a["a"]=b.exports;g()(b,{VCard:f["a"],VDataTable:h["a"],VDivider:y["a"]})},a1b4:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-card",[e("vue-card-title",{attrs:{title:"Payslip Details",subtitle:"",icon:"mdi-file-document-outline",dark:""}},[e("template",{slot:"actions"},[e("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(a){var n=a.on,o=a.attrs;return[e("v-btn",t._g(t._b({attrs:{icon:""},on:{click:function(a){t.showExchangeRate=!t.showExchangeRate,t.clearExchange()}}},"v-btn",o,!1),n),[e("v-icon",{attrs:{small:"",color:"white"},domProps:{textContent:t._s("mdi-sync")}})],1)]}}])},[e("span",[t._v("Click to apply exchange rate")])]),e("v-icon",{attrs:{color:"white",small:""},domProps:{textContent:t._s("mdi-close")},on:{click:function(a){return t.$emit("close")}}})],1)],2),e("v-divider"),e("v-slide-y-transition",[t.showExchangeRate?e("v-row",{staticClass:"px-12 mx-12",attrs:{justify:"center"}},[e("v-col",{staticClass:"mx-6 px-6 py-0",attrs:{cols:"8"}},[e("v-row",{attrs:{align:"center",justify:"center"}},[e("v-col",{staticClass:"pr-0 py-0",attrs:{md:"3",cols:"6"}},[e("v-text-field",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{type:"number",hint:"Must be greater than 0","prepend-inner-icon":"mdi-cash"},model:{value:t.formValues.from,callback:function(a){t.$set(t.formValues,"from",a)},expression:"formValues.from"}},"v-text-field",t.veeValidate("from","From"),!1))],1),e("v-col",{staticClass:"pr-0 py-0",attrs:{md:"3",cols:"6"}},[e("v-text-field",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{hint:"Must be greater than 0",type:"number","prepend-inner-icon":"mdi-cash"},model:{value:t.formValues.to,callback:function(a){t.$set(t.formValues,"to",a)},expression:"formValues.to"}},"v-text-field",t.veeValidate("to","To"),!1))],1),e("v-col",{staticClass:"py-0",attrs:{md:"3",cols:"12"}},[e("v-btn",{staticClass:"primary py-0",attrs:{disabled:!(t.formValues.from&&t.formValues.to)||t.formValues.from<="0"||t.formValues.to<="0",small:"",depressed:""},on:{click:function(a){return t.exchangeCurrency()}}},[t._v("Exchange Rate")]),t.formValues.from&&t.formValues.to?e("v-btn",{staticClass:"py-0",attrs:{small:"",text:"",depressed:""},on:{click:function(a){return t.clearExchange()}}},[t._v("Clear")]):t._e()],1)],1)],1)],1):t._e()],1),t.showExchangeRate?e("v-divider"):t._e(),e("div",{staticClass:"scrollbar-thin",style:"height: calc(100vh - "+(t.showExchangeRate?"178px":"107px")+");"},[e("v-card-text",{staticClass:"py-2"},[e("v-row",{attrs:{justify:"center"}},[e("v-col",{staticClass:"py-0",attrs:{cols:"3"}}),e("v-col",{staticClass:"py-0",attrs:{cols:"6"}},[e(t.templateMap[t.selectedTemplate],{tag:"component",attrs:{"payroll-details":t.payrollDetails,"payroll-date":t.payrollDate,loading:t.loading,reports:t.reports,"salary-tax":t.salaryTax},on:{"display-tax":function(a){return t.displayTax(a)}}})],1),e("v-col",{staticClass:"py-0",attrs:{cols:"3"}})],1)],1)],1),e("v-divider"),e("v-card-actions",{staticClass:"primaryLight"},[e("v-col",{staticClass:"text-right pa-0 ma-0"},[t.payrollDetails.adjusted_backdated_calculations&&t.payrollDetails.adjusted_backdated_calculations.length>0?e("v-btn",{attrs:{color:"primary"},on:{click:function(a){return t.showBackDatedReport()}}},[e("v-icon",{attrs:{size:"16",left:""},domProps:{textContent:t._s("mdi-calculator-variant")}}),e("span",{domProps:{textContent:t._s("Backdated Payslip")}})],1):t._e(),e("v-btn",{attrs:{color:"primary",loading:t.loading},on:{click:function(a){return t.downloadExcelPayslip()}}},[e("v-icon",{domProps:{textContent:t._s("mdi-file-download-outline")}}),t._v(" Download excel ")],1),e("v-btn",{attrs:{color:"primary",loading:t.loading},on:{click:function(a){return t.downloadPayslip()}}},[e("v-icon",{domProps:{textContent:t._s("mdi-file-download-outline")}}),t._v(" Download pdf ")],1),"Pending"===t.payrollDetails.acknowledgement_status&&t.payrollDetails.is_confirmed&&"hrAdminView"!==t.getAppView?e("v-btn",{attrs:{color:"primary",loading:t.loading},on:{click:t.insertData}},[t._v(" Acknowledge ")]):t._e()],1)],1),t.showBackDatedCalculation?e("v-dialog",{attrs:{width:"700",persistent:"",scrollable:""},on:{keydown:function(a){if(!a.type.indexOf("key")&&t._k(a.keyCode,"esc",27,a.key,["Esc","Escape"]))return null;t.showBackDatedCalculation=!1}},model:{value:t.showBackDatedCalculation,callback:function(a){t.showBackDatedCalculation=a},expression:"showBackDatedCalculation"}},[e("v-card",[e("vue-card-title",{attrs:{title:"Backdated Calculation Payslip",subtitle:"",icon:"mdi-file-document-outline",dark:"",closable:""},on:{close:function(a){t.showBackDatedCalculation=!1}}}),e("back-dated-calculation",{attrs:{"backdated-data":t.payrollDetails.adjusted_backdated_calculations}})],1)],1):t._e(),e("v-bottom-sheet",{model:{value:t.salaryTax.display,callback:function(a){t.$set(t.salaryTax,"display",a)},expression:"salaryTax.display"}},[t.salaryTax.display?e("salary-tax",{attrs:{"payslip-id":t.payrollId,"heading-id":t.salaryTax.actionData.heading_id,"heading-name":t.salaryTax.actionData.heading,"user-id":t.userId,rate:t.rate,as:t.as},on:{close:function(a){t.salaryTax.display=!1}}}):t._e()],1)],1)},o=[],r=e("5530"),i=(e("d3b7"),e("3ca3"),e("ddb0"),e("a9e3"),e("caad"),e("2532"),e("07ac"),e("99af"),e("ac1f"),e("1276"),e("d81d"),e("2b3d"),e("2f62")),l=e("8b61"),s=e("a09e"),c=e("5877"),d=e("c05d"),u=e("d242"),p={components:{BackDatedCalculation:d["a"],SalaryTax:c["a"],TemplateOne:function(){return e.e("chunk-ec55594a").then(e.bind(null,"5b93"))},TemplateTwo:function(){return e.e("chunk-ec2dc8e2").then(e.bind(null,"b49b"))},TemplateThree:function(){return e.e("chunk-ec55387a").then(e.bind(null,"5eba"))}},mixins:[l["a"],s["a"],u["a"]],props:{payrollId:{type:[Number,String],default:""},userId:{type:[Number,String],default:""},as:{type:String,required:!0},organizationSlug:{type:String,default:""},selectedTemplate:{type:String,required:!0}},data:function(){return{headers:[{text:"Heading Name",value:"heading",align:"left",sortable:!1},{text:"Backdated value per heading",value:"previous_amount",align:"left",sortable:!1},{text:"Current value per heading",value:"current_amount",align:"left",sortable:!1},{text:"Total Increment",value:"total",align:"left",sortable:!1}],status:"Acknowledged",reports:[],salaryTax:{display:!1,actionData:{}},formValues:{from:null,to:null},payrollDetails:{},loading:!1,showExchangeRate:!1,crud:{name:"PaySlip",endpoint:{common:""}},rate:null,templateMap:{"Template 1":"TemplateOne","Template 2":"TemplateTwo","Template 3":"TemplateThree"},showBackDatedCalculation:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(i["c"])({orgSlug:"organization/getOrganizationSlug",getAppView:"common/getAppView"})),{},{payrollDate:function(){return this.$dayjs(this.payrollDetails.from_date).format("YYYY-MM-DD")+" - "+this.$dayjs(this.payrollDetails.to_date).format("YYYY-MM-DD")}}),watch:{payrollId:function(){this.fetchPayrollDetails()},formValues:{handler:function(t){(Object.values(t).includes("")||Object.values(t).includes("0"))&&(this.rate=null,this.reports=this.payrollDetails.report_rows)},deep:!0}},created:function(){this.fetchPayrollDetails(),this.crud.endpoint.common="/payroll/employees/".concat(this.getAuthStateUserId,"/payslip/").concat(this.payrollId,"/acknowledge/?as=").concat(this.as)},methods:{fetchPayrollDetails:function(){var t=this;this.loading||(this.loading=!0,this.$http.get("/payroll/employees/".concat(this.userId,"/payslip/").concat(this.payrollId,"/?organization_slug=").concat(this.getOrganizationSlug,"&as=").concat(this.as)).then((function(a){t.payrollDetails=a,t.reports=t.payrollDetails.report_rows})).finally((function(){t.loading=!1})))},clearExchange:function(){this.formValues={from:"",to:""}},downloadPayslip:function(){var t=this.get(this.payrollDetails.employee,"full_name"),a=this.payrollDetails.from_date+"--"+this.payrollDetails.to_date,e="".concat(t.split(" ")[0],"-").concat(a,"-payslip");this.downloadPdf(document.getElementById("payslipPrint"),"p",e,80,900,1050)},exchangeCurrency:function(){var t=this;this.rate=Number(this.formValues.to/this.formValues.from),this.reports=this.payrollDetails.report_rows.map((function(a){return Object(r["a"])(Object(r["a"])({},a),{},{amount:t.rate*a.amount,package_amount:t.rate*a.package_amount,year_to_date:t.rate*a.year_to_date})}))},getFormValues:function(){var t={acknowledgement_status:this.status};return this.crud.message="Successfully Acknowledge this payroll.",t},processAfterInsert:function(){this.fetchPayrollDetails(),this.status="Acknowledged",this.$validator.errors.clear()},getPayrollDate:function(t,a){return this.$dayjs(t).format("YYYY MMM D")+" - "+this.$dayjs(a).format("YYYY MMM D")},displayTax:function(t){this.salaryTax.display=!0,this.salaryTax.actionData=t},showBackDatedReport:function(){this.showBackDatedCalculation=!0},downloadExcelPayslip:function(){var t="/payroll/employees/".concat(this.userId,"/payslip/").concat(this.payrollId,"/payslip-excel/?organization_slug=").concat(this.organizationSlug,"&as=").concat(this.as);this.$http({url:t,method:"GET",responseType:"blob"}).then((function(t){var a=window.URL.createObjectURL(new Blob([t])),e=document.createElement("a");e.href=a,e.setAttribute("download","payslip.xlsx"),document.body.appendChild(e),e.click()}))}}},m=p,g=e("2877"),f=e("6544"),h=e.n(f),y=e("288c"),b=e("8336"),v=e("b0af"),_=e("99d9"),x=e("62ad"),k=e("169a"),D=e("ce7e"),w=e("132d"),C=e("0fd9b"),P=e("0789"),T=e("8654"),V=e("3a2f"),S=Object(g["a"])(m,n,o,!1,null,null,null);a["default"]=S.exports;h()(S,{VBottomSheet:y["a"],VBtn:b["a"],VCard:v["a"],VCardActions:_["a"],VCardText:_["c"],VCol:x["a"],VDialog:k["a"],VDivider:D["a"],VIcon:w["a"],VRow:C["a"],VSlideYTransition:P["g"],VTextField:T["a"],VTooltip:V["a"]})},b471:function(t,a,e){"use strict";e("99af");a["a"]={linkPackage:"/payroll/user-experience-package/",updatePackage:function(t){return"/payroll/user-experience-package/".concat(t,"/")},deletePackage:function(t){return"/payroll/user-experience-package/".concat(t,"/")},bulkAssign:"/payroll/user-experience-package/create_in_bulk/",getBackdatedCalculationReport:function(t,a){return"/payroll/".concat(t,"/reports/backdated-calculations/").concat(a)}}},c05d:function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"scrollbar-md"},[0!==t.backdatedData.length?e("v-data-table",{attrs:{headers:t.headers,items:t.backdatedData,"mobile-breakpoint":0,"items-per-page":t.backdatedData.length,"must-sort":"","hide-default-footer":""},scopedSlots:t._u([{key:"item",fn:function(a){return[e("tr",[e("td",[t._v(" "+t._s(a.item.heading)+" ")]),e("td",[t._v(" "+t._s(t.formatCurrency(a.item.previous_amount)||"-")+" ")]),e("td",[t._v(" "+t._s(t.formatCurrency(a.item.current_amount)||"-")+" ")]),e("td",[t._v(" "+t._s(t.formatCurrency(a.item.current_amount-a.item.previous_amount)||"-")+" ")])])]}}],null,!1,2019143977)},[e("template",{slot:"no-data"},[e("data-table-no-data",{attrs:{loading:t.loading}})],1)],2):e("v-data-table",{attrs:{headers:t.headers,items:t.fetchedResults,"sort-desc":t.pagination.descending,"sort-by":t.pagination.sortBy,page:t.pagination.page,"items-per-page":t.pagination.rowsPerPage,"footer-props":t.footerProps,"server-items-length":t.pagination.totalItems,"mobile-breakpoint":0,"must-sort":""},on:{"update:sortDesc":function(a){return t.$set(t.pagination,"descending",a)},"update:sort-desc":function(a){return t.$set(t.pagination,"descending",a)},"update:sortBy":function(a){return t.$set(t.pagination,"sortBy",a)},"update:sort-by":function(a){return t.$set(t.pagination,"sortBy",a)},"update:page":function(a){return t.$set(t.pagination,"page",a)},"update:itemsPerPage":function(a){return t.$set(t.pagination,"rowsPerPage",a)},"update:items-per-page":function(a){return t.$set(t.pagination,"rowsPerPage",a)}},scopedSlots:t._u([{key:"item",fn:function(a){return[e("tr",[e("td",[t._v(" "+t._s(a.item.heading)+" ")]),e("td",[t._v(" "+t._s(t.formatCurrency(a.item.previous_amount)||"-")+" ")]),e("td",[t._v(" "+t._s(t.formatCurrency(a.item.current_amount)||"-")+" ")]),e("td",[t._v(" "+t._s(t.formatCurrency(a.item.current_amount-a.item.previous_amount)||"-")+" ")])])]}}])},[e("template",{slot:"no-data"},[e("data-table-no-data",{attrs:{loading:t.loading}})],1)],2)],1)},o=[],r=e("1da1"),i=(e("96cf"),e("a9e3"),e("d3b7"),e("17cc")),l=e("a51f"),s=e("b471"),c=e("cf45"),d={components:{DataTableNoData:l["default"]},mixins:[i["a"]],props:{selectedPackageId:{type:[String,Number],default:null},backdatedData:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,headers:[{text:"Heading Name",value:"heading",align:"left",sortable:!1},{text:"Backdated value per heading",value:"previous_amount",align:"left",sortable:!1},{text:"Current value per heading",value:"current_amount",align:"left",sortable:!1},{text:"Total Increment",value:"total",align:"left",sortable:!1}]}},created:function(){0===this.backdatedData.length&&this.loadDataTableChange()},methods:{formatCurrency:c["d"],fetchDataTable:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.loading=!0,t.$http.get(s["a"].getBackdatedCalculationReport(t.getOrganizationSlug,t.selectedPackageId),{params:t.fullParams}).then((function(a){t.loadDataTable(a)})).finally((function(){t.loading=!1}));case 2:case"end":return a.stop()}}),a)})))()}}},u=d,p=e("2877"),m=e("6544"),g=e.n(m),f=e("8fea"),h=Object(p["a"])(u,n,o,!1,null,null,null);a["a"]=h.exports;g()(h,{VDataTable:f["a"]})}}]);