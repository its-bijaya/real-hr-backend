(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24522146","chunk-435b29cb","chunk-da62e0c8","chunk-2d22d378"],{"19e1":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{staticClass:"overflow-y-hidden",on:{submit:function(e){return e.preventDefault(),t.getFormAction.apply(null,arguments)}}},[n("v-card",[t.showTitle?n("vue-card-title",{attrs:{title:t.formAction+" Letter / Email Template",subtitle:"",icon:"mdi-file-document-outline",closable:""},on:{close:function(e){return t.$emit("close")}}}):t._e(),n("v-divider"),n("v-card-text",{staticClass:"scrollbar-md"},[t.nonFieldErrors?n("non-field-form-errors",{attrs:{"non-field-errors":t.nonFieldErrors}}):t._e(),t.viewMode?n("v-row",{staticClass:"ma-3"},[n("v-col",{attrs:{md:"6",cols:"12"}},[n("div",{staticClass:"text-subtitle-2 blueGrey--text"},[n("v-icon",{attrs:{size:"18",color:"blueGrey"},domProps:{textContent:t._s("mdi-file-document-outline")}}),t._v(" Name ")],1),n("div",{staticClass:"pl-5",domProps:{textContent:t._s(t.formValues.name)}})]),n("v-col",{attrs:{md:"6",cols:"12"}},[n("div",{staticClass:"blueGrey--text"},[n("v-icon",{attrs:{size:"18",color:"blueGrey"},domProps:{textContent:t._s("mdi-calendar-check-outline")}}),t._v(" Type ")],1),n("div",{staticClass:"pl-5",domProps:{textContent:t._s(t.hintChoices.find((function(e){return e.value===t.formValues.type})).text)}})]),n("v-col",{attrs:{md:"12",cols:"12"}},[n("v-icon",{attrs:{size:"18",color:"blueGrey"},domProps:{textContent:t._s("mdi-help-circle-outline")}}),n("span",{staticClass:"mx-1 blueGrey--text",domProps:{textContent:t._s("Hints")}})],1),t._l(Object.keys(t.hintsList),(function(e,i){return n("v-col",{key:i,staticClass:"px-2 py-1",attrs:{md:"2",cols:"6"},on:{click:function(e){t.appendHints(Object.keys(t.hintsList)[i])}}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var a=i.on;return[n("v-btn",t._g({staticClass:"blueGrey white--text",attrs:{small:"",block:""}},a),[t._v(" "+t._s(e)+" ")])]}}],null,!0)},[n("span",[t._v(" "+t._s(Object.values(t.hintsList)[i])+" ")])])],1)})),n("v-col",{attrs:{md:"12"}},[n("div",{staticClass:"my-2 blueGrey--text"},[n("v-icon",{attrs:{size:"18",color:"blueGrey"},domProps:{textContent:t._s("mdi-email-outline")}}),t._v(" Message ")],1),t.viewMode?n("div",{staticClass:"pl-5",domProps:{innerHTML:t._s(t.highlightText)}}):t._e()])],2):n("v-row",{staticClass:"ma-3"},[n("v-col",{staticClass:"px-1",attrs:{md:"6"}},[n("v-text-field",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{readonly:t.viewMode,counter:"150","prepend-inner-icon":"mdi-file-document-outline"},model:{value:t.formValues.name,callback:function(e){t.$set(t.formValues,"name",e)},expression:"formValues.name"}},"v-text-field",t.veeValidate("name","Name *"),!1)),n("div",{staticClass:"mt-2"},[n("v-icon",{attrs:{size:"18"},domProps:{textContent:t._s("mdi-email-outline")}}),t._v(" Message ")],1),n("vue-trumbowyg",t._b({directives:[{name:"validate",rawName:"v-validate",value:"",expression:"''"}],ref:"trumbowyg",attrs:{id:"trumbowyg",placeholder:"Write a message for template."},model:{value:t.formValues.content,callback:function(e){t.$set(t.formValues,"content",e)},expression:"formValues.content"}},"vue-trumbowyg",t.veeValidate("content","Message *"),!1))],1),n("v-col",{attrs:{md:"6"}},[n("v-select",t._b({directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:t.hintChoices,"prepend-icon":"mdi-calendar-check-outline"},model:{value:t.formValues.type,callback:function(e){t.$set(t.formValues,"type",e)},expression:"formValues.type"}},"v-select",t.veeValidate("type","Type"),!1)),n("div",{staticClass:"mt-1"},[n("v-icon",{attrs:{size:"18"},domProps:{textContent:t._s("mdi-help-circle-outline")}}),n("span",{staticClass:"mx-1",domProps:{textContent:t._s("Hints")}}),t.hintsList?n("v-row",{staticClass:"pl-5 pt-2"},t._l(Object.keys(t.hintsList),(function(e,i){return n("v-col",{key:i,staticClass:"px-1",attrs:{cols:"4"},on:{click:function(e){t.appendHints(Object.keys(t.hintsList)[i])}}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(i){var a=i.on;return[n("v-btn",t._g({staticClass:"blueGrey white--text",attrs:{small:"",block:""}},a),[t._v(" "+t._s(e)+" ")])]}}],null,!0)},[n("span",[t._v(" "+t._s(Object.values(t.hintsList)[i])+" ")])])],1)})),1):t._e()],1)],1)],1)],1),n("v-divider"),t.viewMode?t._e():n("v-card-actions",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"text-right"},[n("v-btn",{attrs:{outlined:"",color:"primary"},on:{click:t.clearForm}},[t._v(" Clear ")]),n("v-btn",{attrs:{color:"primary",depressed:"",type:"submit"}},[n("v-icon",{staticClass:"mr-1",attrs:{size:"14"}},[t._v(" mdi-content-save-outline ")]),t._v(" Save ")],1)],1)],1)],1)],1)],1)},a=[],r=n("ade3"),o=n("1da1"),s=(n("96cf"),n("ac1f"),n("5319"),n("4d63"),n("25f0"),n("caad"),n("b0c0"),n("f12b")),c=n("1467"),l=n("38ef"),u=n("50e3"),d=n("23fe"),m={components:{VueTrumbowyg:c["default"]},mixins:[s["a"]],props:{actionData:{type:Object,required:!0},viewMode:{type:Boolean,default:!1},hintChoices:{type:Array,required:!0},templateType:{type:String,required:!0,validator:function(t){return-1!==["email","letter","pre-employment","recruitment"].indexOf(t)}},showTitle:{type:Boolean,default:!1}},data:function(){return{formAction:"Create",formValues:{},hintsList:{},createApi:"",updateApi:"",hintApi:"",hintParams:""}},computed:{highlightText:function(){var t=this.$sanitize(this.formValues.message||this.formValues.content||"");return t.replace(new RegExp("{{.*?}}","gi"),(function(t){return t.replace("{{","").replace("}}",""),"<span class='blueGrey white--text px-1 mx-1' style='border-radius: 4px;'><span style='text-indent: 0;'>"+t.replace("{{","").replace("}}","")+"</span></span>"}))}},watch:{"formValues.type":function(){this.formValues.type&&this.getHints()}},created:function(){this.initializeFormValues(),this.initializeApi(),this.actionData.slug&&(this.formAction="Update",this.getHints()),this.viewMode&&(this.formAction="View")},methods:{initializeApi:function(){"email"===this.templateType?(this.createApi=l["a"].postTemplate,this.updateApi=l["a"].updateTemplate(this.actionData.slug),this.hintApi=l["a"].getTemplateHints,this.hintParams="type"):"letter"===this.templateType?(this.createApi=u["a"].postLetterTemplate(this.getOrganizationSlug),this.updateApi=u["a"].updateLetterTemplate(this.getOrganizationSlug,this.actionData.slug),this.hintApi=u["a"].getHints(this.getOrganizationSlug),this.hintParams="letter_type"):"recruitment"===this.templateType&&(this.createApi=d["a"].postLetterTemplate+"?organization=".concat(this.getOrganizationSlug,"&as=hr"),this.updateApi=d["a"].updateLetterTemplate(this.actionData.slug)+"?organization=".concat(this.getOrganizationSlug,"&as=hr"),this.hintApi=d["a"].getHints+"?organization=".concat(this.getOrganizationSlug,"&as=hr"),this.hintParams="template_type")},initializeFormValues:function(){this.formValues=this.deepCopy(this.actionData),["letter","recruitment"].includes(this.templateType)&&(this.formValues.name=this.actionData.title,this.formValues.content=this.actionData.message,delete this.formValues.title,delete this.formValues.message)},cancelForm:function(){this.viewMode=!1,this.$emit("dismiss-form")},appendHints:function(t){this.viewMode||this.insertTextAtCursor(t)},getFormAction:function(){var t=this.deepCopy(this.formValues);return["letter","recruitment"].includes(this.templateType)&&(t.title=this.formValues.name,t.message=this.formValues.content,delete t.name,delete t.content),this.formValues.slug?this.updateSMSTemplate(t):this.createSMSTemplate(t)},createSMSTemplate:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.crud.message="Successfully created Template",e.insertData(e.createApi,t).then((function(t){e.$emit("dismiss-form",t,"template_letter"),e.$emit("dismissForm")}));case 2:case"end":return n.stop()}}),n)})))()},updateSMSTemplate:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.validateAllFields(),e.crud.message="Successfully updated Email Template.",e.putData(e.updateApi,t).then((function(){e.$emit("dismissForm")}));case 3:case"end":return n.stop()}}),n)})))()},clearForm:function(){this.$validator.errors.clear(),this.clearNonFieldErrors(),this.formValues={},this.hintsList=[]},getHints:function(){var t=this;this.getData(this.hintApi,Object(r["a"])({},this.hintParams,this.formValues.type)).then((function(e){t.hintsList=e}))},insertTextAtCursor:function(t){var e,n,i;if(window.getSelection){if(e=window.getSelection(),!e.anchorNode.isContentEditable&&!e.anchorNode.parentNode.isContentEditable)return void this.notifyUser("Please place the cursor at desired location in text editor.","red");this.notifyUser("","",!1),e.getRangeAt&&e.rangeCount&&(n=e.getRangeAt(0),n.deleteContents(),i=document.createTextNode(t),n.insertNode(i))}"trumbowyg-editor"===i.parentNode.className?this.formValues.content=i.parentNode.innerHTML:this.formValues.content=i.parentNode.parentNode.innerHTML}}},p=m,h=(n("dc4d"),n("2877")),f=n("6544"),v=n.n(f),g=n("8336"),y=n("b0af"),b=n("99d9"),w=n("62ad"),x=n("ce7e"),V=n("4bd4"),C=n("132d"),_=n("0fd9b"),T=n("b974"),A=n("8654"),F=n("3a2f"),L=Object(h["a"])(p,i,a,!1,null,"7544d6a6",null);e["default"]=L.exports;v()(L,{VBtn:g["a"],VCard:y["a"],VCardActions:b["a"],VCardText:b["c"],VCol:w["a"],VDivider:x["a"],VForm:V["a"],VIcon:C["a"],VRow:_["a"],VSelect:T["a"],VTextField:A["a"],VTooltip:F["a"]})},"50e3":function(t,e,n){"use strict";n("99af");e["a"]={getLetterTemplate:function(t){return"/hris/".concat(t,"/employment/letter-template/")},postLetterTemplate:function(t){return"/hris/".concat(t,"/employment/letter-template/")},updateLetterTemplate:function(t,e){return"/hris/".concat(t,"/employment/letter-template/").concat(e,"/")},deleteLetterTemplate:function(t,e){return"/hris/".concat(t,"/employment/letter-template/").concat(e,"/")},downloadLetter:function(t,e){return"/hris/".concat(t,"/employment/letters/").concat(e,"/download/")},getLetter:function(t){return"/hris/".concat(t,"/employment/letters/")},postLetter:function(t){return"/hris/".concat(t,"/employment/letters/")},putLetter:function(t,e){return"/hris/".concat(t,"/employment/letters/").concat(e,"/")},deleteLetter:function(t,e){return"/hris/".concat(t,"/employment/letters/").concat(e,"/")},sendLetter:function(t,e){return"/hris/".concat(t,"/employment/letters/").concat(e,"/send/")},saveLetter:function(t,e){return"/hris/".concat(t,"/employment/letters/").concat(e,"/save/")},getHints:function(t){return"/hris/".concat(t,"/employment/letter-template/hints/")}}},6447:function(t,e,n){},"6c6f":function(t,e,n){"use strict";n("d3b7");e["a"]={data:function(){return{deleteNotification:{dialog:!1,heading:"Confirm Delete",text:"Are you sure you want to delete ?"}}},methods:{deleteData:function(t,e){var n=this;return new Promise((function(i,a){!n.loading&&t&&(n.loading=!0,n.$http.delete(t,e||{}).then((function(t){n.crud.message&&setTimeout((function(){n.notifyUser(n.crud.message)}),1e3),i(t),n.loading=!1})).catch((function(t){n.pushErrors(t),n.notifyInvalidFormResponse(),a(t),n.loading=!1})).finally((function(){n.deleteNotification.dialog=!1})))}))}}}},"983c":function(t,e,n){"use strict";n("d3b7");e["a"]={methods:{getData:function(t,e,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(r,o){!i.loading&&t&&(i.clearNonFieldErrors(),i.$validator.errors.clear(),i.loading=a,i.$http.get(t,n||{params:e||{}}).then((function(t){r(t),i.loading=!1})).catch((function(t){i.pushErrors(t),i.notifyInvalidFormResponse(),o(t),i.loading=!1})))}))},getBlockingData:function(t,e,n){var i=this;return new Promise((function(a,r){i.getData(t,e,n,!0).then((function(t){a(t)})).catch((function(t){r(t)}))}))}}}},dc4d:function(t,e,n){"use strict";n("6447")},f0d5:function(t,e,n){"use strict";n("d3b7"),n("3ca3"),n("ddb0");var i=n("c44a");e["a"]={components:{NonFieldFormErrors:function(){return n.e("chunk-6441e173").then(n.bind(null,"ab8a"))}},mixins:[i["a"]],data:function(){return{crud:{name:"record",message:"",addAnother:!1},formValues:{},loading:!1}}}},f12b:function(t,e,n){"use strict";var i=n("f0d5"),a=n("983c"),r=n("f70a"),o=n("6c6f");e["a"]={mixins:[i["a"],a["a"],r["a"],o["a"]]}},f70a:function(t,e,n){"use strict";n("d3b7"),n("caad");e["a"]={methods:{insertData:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.validate,r=void 0===a||a,o=i.clearForm,s=void 0===o||o,c=arguments.length>3?arguments[3]:void 0;return new Promise((function(i,a){!n.loading&&t&&(n.clearErrors(),n.$validator.validateAll().then((function(o){r||(o=!0),o&&(n.loading=!0,n.$http.post(t,e,c||{}).then((function(t){n.clearErrors(),s&&(n.formValues={}),n.crud.addAnother||n.$emit("create"),n.crud.message&&setTimeout((function(){n.notifyUser(n.crud.message)}),1e3),i(t),n.loading=!1})).catch((function(t){n.pushErrors(t),n.notifyInvalidFormResponse(),a(t),n.loading=!1})))})))}))},patchData:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.validate,r=void 0===a||a,o=i.clearForm,s=void 0===o||o,c=arguments.length>3?arguments[3]:void 0;return new Promise((function(i,a){n.updateData(t,e,{validate:r,clearForm:s},"patch",c).then((function(t){i(t)})).catch((function(t){a(t)}))}))},putData:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.validate,r=void 0===a||a,o=i.clearForm,s=void 0===o||o,c=arguments.length>3?arguments[3]:void 0;return new Promise((function(i,a){n.updateData(t,e,{validate:r,clearForm:s},"put",c).then((function(t){i(t)})).catch((function(t){a(t)}))}))},updateData:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.validate,r=void 0===a||a,o=i.clearForm,s=void 0===o||o,c=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;return new Promise((function(i,a){!n.loading&&t&&["put","patch"].includes(c)&&(n.clearErrors(),n.$validator.validateAll().then((function(o){r||(o=!0),o&&(n.loading=!0,n.$http[c](t,e,l||{}).then((function(t){n.$emit("update"),n.clearErrors(),s&&(n.formValues={}),n.crud.message&&setTimeout((function(){n.notifyUser(n.crud.message)}),1e3),i(t),n.loading=!1})).catch((function(t){n.pushErrors(t),n.notifyInvalidFormResponse(),a(t),n.loading=!1})))})))}))},clearErrors:function(){this.clearNonFieldErrors(),this.$validator.errors.clear()}}}}}]);