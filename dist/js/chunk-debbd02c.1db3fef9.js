(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-debbd02c","chunk-63c80d7a"],{1840:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("vue-card-title",{attrs:{title:(e.editForm?"Edit ":"")+" "+e.mapPAType[e.appraisalType]+" Form of Employee",subtitle:(e.editForm?"Edit ":"")+" "+e.mapPAType[e.appraisalType]+" Form of Employee",icon:e.editForm?"mdi-pencil-outline":"mdi-file-document-outline",closable:""},on:{close:function(t){return e.$emit("close")}}}),a("v-divider"),a("v-card-text",{staticClass:"scrollbar-lg"},[e.nonFieldErrors?a("non-field-form-errors",{attrs:{"non-field-errors":e.nonFieldErrors}}):e._e(),a("v-container",{staticClass:"px-6"},[e.appraiseeFormDetail?a("v-row",{ref:"appraisal_form",attrs:{dense:""}},[e.editForm?e._e():[a("v-col",{attrs:{md:"5",cols:"12"}},[a("div",{staticClass:"py-2"},[a("span",[e._v("Appraisee")])]),a("vue-user",{attrs:{user:e.selectedAppraisee}})],1),a("v-col",{attrs:{md:"5",cols:"12"}},[a("div",{staticClass:"py-2"},[a("span",[e._v("Appraiser")])]),a("vue-user",{attrs:{user:e.selectedAppraiser}})],1),a("v-col",{attrs:{md:"2",cols:"12"}},[a("div",{staticClass:"py-2"},[a("span",[e._v("Score")])]),a("span",{staticClass:"text-h4 blueGrey--text font-weight-bold"},[e._v(" "+e._s(e.final_score)+" ")])]),a("v-col",{staticClass:"pa-2 very-light-blue",attrs:{md:"12",cols:"12"}},[a("span",{domProps:{innerHTML:e._s(e.$sanitize(e.get(e.appraiseeFormDetail.question_set,"description")))}})])],e.editForm?a("v-text-field",e._b({directives:[{name:"validate",rawName:"v-validate",value:"required|max:255",expression:"'required|max:255'"}],attrs:{counter:"255"},model:{value:e.appraiseeFormDetail.question_set.title,callback:function(t){e.$set(e.appraiseeFormDetail.question_set,"title",t)},expression:"appraiseeFormDetail.question_set.title"}},"v-text-field",e.veeValidate("title","Set Name *"),!1)):e._e(),a("v-col",{attrs:{cols:"12"}},[a("questions-list",{attrs:{"score-and-scale-data":e.scoreAndScaleData,"question-details":e.listOfQuestions,"updated-list":e.updatedQuestions,"read-only":e.readOnly,"half-score":!1,"edit-question":e.editForm,"from-pa-form":""},on:{"update:updatedList":function(t){e.updatedQuestions=t},"update:updated-list":function(t){e.updatedQuestions=t},"total-score":function(t){e.totalScore=t},"given-score":function(t){e.givenScore=t},percentage:function(t){e.percentage=t}}})],1),"hr"===e.as&&"received"===e.appraiseeFormDetail.status&&e.enableApproveResendBtn||e.appraiseeFormDetail.reason?a("v-col",{attrs:{cols:"12"}},[a("span",{staticClass:"py-0 font-weight-bold text-body-2 blue-grey--text mb-1"},[e._v(" Reasons for resend ")]),"received"===e.appraiseeFormDetail.status&&"hr"===e.as?a("v-textarea",e._b({directives:[{name:"validate",rawName:"v-validate",value:e.resendForm?"required|max:600":"",expression:"resendForm ? 'required|max:600' : ''"}],staticClass:"mt-4 pt-0",attrs:{counter:"600",flat:"",dense:"",rows:"2"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}},"v-textarea",e.veeValidate("reason","Reason *"),!1)):e._e(),a("div",{staticClass:"mt-2"},[null!==e.appraiseeFormDetail.reason?a("span",[e._v(e._s(e.appraiseeFormDetail.reason))]):e._e()])],1):e._e()],2):e.loading?a("default-svg-loader"):e._e()],1)],1),a("v-divider"),e.appraiseeFormDetail?a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{depressed:"",small:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),e.editForm?a("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(t){return e.updateQuestion()}}},[e._v(" Save ")]):["hr"===e.as&&!e.fromReports&&e.appraiseeFormDetail.can_download_form_by_hr?a("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(t){return e.downloadWordFile()}}},[e._v(" Download ")]):e._e(),"hr"===e.as&&"received"===e.appraiseeFormDetail.status&&e.enableApproveResendBtn?a("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(t){e.saveOnly=!1,e.approvePA()}}},[e._v(" Approve ")]):e._e(),"hr"===e.as&&"received"===e.appraiseeFormDetail.status&&e.enableApproveResendBtn?a("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(t){return e.resendPA()}}},[e._v(" Resend ")]):e._e(),"appraiser"===e.as&&["sent","saved"].includes(e.appraiseeFormDetail.status)||"hr"===e.as&&!e.readOnly?a("v-btn",{attrs:{outlined:"",small:"",color:"primary"},on:{click:function(t){e.saveOnly=!0,e.resendForm=!1,e.saveAndSendAppraisalForm()}}},[e._v(" Save ")]):e._e(),"appraiser"===e.as&&["saved","sent"].includes(e.appraiseeFormDetail.status)||"hr"===e.as&&!e.readOnly?a("v-btn",{attrs:{color:"primary",small:""},on:{click:function(t){e.saveOnly=!1,e.resendForm=!1,e.saveAndSendAppraisalForm()}}},[e._v(" Send ")]):e._e()]],2):e._e()],1)},r=[],s=(a("d3b7"),a("3ca3"),a("ddb0"),a("a9e3"),a("4de4"),a("159b"),a("99af"),a("caad"),a("7db0"),a("2532"),a("f12b")),i=a("d242"),o=a("931c"),c=a("a1b8"),l={components:{DefaultSvgLoader:function(){return a.e("chunk-2d2160c2").then(a.bind(null,"c197"))},QuestionsList:function(){return a.e("chunk-0af1276e").then(a.bind(null,"fb6e"))},VueUser:function(){return Promise.resolve().then(a.bind(null,"02cb"))},NonFieldFormErrors:function(){return a.e("chunk-6441e173").then(a.bind(null,"ab8a"))}},mixins:[s["a"],i["a"]],props:{enableApproveResendBtn:{type:Boolean,default:!0},appraisalType:{type:String,default:""},selectedAppraisee:{type:Object,required:!0},selectedAppraiser:{type:Object,required:!0},appraiserAppraiseeId:{type:[String,Number],default:""},readOnly:{type:Boolean,default:!1},editForm:{type:Boolean,default:!1},as:{type:String,default:"hr"},fromReports:{type:Boolean,default:!1}},data:function(){return{reason:"",mapPAType:{self_appraisal:"Self Appraisal",supervisor_appraisal:"Supervisor Appraisal",subordinate_appraisal:"Subordinate Appraisal",peer_to_peer_feedback:"Peer To Peer Feedback"},saveOnly:!1,resendForm:!1,totalScore:null,givenScore:null,percentage:null,updatedQuestions:{},scoreAndScaleData:[],appraiseeFormDetail:null}},computed:{listOfQuestions:function(){var e=this.deepCopy(this.appraiseeFormDetail.question_set);return this.editForm&&(e.sections=e.sections.filter((function(e){return"Generic Question Set"===e.title}))),e},final_score:function(){var e=0;return this.updatedQuestions.sections&&this.updatedQuestions.sections.forEach((function(t){t.questions.forEach((function(t){e+=t.question.score}))})),e}},created:function(){var e=this,t=this.selectedAppraiser.id,a=this.selectedAppraisee.id;this.getData(o["a"].getAppraiseeFormDetailForAppraiser(this.getOrganizationSlug,this.$route.params.id,a,t)+"?appraisal_type=".concat(this.appraisalType,"&as=").concat(this.as)).then((function(t){e.appraiseeFormDetail=t})),this.getScaleAndScoreData()},methods:{getScaleAndScoreData:function(){var e=this;this.getData(c["a"].getScoreAndScaling(this.getOrganizationSlug,this.$route.params.id)).then((function(t){e.scoreAndScaleData=t.results}))},downloadWordFile:function(){var e=this.selectedAppraiser.id,t=this.selectedAppraisee.id,a="/api/v1/appraisal/".concat(this.getOrganizationSlug,"/year/slot/").concat(this.$route.params.id,"/appraisee/").concat(t,"/appraiser/").concat(e,"/question-set/printable-export/?appraisal_type=").concat(this.appraisalType,"&as=hr");window.open(a,"_blank")},saveAndSendAppraisalForm:function(){var e=this;this.saveOnly?this.crud.message="Successfully saved PA response.":this.crud.message="Successfully submitted PA Form.",this.insertData(o["a"].postAppraisedForm(this.getOrganizationSlug,this.$route.params.id,this.selectedAppraiser.id,this.selectedAppraisee.id)+"?appraisal_type=".concat(this.appraisalType,"&as=").concat(this.as,"&draft=").concat(this.saveOnly?"True":"False"),{question_set:this.updatedQuestions,answer_committed:!this.saveOnly}).then((function(){e.saveOnly||e.$emit("refresh")}))},approvePA:function(){var e=this;this.resendForm=!1,this.$nextTick((function(){e.crud.message="Successfully approved the form.",e.insertData(o["a"].approveAppraisedForm(e.getOrganizationSlug,e.$route.params.id,e.selectedAppraisee.id,e.selectedAppraiser.id)+"?appraisal_type=".concat(e.appraisalType,"&as=").concat(e.as)).then((function(){e.$emit("refresh")}))}))},resendPA:function(){var e=this;this.saveOnly=!1,this.resendForm=!0,this.$nextTick((function(){e.crud.message="Successfully resend the form.",e.insertData(o["a"].resendAppraisedForm(e.getOrganizationSlug,e.$route.params.id,e.selectedAppraisee.id,e.selectedAppraiser.id)+"?appraisal_type=".concat(e.appraisalType,"&as=").concat(e.as),{reason:e.reason}).then((function(){e.$emit("refresh")}))}))},updateQuestion:function(){var e=this;this.crud.message="Successfully updated the questions.";var t=this.deepCopy(this.appraiseeFormDetail.question_set),a=[],n=[],r=[],s=[];this.listOfQuestions.sections[0].questions.forEach((function(e){a.push(e.question.id)})),this.updatedQuestions.sections[0].questions.forEach((function(e){r.push(e.question.id),a.includes(e.question.id)||n.push(e.question.id)})),s=a.filter((function(e){return!r.includes(e)}));var i=t.sections.find((function(e){return"Generic Question Set"===e.title}));i.questions=i.questions.filter((function(e){return!s.includes(e.question.id)})),this.insertData("/appraisal/".concat(this.getOrganizationSlug,"/year/slot/").concat(this.$route.params.id,"/question-set/edit/"),{question_set:t,appraisal:this.appraiserAppraiseeId,new_questions:n}).then((function(){e.$emit("close"),e.$emit("updatePaFormTable")}))}}},u=l,d=a("2877"),p=a("6544"),f=a.n(p),m=a("8336"),h=a("b0af"),g=a("99d9"),v=a("62ad"),b=a("a523"),y=a("ce7e"),w=a("0fd9b"),_=a("2fa4"),x=a("8654"),F=a("a844"),A=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=A.exports;f()(A,{VBtn:m["a"],VCard:h["a"],VCardActions:g["a"],VCardText:g["c"],VCol:v["a"],VContainer:b["a"],VDivider:y["a"],VRow:w["a"],VSpacer:_["a"],VTextField:x["a"],VTextarea:F["a"]})},"1f04":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return c}));var n=a("1da1");a("d3b7"),a("3ca3"),a("ddb0"),a("96cf");function r(e){return s.apply(this,arguments)}function s(){return s=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:return a=e.sent,e.next=5,c([a]);case 5:return n=e.sent,e.abrupt("return",n[0]);case 7:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function i(e){return o.apply(this,arguments)}function o(){return o=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.blob();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function c(e){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=function(e){var t=new FileReader;return new Promise((function(a){t.readAsDataURL(e),t.onloadend=function(){a(t.result)}}))},n=[],r=0;r<t.length;r++)n.push(a(t[r]));return e.next=5,Promise.all(n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}},"6c6f":function(e,t,a){"use strict";a("d3b7");t["a"]={data:function(){return{deleteNotification:{dialog:!1,heading:"Confirm Delete",text:"Are you sure you want to delete ?"}}},methods:{deleteData:function(e,t){var a=this;return new Promise((function(n,r){!a.loading&&e&&(a.loading=!0,a.$http.delete(e,t||{}).then((function(e){a.crud.message&&setTimeout((function(){a.notifyUser(a.crud.message)}),1e3),n(e),a.loading=!1})).catch((function(e){a.pushErrors(e),a.notifyInvalidFormResponse(),r(e),a.loading=!1})).finally((function(){a.deleteNotification.dialog=!1})))}))}}}},d242:function(e,t,a){"use strict";var n=a("1da1"),r=a("5530"),s=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("caad"),a("159b"),a("99af"),a("b0c0"),a("7db0"),a("fb6a"),a("2f62")),i=a("f1d0"),o=a("1f04"),c=a("cf45");t["a"]={data:function(){return{orgInfo:null,serverTime:null,downloading:!1}},methods:Object(r["a"])(Object(r["a"])({},Object(s["d"])({setSnackBar:"common/setSnackBar"})),{},{downloadPdf:function(e){var t=arguments,r=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var i,l,u,d,p,f,m;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(i=t.length>1&&void 0!==t[1]?t[1]:"p",l=t.length>2?t[2]:void 0,u=t.length>3&&void 0!==t[3]?t[3]:35,d=t.length>4&&void 0!==t[4]?t[4]:1245,p=t.length>5&&void 0!==t[5]?t[5]:1475,e.$el&&(e=e.$el),!r.loading){s.next=8;break}return s.abrupt("return");case 8:return scroll(0,0),s.prev=9,r.loading=!0,r.downloading=!0,r.setSnackBar({text:"File Downloading. Please wait...",color:"info",persist:!0}),s.next=15,r.loadOrganizationInfo();case 15:f=0,m=0,"l"===i&&(f=805,m=86),setTimeout(Object(n["a"])(regeneratorRuntime.mark((function t(){var s,h,g,v,b,y;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.getBoundingClientRect().top,h=e.getBoundingClientRect().left,g=e.offsetHeight+parseInt(getComputedStyle(e).marginTop),v=[],b=document.getElementsByClassName("download-only"),y=document.getElementsByClassName("download-hidden"),t.next=8,a.e("chunk-2d216257").then(a.t.bind(null,"c0e9",7)).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){var r,i,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=a.default;case 1:if(!(g>=40)){t.next=8;break}for(i=0;i<b.length;i++)b[i].style.display="block";for(o=0;o<y.length;o++)y[o].style.display="none";return t.next=6,r(e,{x:h-u,y:s,width:d,height:p-f,type:"dataURL",scale:2,useCORS:!0,windowWidth:1300}).then(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:v.push(t.toDataURL("image/png")),g-=p-f,s+=p-f;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:t.next=1;break;case 8:for(c=0;c<b.length;c++)b[c].style.display="none";for(l=0;l<y.length;l++)y[l].style.display="";case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 8:a.e("chunk-e0378ed4").then(a.bind(null,"8baf")).then(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,n,s,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.default,n=new a(i,"mm"),!["manualtesting","development"].includes(Object(c["f"])("VUE_APP_ENV"))){e.next=8;break}return e.next=5,Object(o["b"])("https://i.imgur.com/fHyEMsl.jpg");case 5:s=e.sent,e.next=11;break;case 8:return e.next=10,Object(o["b"])(r.orgInfo.logo);case 10:s=e.sent;case 11:u=210+m,d=32,v.forEach((function(e,t){t>0&&n.addPage(),n.addImage(e,"PNG",0,d,u,0,void 0,"FAST"),r.setHeaderAndFooter(t,n,s,v.length,i)})),n.save(l||"file.pdf"),r.loading=!1,r.setSnackBar({text:"",color:"",display:!1,error:!1});case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:case"end":return t.stop()}}),t)}))),500),s.next=27;break;case 21:s.prev=21,s.t0=s["catch"](9),console.error("Error while downloading pdf",s.t0),r.setSnackBar({text:"Your request was not successful.",color:"red"}),r.loading=!1,r.downloading=!1;case 27:case"end":return s.stop()}}),s,null,[[9,21]])})))()},setHeaderAndFooter:function(e,t,a,n,r){var s=0,i=0;"l"===r&&(s=2.5,i=84);var o=e+1,c=t.internal.pageSize.getWidth(),l=t.internal.pageSize.getHeight(),u=this.serverTime,d="Page ".concat(o," of ").concat(n);t.setPage(o),t.setFont("Helvetica","normal"),t.setLineWidth(.2),t.setDrawColor(150),t.line(7.5+s,27,203+i,27),t.line(7.5+s,l-12,203+i,l-12),t.setTextColor(150),t.setFontSize(8),t.text(d,7.5+s,l-7),t.text(u,c-8-s,l-7,{align:"right"});var p=this.orgInfo.address?this.orgInfo.address+",":"",f=this.orgInfo.phone_no?"Tel: ".concat(this.orgInfo.phone_no):"";t.text("".concat(p," ").concat(f),c-8-s,17,{align:"right"});var m=this.orgInfo.email?this.orgInfo.email+",":"",h=this.orgInfo.website||"";t.text("".concat(m," ").concat(h),c-8-s,21,{align:"right"}),t.setTextColor(100),t.setFontSize(14),t.setFont("Helvetica","bold"),t.text("".concat(this.orgInfo.name),c-8-s,13,{align:"right"}),t.addImage(a,"JPEG",7.5+s,7,18,18,void 0,"FAST")},loadOrganizationInfo:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.getOrganizationSlug,n=JSON.parse(localStorage.getItem("org-info"))||[],!(n.length>0&&n.some((function(e){return e.slug===a})))){t.next=6;break}e.orgInfo=n.find((function(e){return e.slug===a})),t.next=8;break;case 6:return t.next=8,e.$http.get(i["a"].getOrganization(a)).then((function(t){var a=t.name,r=t.slug,s=t.appearance.logo,i=t.address?t.address.address:"",o=t.email,c=t.contacts.Phone,l=t.website,u={name:a,slug:r,logo:s,address:i,email:o,phone_no:c,website:l};n.push(u),localStorage.setItem("org-info",JSON.stringify(n)),e.orgInfo=u}));case 8:return t.next=10,e.$http.get("server-info/?fields=server_time").then((function(t){var a=t.server_time;a=a.slice(0,-6),e.serverTime=e.$dayjs(a).format("YYYY-MM-DD HH:mm:ss A")}));case 10:case"end":return t.stop()}}),t)})))()}})}},f12b:function(e,t,a){"use strict";var n=a("f0d5"),r=a("983c"),s=a("f70a"),i=a("6c6f");t["a"]={mixins:[n["a"],r["a"],s["a"],i["a"]]}},f1d0:function(e,t,a){"use strict";t["a"]={getOrganizationList:"/org/",getOrganization:function(e){return"/org/".concat(e,"/")},updateOrganization:function(e){return"/org/".concat(e,"/")},getOrgEmployeeData:function(e){return"/org/".concat(e,"/employee-data/")}}}}]);